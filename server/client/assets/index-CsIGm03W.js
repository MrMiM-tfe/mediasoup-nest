(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var S=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zp={exports:{}},Vo={},Jp={exports:{}},U={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rs=Symbol.for("react.element"),tg=Symbol.for("react.portal"),rg=Symbol.for("react.fragment"),ng=Symbol.for("react.strict_mode"),ig=Symbol.for("react.profiler"),sg=Symbol.for("react.provider"),og=Symbol.for("react.context"),ag=Symbol.for("react.forward_ref"),cg=Symbol.for("react.suspense"),lg=Symbol.for("react.memo"),dg=Symbol.for("react.lazy"),Wd=Symbol.iterator;function ug(t){return t===null||typeof t!="object"?null:(t=Wd&&t[Wd]||t["@@iterator"],typeof t=="function"?t:null)}var ef={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tf=Object.assign,rf={};function Zn(t,e,r){this.props=t,this.context=e,this.refs=rf,this.updater=r||ef}Zn.prototype.isReactComponent={};Zn.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nf(){}nf.prototype=Zn.prototype;function Sl(t,e,r){this.props=t,this.context=e,this.refs=rf,this.updater=r||ef}var Rl=Sl.prototype=new nf;Rl.constructor=Sl;tf(Rl,Zn.prototype);Rl.isPureReactComponent=!0;var Qd=Array.isArray,sf=Object.prototype.hasOwnProperty,bl={current:null},of={key:!0,ref:!0,__self:!0,__source:!0};function af(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sf.call(e,n)&&!of.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:rs,type:t,key:s,ref:o,props:i,_owner:bl.current}}function pg(t,e){return{$$typeof:rs,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Cl(t){return typeof t=="object"&&t!==null&&t.$$typeof===rs}function fg(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var qd=/\/+/g;function La(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fg(""+t.key):e.toString(36)}function to(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case rs:case tg:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+La(o,0):n,Qd(i)?(r="",t!=null&&(r=t.replace(qd,"$&/")+"/"),to(i,e,r,"",function(l){return l})):i!=null&&(Cl(i)&&(i=pg(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(qd,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",Qd(t))for(var a=0;a<t.length;a++){s=t[a];var c=n+La(s,a);o+=to(s,e,r,c,i)}else if(c=ug(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=n+La(s,a++),o+=to(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Rs(t,e,r){if(t==null)return t;var n=[],i=0;return to(t,n,"","",function(s){return e.call(r,s,i++)}),n}function hg(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ve={current:null},ro={transition:null},mg={ReactCurrentDispatcher:Ve,ReactCurrentBatchConfig:ro,ReactCurrentOwner:bl};function cf(){throw Error("act(...) is not supported in production builds of React.")}U.Children={map:Rs,forEach:function(t,e,r){Rs(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Rs(t,function(){e++}),e},toArray:function(t){return Rs(t,function(e){return e})||[]},only:function(t){if(!Cl(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};U.Component=Zn;U.Fragment=rg;U.Profiler=ig;U.PureComponent=Sl;U.StrictMode=ng;U.Suspense=cg;U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mg;U.act=cf;U.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=tf({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=bl.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)sf.call(e,c)&&!of.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];n.children=a}return{$$typeof:rs,type:t.type,key:i,ref:s,props:n,_owner:o}};U.createContext=function(t){return t={$$typeof:og,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sg,_context:t},t.Consumer=t};U.createElement=af;U.createFactory=function(t){var e=af.bind(null,t);return e.type=t,e};U.createRef=function(){return{current:null}};U.forwardRef=function(t){return{$$typeof:ag,render:t}};U.isValidElement=Cl;U.lazy=function(t){return{$$typeof:dg,_payload:{_status:-1,_result:t},_init:hg}};U.memo=function(t,e){return{$$typeof:lg,type:t,compare:e===void 0?null:e}};U.startTransition=function(t){var e=ro.transition;ro.transition={};try{t()}finally{ro.transition=e}};U.unstable_act=cf;U.useCallback=function(t,e){return Ve.current.useCallback(t,e)};U.useContext=function(t){return Ve.current.useContext(t)};U.useDebugValue=function(){};U.useDeferredValue=function(t){return Ve.current.useDeferredValue(t)};U.useEffect=function(t,e){return Ve.current.useEffect(t,e)};U.useId=function(){return Ve.current.useId()};U.useImperativeHandle=function(t,e,r){return Ve.current.useImperativeHandle(t,e,r)};U.useInsertionEffect=function(t,e){return Ve.current.useInsertionEffect(t,e)};U.useLayoutEffect=function(t,e){return Ve.current.useLayoutEffect(t,e)};U.useMemo=function(t,e){return Ve.current.useMemo(t,e)};U.useReducer=function(t,e,r){return Ve.current.useReducer(t,e,r)};U.useRef=function(t){return Ve.current.useRef(t)};U.useState=function(t){return Ve.current.useState(t)};U.useSyncExternalStore=function(t,e,r){return Ve.current.useSyncExternalStore(t,e,r)};U.useTransition=function(){return Ve.current.useTransition()};U.version="18.3.1";Jp.exports=U;var Ho=Jp.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gg=Ho,_g=Symbol.for("react.element"),vg=Symbol.for("react.fragment"),yg=Object.prototype.hasOwnProperty,wg=gg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sg={key:!0,ref:!0,__self:!0,__source:!0};function lf(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)yg.call(e,n)&&!Sg.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:_g,type:t,key:s,ref:o,props:i,_owner:wg.current}}Vo.Fragment=vg;Vo.jsx=lf;Vo.jsxs=lf;Zp.exports=Vo;var Ei=Zp.exports,df={exports:{}},tt={},uf={exports:{}},pf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,N){var F=T.length;T.push(N);e:for(;0<F;){var ce=F-1>>>1,le=T[ce];if(0<i(le,N))T[ce]=N,T[F]=le,F=ce;else break e}}function r(T){return T.length===0?null:T[0]}function n(T){if(T.length===0)return null;var N=T[0],F=T.pop();if(F!==N){T[0]=F;e:for(var ce=0,le=T.length,Rt=le>>>1;ce<Rt;){var bt=2*(ce+1)-1,ar=T[bt],pt=bt+1,cr=T[pt];if(0>i(ar,F))pt<le&&0>i(cr,ar)?(T[ce]=cr,T[pt]=F,ce=pt):(T[ce]=ar,T[bt]=F,ce=bt);else if(pt<le&&0>i(cr,F))T[ce]=cr,T[pt]=F,ce=pt;else break e}}return N}function i(T,N){var F=T.sortIndex-N.sortIndex;return F!==0?F:T.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],d=1,p=null,u=3,f=!1,h=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(T){for(var N=r(l);N!==null;){if(N.callback===null)n(l);else if(N.startTime<=T)n(l),N.sortIndex=N.expirationTime,e(c,N);else break;N=r(l)}}function w(T){if(m=!1,v(T),!h)if(r(c)!==null)h=!0,sr(b);else{var N=r(l);N!==null&&or(w,N.startTime-T)}}function b(T,N){h=!1,m&&(m=!1,g(P),P=-1),f=!0;var F=u;try{for(v(N),p=r(c);p!==null&&(!(p.expirationTime>N)||T&&!ve());){var ce=p.callback;if(typeof ce=="function"){p.callback=null,u=p.priorityLevel;var le=ce(p.expirationTime<=N);N=t.unstable_now(),typeof le=="function"?p.callback=le:p===r(c)&&n(c),v(N)}else n(c);p=r(c)}if(p!==null)var Rt=!0;else{var bt=r(l);bt!==null&&or(w,bt.startTime-N),Rt=!1}return Rt}finally{p=null,u=F,f=!1}}var C=!1,E=null,P=-1,Y=5,$=-1;function ve(){return!(t.unstable_now()-$<Y)}function Ie(){if(E!==null){var T=t.unstable_now();$=T;var N=!0;try{N=E(!0,T)}finally{N?ut():(C=!1,E=null)}}else C=!1}var ut;if(typeof _=="function")ut=function(){_(Ie)};else if(typeof MessageChannel<"u"){var Ar=new MessageChannel,Pa=Ar.port2;Ar.port1.onmessage=Ie,ut=function(){Pa.postMessage(null)}}else ut=function(){y(Ie,0)};function sr(T){E=T,C||(C=!0,ut())}function or(T,N){P=y(function(){T(t.unstable_now())},N)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){h||f||(h=!0,sr(b))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return u},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(T){switch(u){case 1:case 2:case 3:var N=3;break;default:N=u}var F=u;u=N;try{return T()}finally{u=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,N){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var F=u;u=T;try{return N()}finally{u=F}},t.unstable_scheduleCallback=function(T,N,F){var ce=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?ce+F:ce):F=ce,T){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=F+le,T={id:d++,callback:N,priorityLevel:T,startTime:F,expirationTime:le,sortIndex:-1},F>ce?(T.sortIndex=F,e(l,T),r(c)===null&&T===r(l)&&(m?(g(P),P=-1):m=!0,or(w,F-ce))):(T.sortIndex=le,e(c,T),h||f||(h=!0,sr(b))),T},t.unstable_shouldYield=ve,t.unstable_wrapCallback=function(T){var N=u;return function(){var F=u;u=N;try{return T.apply(this,arguments)}finally{u=F}}}})(pf);uf.exports=pf;var Rg=uf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bg=Ho,et=Rg;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ff=new Set,Ai={};function Zr(t,e){Kn(t,e),Kn(t+"Capture",e)}function Kn(t,e){for(Ai[t]=e,t=0;t<e.length;t++)ff.add(e[t])}var er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wc=Object.prototype.hasOwnProperty,Cg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gd={},Yd={};function Tg(t){return wc.call(Yd,t)?!0:wc.call(Gd,t)?!1:Cg.test(t)?Yd[t]=!0:(Gd[t]=!0,!1)}function Dg(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Eg(t,e,r,n){if(e===null||typeof e>"u"||Dg(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function He(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Oe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Oe[t]=new He(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Oe[e]=new He(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Oe[t]=new He(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Oe[t]=new He(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Oe[t]=new He(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Oe[t]=new He(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Oe[t]=new He(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Oe[t]=new He(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Oe[t]=new He(t,5,!1,t.toLowerCase(),null,!1,!1)});var Tl=/[\-:]([a-z])/g;function Dl(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Tl,Dl);Oe[e]=new He(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Tl,Dl);Oe[e]=new He(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Tl,Dl);Oe[e]=new He(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Oe[t]=new He(t,1,!1,t.toLowerCase(),null,!1,!1)});Oe.xlinkHref=new He("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Oe[t]=new He(t,1,!1,t.toLowerCase(),null,!0,!0)});function El(t,e,r,n){var i=Oe.hasOwnProperty(e)?Oe[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Eg(e,r,i,n)&&(r=null),n||i===null?Tg(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ir=bg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bs=Symbol.for("react.element"),Dn=Symbol.for("react.portal"),En=Symbol.for("react.fragment"),Pl=Symbol.for("react.strict_mode"),Sc=Symbol.for("react.profiler"),hf=Symbol.for("react.provider"),mf=Symbol.for("react.context"),kl=Symbol.for("react.forward_ref"),Rc=Symbol.for("react.suspense"),bc=Symbol.for("react.suspense_list"),xl=Symbol.for("react.memo"),mr=Symbol.for("react.lazy"),gf=Symbol.for("react.offscreen"),Xd=Symbol.iterator;function li(t){return t===null||typeof t!="object"?null:(t=Xd&&t[Xd]||t["@@iterator"],typeof t=="function"?t:null)}var fe=Object.assign,Ma;function Ri(t){if(Ma===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Ma=e&&e[1]||""}return`
`+Ma+t}var Oa=!1;function Ia(t,e){if(!t||Oa)return"";Oa=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var n=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){n=l}t.call(e.prototype)}else{try{throw Error()}catch(l){n=l}t()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Oa=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ri(t):""}function Pg(t){switch(t.tag){case 5:return Ri(t.type);case 16:return Ri("Lazy");case 13:return Ri("Suspense");case 19:return Ri("SuspenseList");case 0:case 2:case 15:return t=Ia(t.type,!1),t;case 11:return t=Ia(t.type.render,!1),t;case 1:return t=Ia(t.type,!0),t;default:return""}}function Cc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case En:return"Fragment";case Dn:return"Portal";case Sc:return"Profiler";case Pl:return"StrictMode";case Rc:return"Suspense";case bc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mf:return(t.displayName||"Context")+".Consumer";case hf:return(t._context.displayName||"Context")+".Provider";case kl:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case xl:return e=t.displayName||null,e!==null?e:Cc(t.type)||"Memo";case mr:e=t._payload,t=t._init;try{return Cc(t(e))}catch{}}return null}function kg(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cc(e);case 8:return e===Pl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _f(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xg(t){var e=_f(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Cs(t){t._valueTracker||(t._valueTracker=xg(t))}function vf(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=_f(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function yo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tc(t,e){var r=e.checked;return fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Zd(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Mr(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yf(t,e){e=e.checked,e!=null&&El(t,"checked",e,!1)}function Dc(t,e){yf(t,e);var r=Mr(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ec(t,e.type,r):e.hasOwnProperty("defaultValue")&&Ec(t,e.type,Mr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Jd(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ec(t,e,r){(e!=="number"||yo(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var bi=Array.isArray;function An(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Mr(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Pc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function eu(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(R(92));if(bi(r)){if(1<r.length)throw Error(R(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Mr(r)}}function wf(t,e){var r=Mr(e.value),n=Mr(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function tu(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Sf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Sf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ts,Rf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ts=Ts||document.createElement("div"),Ts.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ts.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fi(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Pi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lg=["Webkit","ms","Moz","O"];Object.keys(Pi).forEach(function(t){Lg.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Pi[e]=Pi[t]})});function bf(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Pi.hasOwnProperty(t)&&Pi[t]?(""+e).trim():e+"px"}function Cf(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=bf(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Mg=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xc(t,e){if(e){if(Mg[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function Lc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mc=null;function Ll(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Oc=null,Fn=null,Bn=null;function ru(t){if(t=ss(t)){if(typeof Oc!="function")throw Error(R(280));var e=t.stateNode;e&&(e=Go(e),Oc(t.stateNode,t.type,e))}}function Tf(t){Fn?Bn?Bn.push(t):Bn=[t]:Fn=t}function Df(){if(Fn){var t=Fn,e=Bn;if(Bn=Fn=null,ru(t),e)for(t=0;t<e.length;t++)ru(e[t])}}function Ef(t,e){return t(e)}function Pf(){}var Na=!1;function kf(t,e,r){if(Na)return t(e,r);Na=!0;try{return Ef(t,e,r)}finally{Na=!1,(Fn!==null||Bn!==null)&&(Pf(),Df())}}function Bi(t,e){var r=t.stateNode;if(r===null)return null;var n=Go(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(R(231,e,typeof r));return r}var Ic=!1;if(er)try{var di={};Object.defineProperty(di,"passive",{get:function(){Ic=!0}}),window.addEventListener("test",di,di),window.removeEventListener("test",di,di)}catch{Ic=!1}function Og(t,e,r,n,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(r,l)}catch(d){this.onError(d)}}var ki=!1,wo=null,So=!1,Nc=null,Ig={onError:function(t){ki=!0,wo=t}};function Ng(t,e,r,n,i,s,o,a,c){ki=!1,wo=null,Og.apply(Ig,arguments)}function jg(t,e,r,n,i,s,o,a,c){if(Ng.apply(this,arguments),ki){if(ki){var l=wo;ki=!1,wo=null}else throw Error(R(198));So||(So=!0,Nc=l)}}function Jr(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function xf(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function nu(t){if(Jr(t)!==t)throw Error(R(188))}function $g(t){var e=t.alternate;if(!e){if(e=Jr(t),e===null)throw Error(R(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return nu(i),t;if(s===n)return nu(i),e;s=s.sibling}throw Error(R(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(R(189))}}if(r.alternate!==n)throw Error(R(190))}if(r.tag!==3)throw Error(R(188));return r.stateNode.current===r?t:e}function Lf(t){return t=$g(t),t!==null?Mf(t):null}function Mf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Mf(t);if(e!==null)return e;t=t.sibling}return null}var Of=et.unstable_scheduleCallback,iu=et.unstable_cancelCallback,Ag=et.unstable_shouldYield,Fg=et.unstable_requestPaint,ye=et.unstable_now,Bg=et.unstable_getCurrentPriorityLevel,Ml=et.unstable_ImmediatePriority,If=et.unstable_UserBlockingPriority,Ro=et.unstable_NormalPriority,zg=et.unstable_LowPriority,Nf=et.unstable_IdlePriority,Ko=null,At=null;function Ug(t){if(At&&typeof At.onCommitFiberRoot=="function")try{At.onCommitFiberRoot(Ko,t,void 0,(t.current.flags&128)===128)}catch{}}var yt=Math.clz32?Math.clz32:Kg,Vg=Math.log,Hg=Math.LN2;function Kg(t){return t>>>=0,t===0?32:31-(Vg(t)/Hg|0)|0}var Ds=64,Es=4194304;function Ci(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function bo(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=Ci(a):(s&=o,s!==0&&(n=Ci(s)))}else o=r&~i,o!==0?n=Ci(o):s!==0&&(n=Ci(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-yt(e),i=1<<r,n|=t[r],e&=~i;return n}function Wg(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qg(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-yt(s),a=1<<o,c=i[o];c===-1?(!(a&r)||a&n)&&(i[o]=Wg(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function jc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function jf(){var t=Ds;return Ds<<=1,!(Ds&4194240)&&(Ds=64),t}function ja(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ns(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-yt(e),t[e]=r}function qg(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-yt(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Ol(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-yt(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var ee=0;function $f(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Af,Il,Ff,Bf,zf,$c=!1,Ps=[],Sr=null,Rr=null,br=null,zi=new Map,Ui=new Map,_r=[],Gg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function su(t,e){switch(t){case"focusin":case"focusout":Sr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":br=null;break;case"pointerover":case"pointerout":zi.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ui.delete(e.pointerId)}}function ui(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ss(e),e!==null&&Il(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Yg(t,e,r,n,i){switch(e){case"focusin":return Sr=ui(Sr,t,e,r,n,i),!0;case"dragenter":return Rr=ui(Rr,t,e,r,n,i),!0;case"mouseover":return br=ui(br,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return zi.set(s,ui(zi.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Ui.set(s,ui(Ui.get(s)||null,t,e,r,n,i)),!0}return!1}function Uf(t){var e=Ur(t.target);if(e!==null){var r=Jr(e);if(r!==null){if(e=r.tag,e===13){if(e=xf(r),e!==null){t.blockedOn=e,zf(t.priority,function(){Ff(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function no(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Ac(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Mc=n,r.target.dispatchEvent(n),Mc=null}else return e=ss(r),e!==null&&Il(e),t.blockedOn=r,!1;e.shift()}return!0}function ou(t,e,r){no(t)&&r.delete(e)}function Xg(){$c=!1,Sr!==null&&no(Sr)&&(Sr=null),Rr!==null&&no(Rr)&&(Rr=null),br!==null&&no(br)&&(br=null),zi.forEach(ou),Ui.forEach(ou)}function pi(t,e){t.blockedOn===e&&(t.blockedOn=null,$c||($c=!0,et.unstable_scheduleCallback(et.unstable_NormalPriority,Xg)))}function Vi(t){function e(i){return pi(i,t)}if(0<Ps.length){pi(Ps[0],t);for(var r=1;r<Ps.length;r++){var n=Ps[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Sr!==null&&pi(Sr,t),Rr!==null&&pi(Rr,t),br!==null&&pi(br,t),zi.forEach(e),Ui.forEach(e),r=0;r<_r.length;r++)n=_r[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<_r.length&&(r=_r[0],r.blockedOn===null);)Uf(r),r.blockedOn===null&&_r.shift()}var zn=ir.ReactCurrentBatchConfig,Co=!0;function Zg(t,e,r,n){var i=ee,s=zn.transition;zn.transition=null;try{ee=1,Nl(t,e,r,n)}finally{ee=i,zn.transition=s}}function Jg(t,e,r,n){var i=ee,s=zn.transition;zn.transition=null;try{ee=4,Nl(t,e,r,n)}finally{ee=i,zn.transition=s}}function Nl(t,e,r,n){if(Co){var i=Ac(t,e,r,n);if(i===null)Wa(t,e,n,To,r),su(t,n);else if(Yg(i,t,e,r,n))n.stopPropagation();else if(su(t,n),e&4&&-1<Gg.indexOf(t)){for(;i!==null;){var s=ss(i);if(s!==null&&Af(s),s=Ac(t,e,r,n),s===null&&Wa(t,e,n,To,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Wa(t,e,n,null,r)}}var To=null;function Ac(t,e,r,n){if(To=null,t=Ll(n),t=Ur(t),t!==null)if(e=Jr(t),e===null)t=null;else if(r=e.tag,r===13){if(t=xf(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return To=t,null}function Vf(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bg()){case Ml:return 1;case If:return 4;case Ro:case zg:return 16;case Nf:return 536870912;default:return 16}default:return 16}}var yr=null,jl=null,io=null;function Hf(){if(io)return io;var t,e=jl,r=e.length,n,i="value"in yr?yr.value:yr.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return io=i.slice(t,1<n?1-n:void 0)}function so(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ks(){return!0}function au(){return!1}function rt(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ks:au,this.isPropagationStopped=au,this}return fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ks)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ks)},persist:function(){},isPersistent:ks}),e}var Jn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$l=rt(Jn),is=fe({},Jn,{view:0,detail:0}),e_=rt(is),$a,Aa,fi,Wo=fe({},is,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Al,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fi&&(fi&&t.type==="mousemove"?($a=t.screenX-fi.screenX,Aa=t.screenY-fi.screenY):Aa=$a=0,fi=t),$a)},movementY:function(t){return"movementY"in t?t.movementY:Aa}}),cu=rt(Wo),t_=fe({},Wo,{dataTransfer:0}),r_=rt(t_),n_=fe({},is,{relatedTarget:0}),Fa=rt(n_),i_=fe({},Jn,{animationName:0,elapsedTime:0,pseudoElement:0}),s_=rt(i_),o_=fe({},Jn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),a_=rt(o_),c_=fe({},Jn,{data:0}),lu=rt(c_),l_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},d_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},u_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=u_[t])?!!e[t]:!1}function Al(){return p_}var f_=fe({},is,{key:function(t){if(t.key){var e=l_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=so(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?d_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Al,charCode:function(t){return t.type==="keypress"?so(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?so(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),h_=rt(f_),m_=fe({},Wo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),du=rt(m_),g_=fe({},is,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Al}),__=rt(g_),v_=fe({},Jn,{propertyName:0,elapsedTime:0,pseudoElement:0}),y_=rt(v_),w_=fe({},Wo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),S_=rt(w_),R_=[9,13,27,32],Fl=er&&"CompositionEvent"in window,xi=null;er&&"documentMode"in document&&(xi=document.documentMode);var b_=er&&"TextEvent"in window&&!xi,Kf=er&&(!Fl||xi&&8<xi&&11>=xi),uu=" ",pu=!1;function Wf(t,e){switch(t){case"keyup":return R_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qf(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pn=!1;function C_(t,e){switch(t){case"compositionend":return Qf(e);case"keypress":return e.which!==32?null:(pu=!0,uu);case"textInput":return t=e.data,t===uu&&pu?null:t;default:return null}}function T_(t,e){if(Pn)return t==="compositionend"||!Fl&&Wf(t,e)?(t=Hf(),io=jl=yr=null,Pn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Kf&&e.locale!=="ko"?null:e.data;default:return null}}var D_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!D_[t.type]:e==="textarea"}function qf(t,e,r,n){Tf(n),e=Do(e,"onChange"),0<e.length&&(r=new $l("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Li=null,Hi=null;function E_(t){sh(t,0)}function Qo(t){var e=Ln(t);if(vf(e))return t}function P_(t,e){if(t==="change")return e}var Gf=!1;if(er){var Ba;if(er){var za="oninput"in document;if(!za){var hu=document.createElement("div");hu.setAttribute("oninput","return;"),za=typeof hu.oninput=="function"}Ba=za}else Ba=!1;Gf=Ba&&(!document.documentMode||9<document.documentMode)}function mu(){Li&&(Li.detachEvent("onpropertychange",Yf),Hi=Li=null)}function Yf(t){if(t.propertyName==="value"&&Qo(Hi)){var e=[];qf(e,Hi,t,Ll(t)),kf(E_,e)}}function k_(t,e,r){t==="focusin"?(mu(),Li=e,Hi=r,Li.attachEvent("onpropertychange",Yf)):t==="focusout"&&mu()}function x_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qo(Hi)}function L_(t,e){if(t==="click")return Qo(e)}function M_(t,e){if(t==="input"||t==="change")return Qo(e)}function O_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var St=typeof Object.is=="function"?Object.is:O_;function Ki(t,e){if(St(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!wc.call(e,i)||!St(t[i],e[i]))return!1}return!0}function gu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function _u(t,e){var r=gu(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=gu(r)}}function Xf(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Xf(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Zf(){for(var t=window,e=yo();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=yo(t.document)}return e}function Bl(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function I_(t){var e=Zf(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Xf(r.ownerDocument.documentElement,r)){if(n!==null&&Bl(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=_u(r,s);var o=_u(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var N_=er&&"documentMode"in document&&11>=document.documentMode,kn=null,Fc=null,Mi=null,Bc=!1;function vu(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Bc||kn==null||kn!==yo(n)||(n=kn,"selectionStart"in n&&Bl(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Mi&&Ki(Mi,n)||(Mi=n,n=Do(Fc,"onSelect"),0<n.length&&(e=new $l("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=kn)))}function xs(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var xn={animationend:xs("Animation","AnimationEnd"),animationiteration:xs("Animation","AnimationIteration"),animationstart:xs("Animation","AnimationStart"),transitionend:xs("Transition","TransitionEnd")},Ua={},Jf={};er&&(Jf=document.createElement("div").style,"AnimationEvent"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),"TransitionEvent"in window||delete xn.transitionend.transition);function qo(t){if(Ua[t])return Ua[t];if(!xn[t])return t;var e=xn[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Jf)return Ua[t]=e[r];return t}var eh=qo("animationend"),th=qo("animationiteration"),rh=qo("animationstart"),nh=qo("transitionend"),ih=new Map,yu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(t,e){ih.set(t,e),Zr(e,[t])}for(var Va=0;Va<yu.length;Va++){var Ha=yu[Va],j_=Ha.toLowerCase(),$_=Ha[0].toUpperCase()+Ha.slice(1);Nr(j_,"on"+$_)}Nr(eh,"onAnimationEnd");Nr(th,"onAnimationIteration");Nr(rh,"onAnimationStart");Nr("dblclick","onDoubleClick");Nr("focusin","onFocus");Nr("focusout","onBlur");Nr(nh,"onTransitionEnd");Kn("onMouseEnter",["mouseout","mouseover"]);Kn("onMouseLeave",["mouseout","mouseover"]);Kn("onPointerEnter",["pointerout","pointerover"]);Kn("onPointerLeave",["pointerout","pointerover"]);Zr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ti="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),A_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ti));function wu(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,jg(n,e,void 0,t),t.currentTarget=null}function sh(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;wu(i,a,l),s=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;wu(i,a,l),s=c}}}if(So)throw t=Nc,So=!1,Nc=null,t}function oe(t,e){var r=e[Kc];r===void 0&&(r=e[Kc]=new Set);var n=t+"__bubble";r.has(n)||(oh(e,t,2,!1),r.add(n))}function Ka(t,e,r){var n=0;e&&(n|=4),oh(r,t,n,e)}var Ls="_reactListening"+Math.random().toString(36).slice(2);function Wi(t){if(!t[Ls]){t[Ls]=!0,ff.forEach(function(r){r!=="selectionchange"&&(A_.has(r)||Ka(r,!1,t),Ka(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ls]||(e[Ls]=!0,Ka("selectionchange",!1,e))}}function oh(t,e,r,n){switch(Vf(e)){case 1:var i=Zg;break;case 4:i=Jg;break;default:i=Nl}r=i.bind(null,e,r,t),i=void 0,!Ic||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Wa(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ur(a),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}a=a.parentNode}}n=n.return}kf(function(){var l=s,d=Ll(r),p=[];e:{var u=ih.get(t);if(u!==void 0){var f=$l,h=t;switch(t){case"keypress":if(so(r)===0)break e;case"keydown":case"keyup":f=h_;break;case"focusin":h="focus",f=Fa;break;case"focusout":h="blur",f=Fa;break;case"beforeblur":case"afterblur":f=Fa;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=cu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=r_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=__;break;case eh:case th:case rh:f=s_;break;case nh:f=y_;break;case"scroll":f=e_;break;case"wheel":f=S_;break;case"copy":case"cut":case"paste":f=a_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=du}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?u!==null?u+"Capture":null:u;m=[];for(var _=l,v;_!==null;){v=_;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,g!==null&&(w=Bi(_,g),w!=null&&m.push(Qi(_,w,v)))),y)break;_=_.return}0<m.length&&(u=new f(u,h,null,r,d),p.push({event:u,listeners:m}))}}if(!(e&7)){e:{if(u=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",u&&r!==Mc&&(h=r.relatedTarget||r.fromElement)&&(Ur(h)||h[tr]))break e;if((f||u)&&(u=d.window===d?d:(u=d.ownerDocument)?u.defaultView||u.parentWindow:window,f?(h=r.relatedTarget||r.toElement,f=l,h=h?Ur(h):null,h!==null&&(y=Jr(h),h!==y||h.tag!==5&&h.tag!==6)&&(h=null)):(f=null,h=l),f!==h)){if(m=cu,w="onMouseLeave",g="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(m=du,w="onPointerLeave",g="onPointerEnter",_="pointer"),y=f==null?u:Ln(f),v=h==null?u:Ln(h),u=new m(w,_+"leave",f,r,d),u.target=y,u.relatedTarget=v,w=null,Ur(d)===l&&(m=new m(g,_+"enter",h,r,d),m.target=v,m.relatedTarget=y,w=m),y=w,f&&h)t:{for(m=f,g=h,_=0,v=m;v;v=sn(v))_++;for(v=0,w=g;w;w=sn(w))v++;for(;0<_-v;)m=sn(m),_--;for(;0<v-_;)g=sn(g),v--;for(;_--;){if(m===g||g!==null&&m===g.alternate)break t;m=sn(m),g=sn(g)}m=null}else m=null;f!==null&&Su(p,u,f,m,!1),h!==null&&y!==null&&Su(p,y,h,m,!0)}}e:{if(u=l?Ln(l):window,f=u.nodeName&&u.nodeName.toLowerCase(),f==="select"||f==="input"&&u.type==="file")var b=P_;else if(fu(u))if(Gf)b=M_;else{b=x_;var C=k_}else(f=u.nodeName)&&f.toLowerCase()==="input"&&(u.type==="checkbox"||u.type==="radio")&&(b=L_);if(b&&(b=b(t,l))){qf(p,b,r,d);break e}C&&C(t,u,l),t==="focusout"&&(C=u._wrapperState)&&C.controlled&&u.type==="number"&&Ec(u,"number",u.value)}switch(C=l?Ln(l):window,t){case"focusin":(fu(C)||C.contentEditable==="true")&&(kn=C,Fc=l,Mi=null);break;case"focusout":Mi=Fc=kn=null;break;case"mousedown":Bc=!0;break;case"contextmenu":case"mouseup":case"dragend":Bc=!1,vu(p,r,d);break;case"selectionchange":if(N_)break;case"keydown":case"keyup":vu(p,r,d)}var E;if(Fl)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Pn?Wf(t,r)&&(P="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(Kf&&r.locale!=="ko"&&(Pn||P!=="onCompositionStart"?P==="onCompositionEnd"&&Pn&&(E=Hf()):(yr=d,jl="value"in yr?yr.value:yr.textContent,Pn=!0)),C=Do(l,P),0<C.length&&(P=new lu(P,t,null,r,d),p.push({event:P,listeners:C}),E?P.data=E:(E=Qf(r),E!==null&&(P.data=E)))),(E=b_?C_(t,r):T_(t,r))&&(l=Do(l,"onBeforeInput"),0<l.length&&(d=new lu("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:l}),d.data=E))}sh(p,e)})}function Qi(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Do(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Bi(t,r),s!=null&&n.unshift(Qi(t,s,i)),s=Bi(t,e),s!=null&&n.push(Qi(t,s,i))),t=t.return}return n}function sn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Su(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,c=a.alternate,l=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&l!==null&&(a=l,i?(c=Bi(r,s),c!=null&&o.unshift(Qi(r,c,a))):i||(c=Bi(r,s),c!=null&&o.push(Qi(r,c,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var F_=/\r\n?/g,B_=/\u0000|\uFFFD/g;function Ru(t){return(typeof t=="string"?t:""+t).replace(F_,`
`).replace(B_,"")}function Ms(t,e,r){if(e=Ru(e),Ru(t)!==e&&r)throw Error(R(425))}function Eo(){}var zc=null,Uc=null;function Vc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hc=typeof setTimeout=="function"?setTimeout:void 0,z_=typeof clearTimeout=="function"?clearTimeout:void 0,bu=typeof Promise=="function"?Promise:void 0,U_=typeof queueMicrotask=="function"?queueMicrotask:typeof bu<"u"?function(t){return bu.resolve(null).then(t).catch(V_)}:Hc;function V_(t){setTimeout(function(){throw t})}function Qa(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Vi(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Vi(e)}function Cr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Cu(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ei=Math.random().toString(36).slice(2),$t="__reactFiber$"+ei,qi="__reactProps$"+ei,tr="__reactContainer$"+ei,Kc="__reactEvents$"+ei,H_="__reactListeners$"+ei,K_="__reactHandles$"+ei;function Ur(t){var e=t[$t];if(e)return e;for(var r=t.parentNode;r;){if(e=r[tr]||r[$t]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Cu(t);t!==null;){if(r=t[$t])return r;t=Cu(t)}return e}t=r,r=t.parentNode}return null}function ss(t){return t=t[$t]||t[tr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ln(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function Go(t){return t[qi]||null}var Wc=[],Mn=-1;function jr(t){return{current:t}}function ae(t){0>Mn||(t.current=Wc[Mn],Wc[Mn]=null,Mn--)}function se(t,e){Mn++,Wc[Mn]=t.current,t.current=e}var Or={},Ae=jr(Or),Qe=jr(!1),Qr=Or;function Wn(t,e){var r=t.type.contextTypes;if(!r)return Or;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function qe(t){return t=t.childContextTypes,t!=null}function Po(){ae(Qe),ae(Ae)}function Tu(t,e,r){if(Ae.current!==Or)throw Error(R(168));se(Ae,e),se(Qe,r)}function ah(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(R(108,kg(t)||"Unknown",i));return fe({},r,n)}function ko(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Or,Qr=Ae.current,se(Ae,t),se(Qe,Qe.current),!0}function Du(t,e,r){var n=t.stateNode;if(!n)throw Error(R(169));r?(t=ah(t,e,Qr),n.__reactInternalMemoizedMergedChildContext=t,ae(Qe),ae(Ae),se(Ae,t)):ae(Qe),se(Qe,r)}var Yt=null,Yo=!1,qa=!1;function ch(t){Yt===null?Yt=[t]:Yt.push(t)}function W_(t){Yo=!0,ch(t)}function $r(){if(!qa&&Yt!==null){qa=!0;var t=0,e=ee;try{var r=Yt;for(ee=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Yt=null,Yo=!1}catch(i){throw Yt!==null&&(Yt=Yt.slice(t+1)),Of(Ml,$r),i}finally{ee=e,qa=!1}}return null}var On=[],In=0,xo=null,Lo=0,it=[],st=0,qr=null,Xt=1,Zt="";function Br(t,e){On[In++]=Lo,On[In++]=xo,xo=t,Lo=e}function lh(t,e,r){it[st++]=Xt,it[st++]=Zt,it[st++]=qr,qr=t;var n=Xt;t=Zt;var i=32-yt(n)-1;n&=~(1<<i),r+=1;var s=32-yt(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Xt=1<<32-yt(e)+i|r<<i|n,Zt=s+t}else Xt=1<<s|r<<i|n,Zt=t}function zl(t){t.return!==null&&(Br(t,1),lh(t,1,0))}function Ul(t){for(;t===xo;)xo=On[--In],On[In]=null,Lo=On[--In],On[In]=null;for(;t===qr;)qr=it[--st],it[st]=null,Zt=it[--st],it[st]=null,Xt=it[--st],it[st]=null}var Je=null,Ze=null,de=!1,vt=null;function dh(t,e){var r=at(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Eu(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Je=t,Ze=Cr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Je=t,Ze=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=qr!==null?{id:Xt,overflow:Zt}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=at(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Je=t,Ze=null,!0):!1;default:return!1}}function Qc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function qc(t){if(de){var e=Ze;if(e){var r=e;if(!Eu(t,e)){if(Qc(t))throw Error(R(418));e=Cr(r.nextSibling);var n=Je;e&&Eu(t,e)?dh(n,r):(t.flags=t.flags&-4097|2,de=!1,Je=t)}}else{if(Qc(t))throw Error(R(418));t.flags=t.flags&-4097|2,de=!1,Je=t}}}function Pu(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Je=t}function Os(t){if(t!==Je)return!1;if(!de)return Pu(t),de=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Vc(t.type,t.memoizedProps)),e&&(e=Ze)){if(Qc(t))throw uh(),Error(R(418));for(;e;)dh(t,e),e=Cr(e.nextSibling)}if(Pu(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ze=Cr(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ze=null}}else Ze=Je?Cr(t.stateNode.nextSibling):null;return!0}function uh(){for(var t=Ze;t;)t=Cr(t.nextSibling)}function Qn(){Ze=Je=null,de=!1}function Vl(t){vt===null?vt=[t]:vt.push(t)}var Q_=ir.ReactCurrentBatchConfig;function hi(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(R(309));var n=r.stateNode}if(!n)throw Error(R(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(R(284));if(!r._owner)throw Error(R(290,t))}return t}function Is(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ku(t){var e=t._init;return e(t._payload)}function ph(t){function e(g,_){if(t){var v=g.deletions;v===null?(g.deletions=[_],g.flags|=16):v.push(_)}}function r(g,_){if(!t)return null;for(;_!==null;)e(g,_),_=_.sibling;return null}function n(g,_){for(g=new Map;_!==null;)_.key!==null?g.set(_.key,_):g.set(_.index,_),_=_.sibling;return g}function i(g,_){return g=Pr(g,_),g.index=0,g.sibling=null,g}function s(g,_,v){return g.index=v,t?(v=g.alternate,v!==null?(v=v.index,v<_?(g.flags|=2,_):v):(g.flags|=2,_)):(g.flags|=1048576,_)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,_,v,w){return _===null||_.tag!==6?(_=tc(v,g.mode,w),_.return=g,_):(_=i(_,v),_.return=g,_)}function c(g,_,v,w){var b=v.type;return b===En?d(g,_,v.props.children,w,v.key):_!==null&&(_.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===mr&&ku(b)===_.type)?(w=i(_,v.props),w.ref=hi(g,_,v),w.return=g,w):(w=fo(v.type,v.key,v.props,null,g.mode,w),w.ref=hi(g,_,v),w.return=g,w)}function l(g,_,v,w){return _===null||_.tag!==4||_.stateNode.containerInfo!==v.containerInfo||_.stateNode.implementation!==v.implementation?(_=rc(v,g.mode,w),_.return=g,_):(_=i(_,v.children||[]),_.return=g,_)}function d(g,_,v,w,b){return _===null||_.tag!==7?(_=Wr(v,g.mode,w,b),_.return=g,_):(_=i(_,v),_.return=g,_)}function p(g,_,v){if(typeof _=="string"&&_!==""||typeof _=="number")return _=tc(""+_,g.mode,v),_.return=g,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case bs:return v=fo(_.type,_.key,_.props,null,g.mode,v),v.ref=hi(g,null,_),v.return=g,v;case Dn:return _=rc(_,g.mode,v),_.return=g,_;case mr:var w=_._init;return p(g,w(_._payload),v)}if(bi(_)||li(_))return _=Wr(_,g.mode,v,null),_.return=g,_;Is(g,_)}return null}function u(g,_,v,w){var b=_!==null?_.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return b!==null?null:a(g,_,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case bs:return v.key===b?c(g,_,v,w):null;case Dn:return v.key===b?l(g,_,v,w):null;case mr:return b=v._init,u(g,_,b(v._payload),w)}if(bi(v)||li(v))return b!==null?null:d(g,_,v,w,null);Is(g,v)}return null}function f(g,_,v,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(v)||null,a(_,g,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case bs:return g=g.get(w.key===null?v:w.key)||null,c(_,g,w,b);case Dn:return g=g.get(w.key===null?v:w.key)||null,l(_,g,w,b);case mr:var C=w._init;return f(g,_,v,C(w._payload),b)}if(bi(w)||li(w))return g=g.get(v)||null,d(_,g,w,b,null);Is(_,w)}return null}function h(g,_,v,w){for(var b=null,C=null,E=_,P=_=0,Y=null;E!==null&&P<v.length;P++){E.index>P?(Y=E,E=null):Y=E.sibling;var $=u(g,E,v[P],w);if($===null){E===null&&(E=Y);break}t&&E&&$.alternate===null&&e(g,E),_=s($,_,P),C===null?b=$:C.sibling=$,C=$,E=Y}if(P===v.length)return r(g,E),de&&Br(g,P),b;if(E===null){for(;P<v.length;P++)E=p(g,v[P],w),E!==null&&(_=s(E,_,P),C===null?b=E:C.sibling=E,C=E);return de&&Br(g,P),b}for(E=n(g,E);P<v.length;P++)Y=f(E,g,P,v[P],w),Y!==null&&(t&&Y.alternate!==null&&E.delete(Y.key===null?P:Y.key),_=s(Y,_,P),C===null?b=Y:C.sibling=Y,C=Y);return t&&E.forEach(function(ve){return e(g,ve)}),de&&Br(g,P),b}function m(g,_,v,w){var b=li(v);if(typeof b!="function")throw Error(R(150));if(v=b.call(v),v==null)throw Error(R(151));for(var C=b=null,E=_,P=_=0,Y=null,$=v.next();E!==null&&!$.done;P++,$=v.next()){E.index>P?(Y=E,E=null):Y=E.sibling;var ve=u(g,E,$.value,w);if(ve===null){E===null&&(E=Y);break}t&&E&&ve.alternate===null&&e(g,E),_=s(ve,_,P),C===null?b=ve:C.sibling=ve,C=ve,E=Y}if($.done)return r(g,E),de&&Br(g,P),b;if(E===null){for(;!$.done;P++,$=v.next())$=p(g,$.value,w),$!==null&&(_=s($,_,P),C===null?b=$:C.sibling=$,C=$);return de&&Br(g,P),b}for(E=n(g,E);!$.done;P++,$=v.next())$=f(E,g,P,$.value,w),$!==null&&(t&&$.alternate!==null&&E.delete($.key===null?P:$.key),_=s($,_,P),C===null?b=$:C.sibling=$,C=$);return t&&E.forEach(function(Ie){return e(g,Ie)}),de&&Br(g,P),b}function y(g,_,v,w){if(typeof v=="object"&&v!==null&&v.type===En&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case bs:e:{for(var b=v.key,C=_;C!==null;){if(C.key===b){if(b=v.type,b===En){if(C.tag===7){r(g,C.sibling),_=i(C,v.props.children),_.return=g,g=_;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===mr&&ku(b)===C.type){r(g,C.sibling),_=i(C,v.props),_.ref=hi(g,C,v),_.return=g,g=_;break e}r(g,C);break}else e(g,C);C=C.sibling}v.type===En?(_=Wr(v.props.children,g.mode,w,v.key),_.return=g,g=_):(w=fo(v.type,v.key,v.props,null,g.mode,w),w.ref=hi(g,_,v),w.return=g,g=w)}return o(g);case Dn:e:{for(C=v.key;_!==null;){if(_.key===C)if(_.tag===4&&_.stateNode.containerInfo===v.containerInfo&&_.stateNode.implementation===v.implementation){r(g,_.sibling),_=i(_,v.children||[]),_.return=g,g=_;break e}else{r(g,_);break}else e(g,_);_=_.sibling}_=rc(v,g.mode,w),_.return=g,g=_}return o(g);case mr:return C=v._init,y(g,_,C(v._payload),w)}if(bi(v))return h(g,_,v,w);if(li(v))return m(g,_,v,w);Is(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,_!==null&&_.tag===6?(r(g,_.sibling),_=i(_,v),_.return=g,g=_):(r(g,_),_=tc(v,g.mode,w),_.return=g,g=_),o(g)):r(g,_)}return y}var qn=ph(!0),fh=ph(!1),Mo=jr(null),Oo=null,Nn=null,Hl=null;function Kl(){Hl=Nn=Oo=null}function Wl(t){var e=Mo.current;ae(Mo),t._currentValue=e}function Gc(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Un(t,e){Oo=t,Hl=Nn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(We=!0),t.firstContext=null)}function lt(t){var e=t._currentValue;if(Hl!==t)if(t={context:t,memoizedValue:e,next:null},Nn===null){if(Oo===null)throw Error(R(308));Nn=t,Oo.dependencies={lanes:0,firstContext:t}}else Nn=Nn.next=t;return e}var Vr=null;function Ql(t){Vr===null?Vr=[t]:Vr.push(t)}function hh(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Ql(e)):(r.next=i.next,i.next=r),e.interleaved=r,rr(t,n)}function rr(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var gr=!1;function ql(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mh(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Tr(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,q&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,rr(t,r)}return i=n.interleaved,i===null?(e.next=e,Ql(n)):(e.next=i.next,i.next=e),n.interleaved=e,rr(t,r)}function oo(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ol(t,r)}}function xu(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Io(t,e,r,n){var i=t.updateQueue;gr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=c))}if(s!==null){var p=i.baseState;o=0,d=l=c=null,a=s;do{var u=a.lane,f=a.eventTime;if((n&u)===u){d!==null&&(d=d.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var h=t,m=a;switch(u=e,f=r,m.tag){case 1:if(h=m.payload,typeof h=="function"){p=h.call(f,p,u);break e}p=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=m.payload,u=typeof h=="function"?h.call(f,p,u):h,u==null)break e;p=fe({},p,u);break e;case 2:gr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,u=i.effects,u===null?i.effects=[a]:u.push(a))}else f={eventTime:f,lane:u,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(l=d=f,c=p):d=d.next=f,o|=u;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;u=a,a=u.next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}while(!0);if(d===null&&(c=p),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Yr|=o,t.lanes=o,t.memoizedState=p}}function Lu(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(R(191,i));i.call(n)}}}var os={},Ft=jr(os),Gi=jr(os),Yi=jr(os);function Hr(t){if(t===os)throw Error(R(174));return t}function Gl(t,e){switch(se(Yi,e),se(Gi,t),se(Ft,os),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=kc(e,t)}ae(Ft),se(Ft,e)}function Gn(){ae(Ft),ae(Gi),ae(Yi)}function gh(t){Hr(Yi.current);var e=Hr(Ft.current),r=kc(e,t.type);e!==r&&(se(Gi,t),se(Ft,r))}function Yl(t){Gi.current===t&&(ae(Ft),ae(Gi))}var ue=jr(0);function No(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ga=[];function Xl(){for(var t=0;t<Ga.length;t++)Ga[t]._workInProgressVersionPrimary=null;Ga.length=0}var ao=ir.ReactCurrentDispatcher,Ya=ir.ReactCurrentBatchConfig,Gr=0,pe=null,De=null,ke=null,jo=!1,Oi=!1,Xi=0,q_=0;function Ne(){throw Error(R(321))}function Zl(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!St(t[r],e[r]))return!1;return!0}function Jl(t,e,r,n,i,s){if(Gr=s,pe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ao.current=t===null||t.memoizedState===null?Z_:J_,t=r(n,i),Oi){s=0;do{if(Oi=!1,Xi=0,25<=s)throw Error(R(301));s+=1,ke=De=null,e.updateQueue=null,ao.current=ev,t=r(n,i)}while(Oi)}if(ao.current=$o,e=De!==null&&De.next!==null,Gr=0,ke=De=pe=null,jo=!1,e)throw Error(R(300));return t}function ed(){var t=Xi!==0;return Xi=0,t}function jt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ke===null?pe.memoizedState=ke=t:ke=ke.next=t,ke}function dt(){if(De===null){var t=pe.alternate;t=t!==null?t.memoizedState:null}else t=De.next;var e=ke===null?pe.memoizedState:ke.next;if(e!==null)ke=e,De=t;else{if(t===null)throw Error(R(310));De=t,t={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},ke===null?pe.memoizedState=ke=t:ke=ke.next=t}return ke}function Zi(t,e){return typeof e=="function"?e(t):e}function Xa(t){var e=dt(),r=e.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=t;var n=De,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,c=null,l=s;do{var d=l.lane;if((Gr&d)===d)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:t(n,l.action);else{var p={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=p,o=n):c=c.next=p,pe.lanes|=d,Yr|=d}l=l.next}while(l!==null&&l!==s);c===null?o=n:c.next=a,St(n,e.memoizedState)||(We=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,pe.lanes|=s,Yr|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Za(t){var e=dt(),r=e.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);St(s,e.memoizedState)||(We=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function _h(){}function vh(t,e){var r=pe,n=dt(),i=e(),s=!St(n.memoizedState,i);if(s&&(n.memoizedState=i,We=!0),n=n.queue,td(Sh.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ke!==null&&ke.memoizedState.tag&1){if(r.flags|=2048,Ji(9,wh.bind(null,r,n,i,e),void 0,null),xe===null)throw Error(R(349));Gr&30||yh(r,e,i)}return i}function yh(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=pe.updateQueue,e===null?(e={lastEffect:null,stores:null},pe.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function wh(t,e,r,n){e.value=r,e.getSnapshot=n,Rh(e)&&bh(t)}function Sh(t,e,r){return r(function(){Rh(e)&&bh(t)})}function Rh(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!St(t,r)}catch{return!0}}function bh(t){var e=rr(t,1);e!==null&&wt(e,t,1,-1)}function Mu(t){var e=jt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:t},e.queue=t,t=t.dispatch=X_.bind(null,pe,t),[e.memoizedState,t]}function Ji(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=pe.updateQueue,e===null?(e={lastEffect:null,stores:null},pe.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Ch(){return dt().memoizedState}function co(t,e,r,n){var i=jt();pe.flags|=t,i.memoizedState=Ji(1|e,r,void 0,n===void 0?null:n)}function Xo(t,e,r,n){var i=dt();n=n===void 0?null:n;var s=void 0;if(De!==null){var o=De.memoizedState;if(s=o.destroy,n!==null&&Zl(n,o.deps)){i.memoizedState=Ji(e,r,s,n);return}}pe.flags|=t,i.memoizedState=Ji(1|e,r,s,n)}function Ou(t,e){return co(8390656,8,t,e)}function td(t,e){return Xo(2048,8,t,e)}function Th(t,e){return Xo(4,2,t,e)}function Dh(t,e){return Xo(4,4,t,e)}function Eh(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ph(t,e,r){return r=r!=null?r.concat([t]):null,Xo(4,4,Eh.bind(null,e,t),r)}function rd(){}function kh(t,e){var r=dt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Zl(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function xh(t,e){var r=dt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Zl(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Lh(t,e,r){return Gr&21?(St(r,e)||(r=jf(),pe.lanes|=r,Yr|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,We=!0),t.memoizedState=r)}function G_(t,e){var r=ee;ee=r!==0&&4>r?r:4,t(!0);var n=Ya.transition;Ya.transition={};try{t(!1),e()}finally{ee=r,Ya.transition=n}}function Mh(){return dt().memoizedState}function Y_(t,e,r){var n=Er(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Oh(t))Ih(e,r);else if(r=hh(t,e,r,n),r!==null){var i=Ue();wt(r,t,n,i),Nh(r,e,n)}}function X_(t,e,r){var n=Er(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Oh(t))Ih(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,St(a,o)){var c=e.interleaved;c===null?(i.next=i,Ql(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=hh(t,e,i,n),r!==null&&(i=Ue(),wt(r,t,n,i),Nh(r,e,n))}}function Oh(t){var e=t.alternate;return t===pe||e!==null&&e===pe}function Ih(t,e){Oi=jo=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Nh(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ol(t,r)}}var $o={readContext:lt,useCallback:Ne,useContext:Ne,useEffect:Ne,useImperativeHandle:Ne,useInsertionEffect:Ne,useLayoutEffect:Ne,useMemo:Ne,useReducer:Ne,useRef:Ne,useState:Ne,useDebugValue:Ne,useDeferredValue:Ne,useTransition:Ne,useMutableSource:Ne,useSyncExternalStore:Ne,useId:Ne,unstable_isNewReconciler:!1},Z_={readContext:lt,useCallback:function(t,e){return jt().memoizedState=[t,e===void 0?null:e],t},useContext:lt,useEffect:Ou,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,co(4194308,4,Eh.bind(null,e,t),r)},useLayoutEffect:function(t,e){return co(4194308,4,t,e)},useInsertionEffect:function(t,e){return co(4,2,t,e)},useMemo:function(t,e){var r=jt();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=jt();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Y_.bind(null,pe,t),[n.memoizedState,t]},useRef:function(t){var e=jt();return t={current:t},e.memoizedState=t},useState:Mu,useDebugValue:rd,useDeferredValue:function(t){return jt().memoizedState=t},useTransition:function(){var t=Mu(!1),e=t[0];return t=G_.bind(null,t[1]),jt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=pe,i=jt();if(de){if(r===void 0)throw Error(R(407));r=r()}else{if(r=e(),xe===null)throw Error(R(349));Gr&30||yh(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Ou(Sh.bind(null,n,s,t),[t]),n.flags|=2048,Ji(9,wh.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=jt(),e=xe.identifierPrefix;if(de){var r=Zt,n=Xt;r=(n&~(1<<32-yt(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Xi++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=q_++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},J_={readContext:lt,useCallback:kh,useContext:lt,useEffect:td,useImperativeHandle:Ph,useInsertionEffect:Th,useLayoutEffect:Dh,useMemo:xh,useReducer:Xa,useRef:Ch,useState:function(){return Xa(Zi)},useDebugValue:rd,useDeferredValue:function(t){var e=dt();return Lh(e,De.memoizedState,t)},useTransition:function(){var t=Xa(Zi)[0],e=dt().memoizedState;return[t,e]},useMutableSource:_h,useSyncExternalStore:vh,useId:Mh,unstable_isNewReconciler:!1},ev={readContext:lt,useCallback:kh,useContext:lt,useEffect:td,useImperativeHandle:Ph,useInsertionEffect:Th,useLayoutEffect:Dh,useMemo:xh,useReducer:Za,useRef:Ch,useState:function(){return Za(Zi)},useDebugValue:rd,useDeferredValue:function(t){var e=dt();return De===null?e.memoizedState=t:Lh(e,De.memoizedState,t)},useTransition:function(){var t=Za(Zi)[0],e=dt().memoizedState;return[t,e]},useMutableSource:_h,useSyncExternalStore:vh,useId:Mh,unstable_isNewReconciler:!1};function mt(t,e){if(t&&t.defaultProps){e=fe({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Yc(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:fe({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Zo={isMounted:function(t){return(t=t._reactInternals)?Jr(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ue(),i=Er(t),s=Jt(n,i);s.payload=e,r!=null&&(s.callback=r),e=Tr(t,s,i),e!==null&&(wt(e,t,i,n),oo(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ue(),i=Er(t),s=Jt(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Tr(t,s,i),e!==null&&(wt(e,t,i,n),oo(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ue(),n=Er(t),i=Jt(r,n);i.tag=2,e!=null&&(i.callback=e),e=Tr(t,i,n),e!==null&&(wt(e,t,n,r),oo(e,t,n))}};function Iu(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ki(r,n)||!Ki(i,s):!0}function jh(t,e,r){var n=!1,i=Or,s=e.contextType;return typeof s=="object"&&s!==null?s=lt(s):(i=qe(e)?Qr:Ae.current,n=e.contextTypes,s=(n=n!=null)?Wn(t,i):Or),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zo,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Nu(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Zo.enqueueReplaceState(e,e.state,null)}function Xc(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},ql(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=lt(s):(s=qe(e)?Qr:Ae.current,i.context=Wn(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Yc(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Zo.enqueueReplaceState(i,i.state,null),Io(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Yn(t,e){try{var r="",n=e;do r+=Pg(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ja(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Zc(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var tv=typeof WeakMap=="function"?WeakMap:Map;function $h(t,e,r){r=Jt(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Fo||(Fo=!0,cl=n),Zc(t,e)},r}function Ah(t,e,r){r=Jt(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Zc(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Zc(t,e),typeof n!="function"&&(Dr===null?Dr=new Set([this]):Dr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function ju(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new tv;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=mv.bind(null,t,e,r),e.then(t,t))}function $u(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Au(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Jt(-1,1),e.tag=2,Tr(r,e,1))),r.lanes|=1),t)}var rv=ir.ReactCurrentOwner,We=!1;function ze(t,e,r,n){e.child=t===null?fh(e,null,r,n):qn(e,t.child,r,n)}function Fu(t,e,r,n,i){r=r.render;var s=e.ref;return Un(e,i),n=Jl(t,e,r,n,s,i),r=ed(),t!==null&&!We?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,nr(t,e,i)):(de&&r&&zl(e),e.flags|=1,ze(t,e,n,i),e.child)}function Bu(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!dd(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,Fh(t,e,s,n,i)):(t=fo(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ki,r(o,n)&&t.ref===e.ref)return nr(t,e,i)}return e.flags|=1,t=Pr(s,n),t.ref=e.ref,t.return=e,e.child=t}function Fh(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Ki(s,n)&&t.ref===e.ref)if(We=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(We=!0);else return e.lanes=t.lanes,nr(t,e,i)}return Jc(t,e,r,n,i)}function Bh(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},se($n,Xe),Xe|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,se($n,Xe),Xe|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,se($n,Xe),Xe|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,se($n,Xe),Xe|=n;return ze(t,e,i,r),e.child}function zh(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Jc(t,e,r,n,i){var s=qe(r)?Qr:Ae.current;return s=Wn(e,s),Un(e,i),r=Jl(t,e,r,n,s,i),n=ed(),t!==null&&!We?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,nr(t,e,i)):(de&&n&&zl(e),e.flags|=1,ze(t,e,r,i),e.child)}function zu(t,e,r,n,i){if(qe(r)){var s=!0;ko(e)}else s=!1;if(Un(e,i),e.stateNode===null)lo(t,e),jh(e,r,n),Xc(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=r.contextType;typeof l=="object"&&l!==null?l=lt(l):(l=qe(r)?Qr:Ae.current,l=Wn(e,l));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==l)&&Nu(e,o,n,l),gr=!1;var u=e.memoizedState;o.state=u,Io(e,n,o,i),c=e.memoizedState,a!==n||u!==c||Qe.current||gr?(typeof d=="function"&&(Yc(e,r,d,n),c=e.memoizedState),(a=gr||Iu(e,r,a,n,u,c,l))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=l,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,mh(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:mt(e.type,a),o.props=l,p=e.pendingProps,u=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=lt(c):(c=qe(r)?Qr:Ae.current,c=Wn(e,c));var f=r.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||u!==c)&&Nu(e,o,n,c),gr=!1,u=e.memoizedState,o.state=u,Io(e,n,o,i);var h=e.memoizedState;a!==p||u!==h||Qe.current||gr?(typeof f=="function"&&(Yc(e,r,f,n),h=e.memoizedState),(l=gr||Iu(e,r,l,n,u,h,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,h,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,h,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=h),o.props=n,o.state=h,o.context=c,n=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=1024),n=!1)}return el(t,e,r,n,s,i)}function el(t,e,r,n,i,s){zh(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Du(e,r,!1),nr(t,e,s);n=e.stateNode,rv.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=qn(e,t.child,null,s),e.child=qn(e,null,a,s)):ze(t,e,a,s),e.memoizedState=n.state,i&&Du(e,r,!0),e.child}function Uh(t){var e=t.stateNode;e.pendingContext?Tu(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Tu(t,e.context,!1),Gl(t,e.containerInfo)}function Uu(t,e,r,n,i){return Qn(),Vl(i),e.flags|=256,ze(t,e,r,n),e.child}var tl={dehydrated:null,treeContext:null,retryLane:0};function rl(t){return{baseLanes:t,cachePool:null,transitions:null}}function Vh(t,e,r){var n=e.pendingProps,i=ue.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),se(ue,i&1),t===null)return qc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ta(o,n,0,null),t=Wr(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=rl(r),e.memoizedState=tl,t):nd(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return nv(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Pr(i,c),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Pr(a,s):(s=Wr(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?rl(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=tl,n}return s=t.child,t=s.sibling,n=Pr(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function nd(t,e){return e=ta({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ns(t,e,r,n){return n!==null&&Vl(n),qn(e,t.child,null,r),t=nd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function nv(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Ja(Error(R(422))),Ns(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=ta({mode:"visible",children:n.children},i,0,null),s=Wr(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&qn(e,t.child,null,o),e.child.memoizedState=rl(o),e.memoizedState=tl,s);if(!(e.mode&1))return Ns(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(R(419)),n=Ja(s,n,void 0),Ns(t,e,o,n)}if(a=(o&t.childLanes)!==0,We||a){if(n=xe,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,rr(t,i),wt(n,t,i,-1))}return ld(),n=Ja(Error(R(421))),Ns(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=gv.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ze=Cr(i.nextSibling),Je=e,de=!0,vt=null,t!==null&&(it[st++]=Xt,it[st++]=Zt,it[st++]=qr,Xt=t.id,Zt=t.overflow,qr=e),e=nd(e,n.children),e.flags|=4096,e)}function Vu(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Gc(t.return,e,r)}function ec(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Hh(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ze(t,e,n.children,r),n=ue.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Vu(t,r,e);else if(t.tag===19)Vu(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(se(ue,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&No(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),ec(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&No(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}ec(e,!0,r,null,s);break;case"together":ec(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function lo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nr(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Yr|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,r=Pr(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Pr(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function iv(t,e,r){switch(e.tag){case 3:Uh(e),Qn();break;case 5:gh(e);break;case 1:qe(e.type)&&ko(e);break;case 4:Gl(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;se(Mo,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(se(ue,ue.current&1),e.flags|=128,null):r&e.child.childLanes?Vh(t,e,r):(se(ue,ue.current&1),t=nr(t,e,r),t!==null?t.sibling:null);se(ue,ue.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Hh(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),se(ue,ue.current),n)break;return null;case 22:case 23:return e.lanes=0,Bh(t,e,r)}return nr(t,e,r)}var Kh,nl,Wh,Qh;Kh=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nl=function(){};Wh=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Hr(Ft.current);var s=null;switch(r){case"input":i=Tc(t,i),n=Tc(t,n),s=[];break;case"select":i=fe({},i,{value:void 0}),n=fe({},n,{value:void 0}),s=[];break;case"textarea":i=Pc(t,i),n=Pc(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Eo)}xc(r,n);var o;r=null;for(l in i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Ai.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var c=n[l];if(a=i!=null?i[l]:void 0,n.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Ai.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&oe("scroll",t),s||a===c||(s=[])):(s=s||[]).push(l,c))}r&&(s=s||[]).push("style",r);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};Qh=function(t,e,r,n){r!==n&&(e.flags|=4)};function mi(t,e){if(!de)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function je(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function sv(t,e,r){var n=e.pendingProps;switch(Ul(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return je(e),null;case 1:return qe(e.type)&&Po(),je(e),null;case 3:return n=e.stateNode,Gn(),ae(Qe),ae(Ae),Xl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Os(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vt!==null&&(ul(vt),vt=null))),nl(t,e),je(e),null;case 5:Yl(e);var i=Hr(Yi.current);if(r=e.type,t!==null&&e.stateNode!=null)Wh(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(R(166));return je(e),null}if(t=Hr(Ft.current),Os(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[$t]=e,n[qi]=s,t=(e.mode&1)!==0,r){case"dialog":oe("cancel",n),oe("close",n);break;case"iframe":case"object":case"embed":oe("load",n);break;case"video":case"audio":for(i=0;i<Ti.length;i++)oe(Ti[i],n);break;case"source":oe("error",n);break;case"img":case"image":case"link":oe("error",n),oe("load",n);break;case"details":oe("toggle",n);break;case"input":Zd(n,s),oe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},oe("invalid",n);break;case"textarea":eu(n,s),oe("invalid",n)}xc(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ms(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ms(n.textContent,a,t),i=["children",""+a]):Ai.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&oe("scroll",n)}switch(r){case"input":Cs(n),Jd(n,s,!0);break;case"textarea":Cs(n),tu(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Eo)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Sf(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[$t]=e,t[qi]=n,Kh(t,e,!1,!1),e.stateNode=t;e:{switch(o=Lc(r,n),r){case"dialog":oe("cancel",t),oe("close",t),i=n;break;case"iframe":case"object":case"embed":oe("load",t),i=n;break;case"video":case"audio":for(i=0;i<Ti.length;i++)oe(Ti[i],t);i=n;break;case"source":oe("error",t),i=n;break;case"img":case"image":case"link":oe("error",t),oe("load",t),i=n;break;case"details":oe("toggle",t),i=n;break;case"input":Zd(t,n),i=Tc(t,n),oe("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=fe({},n,{value:void 0}),oe("invalid",t);break;case"textarea":eu(t,n),i=Pc(t,n),oe("invalid",t);break;default:i=n}xc(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?Cf(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Rf(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Fi(t,c):typeof c=="number"&&Fi(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ai.hasOwnProperty(s)?c!=null&&s==="onScroll"&&oe("scroll",t):c!=null&&El(t,s,c,o))}switch(r){case"input":Cs(t),Jd(t,n,!1);break;case"textarea":Cs(t),tu(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Mr(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?An(t,!!n.multiple,s,!1):n.defaultValue!=null&&An(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Eo)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return je(e),null;case 6:if(t&&e.stateNode!=null)Qh(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(R(166));if(r=Hr(Yi.current),Hr(Ft.current),Os(e)){if(n=e.stateNode,r=e.memoizedProps,n[$t]=e,(s=n.nodeValue!==r)&&(t=Je,t!==null))switch(t.tag){case 3:Ms(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ms(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$t]=e,e.stateNode=n}return je(e),null;case 13:if(ae(ue),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(de&&Ze!==null&&e.mode&1&&!(e.flags&128))uh(),Qn(),e.flags|=98560,s=!1;else if(s=Os(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(R(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(R(317));s[$t]=e}else Qn(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;je(e),s=!1}else vt!==null&&(ul(vt),vt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ue.current&1?Ee===0&&(Ee=3):ld())),e.updateQueue!==null&&(e.flags|=4),je(e),null);case 4:return Gn(),nl(t,e),t===null&&Wi(e.stateNode.containerInfo),je(e),null;case 10:return Wl(e.type._context),je(e),null;case 17:return qe(e.type)&&Po(),je(e),null;case 19:if(ae(ue),s=e.memoizedState,s===null)return je(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)mi(s,!1);else{if(Ee!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=No(t),o!==null){for(e.flags|=128,mi(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return se(ue,ue.current&1|2),e.child}t=t.sibling}s.tail!==null&&ye()>Xn&&(e.flags|=128,n=!0,mi(s,!1),e.lanes=4194304)}else{if(!n)if(t=No(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),mi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!de)return je(e),null}else 2*ye()-s.renderingStartTime>Xn&&r!==1073741824&&(e.flags|=128,n=!0,mi(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ye(),e.sibling=null,r=ue.current,se(ue,n?r&1|2:r&1),e):(je(e),null);case 22:case 23:return cd(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Xe&1073741824&&(je(e),e.subtreeFlags&6&&(e.flags|=8192)):je(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function ov(t,e){switch(Ul(e),e.tag){case 1:return qe(e.type)&&Po(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Gn(),ae(Qe),ae(Ae),Xl(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yl(e),null;case 13:if(ae(ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));Qn()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ae(ue),null;case 4:return Gn(),null;case 10:return Wl(e.type._context),null;case 22:case 23:return cd(),null;case 24:return null;default:return null}}var js=!1,$e=!1,av=typeof WeakSet=="function"?WeakSet:Set,D=null;function jn(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ge(t,e,n)}else r.current=null}function il(t,e,r){try{r()}catch(n){ge(t,e,n)}}var Hu=!1;function cv(t,e){if(zc=Co,t=Zf(),Bl(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,c=-1,l=0,d=0,p=t,u=null;t:for(;;){for(var f;p!==r||i!==0&&p.nodeType!==3||(a=o+i),p!==s||n!==0&&p.nodeType!==3||(c=o+n),p.nodeType===3&&(o+=p.nodeValue.length),(f=p.firstChild)!==null;)u=p,p=f;for(;;){if(p===t)break t;if(u===r&&++l===i&&(a=o),u===s&&++d===n&&(c=o),(f=p.nextSibling)!==null)break;p=u,u=p.parentNode}p=f}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Uc={focusedElem:t,selectionRange:r},Co=!1,D=e;D!==null;)if(e=D,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,D=t;else for(;D!==null;){e=D;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var m=h.memoizedProps,y=h.memoizedState,g=e.stateNode,_=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:mt(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(w){ge(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,D=t;break}D=e.return}return h=Hu,Hu=!1,h}function Ii(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&il(e,r,s)}i=i.next}while(i!==n)}}function Jo(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function sl(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function qh(t){var e=t.alternate;e!==null&&(t.alternate=null,qh(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$t],delete e[qi],delete e[Kc],delete e[H_],delete e[K_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Gh(t){return t.tag===5||t.tag===3||t.tag===4}function Ku(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gh(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ol(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Eo));else if(n!==4&&(t=t.child,t!==null))for(ol(t,e,r),t=t.sibling;t!==null;)ol(t,e,r),t=t.sibling}function al(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(al(t,e,r),t=t.sibling;t!==null;)al(t,e,r),t=t.sibling}var Le=null,gt=!1;function lr(t,e,r){for(r=r.child;r!==null;)Yh(t,e,r),r=r.sibling}function Yh(t,e,r){if(At&&typeof At.onCommitFiberUnmount=="function")try{At.onCommitFiberUnmount(Ko,r)}catch{}switch(r.tag){case 5:$e||jn(r,e);case 6:var n=Le,i=gt;Le=null,lr(t,e,r),Le=n,gt=i,Le!==null&&(gt?(t=Le,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Le.removeChild(r.stateNode));break;case 18:Le!==null&&(gt?(t=Le,r=r.stateNode,t.nodeType===8?Qa(t.parentNode,r):t.nodeType===1&&Qa(t,r),Vi(t)):Qa(Le,r.stateNode));break;case 4:n=Le,i=gt,Le=r.stateNode.containerInfo,gt=!0,lr(t,e,r),Le=n,gt=i;break;case 0:case 11:case 14:case 15:if(!$e&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&il(r,e,o),i=i.next}while(i!==n)}lr(t,e,r);break;case 1:if(!$e&&(jn(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){ge(r,e,a)}lr(t,e,r);break;case 21:lr(t,e,r);break;case 22:r.mode&1?($e=(n=$e)||r.memoizedState!==null,lr(t,e,r),$e=n):lr(t,e,r);break;default:lr(t,e,r)}}function Wu(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new av),e.forEach(function(n){var i=_v.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ht(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Le=a.stateNode,gt=!1;break e;case 3:Le=a.stateNode.containerInfo,gt=!0;break e;case 4:Le=a.stateNode.containerInfo,gt=!0;break e}a=a.return}if(Le===null)throw Error(R(160));Yh(s,o,i),Le=null,gt=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){ge(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Xh(e,t),e=e.sibling}function Xh(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ht(e,t),Dt(t),n&4){try{Ii(3,t,t.return),Jo(3,t)}catch(m){ge(t,t.return,m)}try{Ii(5,t,t.return)}catch(m){ge(t,t.return,m)}}break;case 1:ht(e,t),Dt(t),n&512&&r!==null&&jn(r,r.return);break;case 5:if(ht(e,t),Dt(t),n&512&&r!==null&&jn(r,r.return),t.flags&32){var i=t.stateNode;try{Fi(i,"")}catch(m){ge(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&yf(i,s),Lc(a,o);var l=Lc(a,s);for(o=0;o<c.length;o+=2){var d=c[o],p=c[o+1];d==="style"?Cf(i,p):d==="dangerouslySetInnerHTML"?Rf(i,p):d==="children"?Fi(i,p):El(i,d,p,l)}switch(a){case"input":Dc(i,s);break;case"textarea":wf(i,s);break;case"select":var u=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?An(i,!!s.multiple,f,!1):u!==!!s.multiple&&(s.defaultValue!=null?An(i,!!s.multiple,s.defaultValue,!0):An(i,!!s.multiple,s.multiple?[]:"",!1))}i[qi]=s}catch(m){ge(t,t.return,m)}}break;case 6:if(ht(e,t),Dt(t),n&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){ge(t,t.return,m)}}break;case 3:if(ht(e,t),Dt(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vi(e.containerInfo)}catch(m){ge(t,t.return,m)}break;case 4:ht(e,t),Dt(t);break;case 13:ht(e,t),Dt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(od=ye())),n&4&&Wu(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?($e=(l=$e)||d,ht(e,t),$e=l):ht(e,t),Dt(t),n&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!d&&t.mode&1)for(D=t,d=t.child;d!==null;){for(p=D=d;D!==null;){switch(u=D,f=u.child,u.tag){case 0:case 11:case 14:case 15:Ii(4,u,u.return);break;case 1:jn(u,u.return);var h=u.stateNode;if(typeof h.componentWillUnmount=="function"){n=u,r=u.return;try{e=n,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(m){ge(n,r,m)}}break;case 5:jn(u,u.return);break;case 22:if(u.memoizedState!==null){qu(p);continue}}f!==null?(f.return=u,D=f):qu(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=bf("display",o))}catch(m){ge(t,t.return,m)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=l?"":p.memoizedProps}catch(m){ge(t,t.return,m)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ht(e,t),Dt(t),n&4&&Wu(t);break;case 21:break;default:ht(e,t),Dt(t)}}function Dt(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Gh(r)){var n=r;break e}r=r.return}throw Error(R(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Fi(i,""),n.flags&=-33);var s=Ku(t);al(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=Ku(t);ol(t,a,o);break;default:throw Error(R(161))}}catch(c){ge(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function lv(t,e,r){D=t,Zh(t)}function Zh(t,e,r){for(var n=(t.mode&1)!==0;D!==null;){var i=D,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||js;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||$e;a=js;var l=$e;if(js=o,($e=c)&&!l)for(D=i;D!==null;)o=D,c=o.child,o.tag===22&&o.memoizedState!==null?Gu(i):c!==null?(c.return=o,D=c):Gu(i);for(;s!==null;)D=s,Zh(s),s=s.sibling;D=i,js=a,$e=l}Qu(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,D=s):Qu(t)}}function Qu(t){for(;D!==null;){var e=D;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$e||Jo(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!$e)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:mt(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Lu(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Lu(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var d=l.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&Vi(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}$e||e.flags&512&&sl(e)}catch(u){ge(e,e.return,u)}}if(e===t){D=null;break}if(r=e.sibling,r!==null){r.return=e.return,D=r;break}D=e.return}}function qu(t){for(;D!==null;){var e=D;if(e===t){D=null;break}var r=e.sibling;if(r!==null){r.return=e.return,D=r;break}D=e.return}}function Gu(t){for(;D!==null;){var e=D;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Jo(4,e)}catch(c){ge(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){ge(e,i,c)}}var s=e.return;try{sl(e)}catch(c){ge(e,s,c)}break;case 5:var o=e.return;try{sl(e)}catch(c){ge(e,o,c)}}}catch(c){ge(e,e.return,c)}if(e===t){D=null;break}var a=e.sibling;if(a!==null){a.return=e.return,D=a;break}D=e.return}}var dv=Math.ceil,Ao=ir.ReactCurrentDispatcher,id=ir.ReactCurrentOwner,ct=ir.ReactCurrentBatchConfig,q=0,xe=null,Re=null,Me=0,Xe=0,$n=jr(0),Ee=0,es=null,Yr=0,ea=0,sd=0,Ni=null,Ke=null,od=0,Xn=1/0,Gt=null,Fo=!1,cl=null,Dr=null,$s=!1,wr=null,Bo=0,ji=0,ll=null,uo=-1,po=0;function Ue(){return q&6?ye():uo!==-1?uo:uo=ye()}function Er(t){return t.mode&1?q&2&&Me!==0?Me&-Me:Q_.transition!==null?(po===0&&(po=jf()),po):(t=ee,t!==0||(t=window.event,t=t===void 0?16:Vf(t.type)),t):1}function wt(t,e,r,n){if(50<ji)throw ji=0,ll=null,Error(R(185));ns(t,r,n),(!(q&2)||t!==xe)&&(t===xe&&(!(q&2)&&(ea|=r),Ee===4&&vr(t,Me)),Ge(t,n),r===1&&q===0&&!(e.mode&1)&&(Xn=ye()+500,Yo&&$r()))}function Ge(t,e){var r=t.callbackNode;Qg(t,e);var n=bo(t,t===xe?Me:0);if(n===0)r!==null&&iu(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&iu(r),e===1)t.tag===0?W_(Yu.bind(null,t)):ch(Yu.bind(null,t)),U_(function(){!(q&6)&&$r()}),r=null;else{switch($f(n)){case 1:r=Ml;break;case 4:r=If;break;case 16:r=Ro;break;case 536870912:r=Nf;break;default:r=Ro}r=om(r,Jh.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Jh(t,e){if(uo=-1,po=0,q&6)throw Error(R(327));var r=t.callbackNode;if(Vn()&&t.callbackNode!==r)return null;var n=bo(t,t===xe?Me:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=zo(t,n);else{e=n;var i=q;q|=2;var s=tm();(xe!==t||Me!==e)&&(Gt=null,Xn=ye()+500,Kr(t,e));do try{fv();break}catch(a){em(t,a)}while(!0);Kl(),Ao.current=s,q=i,Re!==null?e=0:(xe=null,Me=0,e=Ee)}if(e!==0){if(e===2&&(i=jc(t),i!==0&&(n=i,e=dl(t,i))),e===1)throw r=es,Kr(t,0),vr(t,n),Ge(t,ye()),r;if(e===6)vr(t,n);else{if(i=t.current.alternate,!(n&30)&&!uv(i)&&(e=zo(t,n),e===2&&(s=jc(t),s!==0&&(n=s,e=dl(t,s))),e===1))throw r=es,Kr(t,0),vr(t,n),Ge(t,ye()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(R(345));case 2:zr(t,Ke,Gt);break;case 3:if(vr(t,n),(n&130023424)===n&&(e=od+500-ye(),10<e)){if(bo(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ue(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Hc(zr.bind(null,t,Ke,Gt),e);break}zr(t,Ke,Gt);break;case 4:if(vr(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-yt(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=ye()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*dv(n/1960))-n,10<n){t.timeoutHandle=Hc(zr.bind(null,t,Ke,Gt),n);break}zr(t,Ke,Gt);break;case 5:zr(t,Ke,Gt);break;default:throw Error(R(329))}}}return Ge(t,ye()),t.callbackNode===r?Jh.bind(null,t):null}function dl(t,e){var r=Ni;return t.current.memoizedState.isDehydrated&&(Kr(t,e).flags|=256),t=zo(t,e),t!==2&&(e=Ke,Ke=r,e!==null&&ul(e)),t}function ul(t){Ke===null?Ke=t:Ke.push.apply(Ke,t)}function uv(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!St(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vr(t,e){for(e&=~sd,e&=~ea,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-yt(e),n=1<<r;t[r]=-1,e&=~n}}function Yu(t){if(q&6)throw Error(R(327));Vn();var e=bo(t,0);if(!(e&1))return Ge(t,ye()),null;var r=zo(t,e);if(t.tag!==0&&r===2){var n=jc(t);n!==0&&(e=n,r=dl(t,n))}if(r===1)throw r=es,Kr(t,0),vr(t,e),Ge(t,ye()),r;if(r===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zr(t,Ke,Gt),Ge(t,ye()),null}function ad(t,e){var r=q;q|=1;try{return t(e)}finally{q=r,q===0&&(Xn=ye()+500,Yo&&$r())}}function Xr(t){wr!==null&&wr.tag===0&&!(q&6)&&Vn();var e=q;q|=1;var r=ct.transition,n=ee;try{if(ct.transition=null,ee=1,t)return t()}finally{ee=n,ct.transition=r,q=e,!(q&6)&&$r()}}function cd(){Xe=$n.current,ae($n)}function Kr(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,z_(r)),Re!==null)for(r=Re.return;r!==null;){var n=r;switch(Ul(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Po();break;case 3:Gn(),ae(Qe),ae(Ae),Xl();break;case 5:Yl(n);break;case 4:Gn();break;case 13:ae(ue);break;case 19:ae(ue);break;case 10:Wl(n.type._context);break;case 22:case 23:cd()}r=r.return}if(xe=t,Re=t=Pr(t.current,null),Me=Xe=e,Ee=0,es=null,sd=ea=Yr=0,Ke=Ni=null,Vr!==null){for(e=0;e<Vr.length;e++)if(r=Vr[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Vr=null}return t}function em(t,e){do{var r=Re;try{if(Kl(),ao.current=$o,jo){for(var n=pe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}jo=!1}if(Gr=0,ke=De=pe=null,Oi=!1,Xi=0,id.current=null,r===null||r.return===null){Ee=1,es=e,Re=null;break}e:{var s=t,o=r.return,a=r,c=e;if(e=Me,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var u=d.alternate;u?(d.updateQueue=u.updateQueue,d.memoizedState=u.memoizedState,d.lanes=u.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=$u(o);if(f!==null){f.flags&=-257,Au(f,o,a,s,e),f.mode&1&&ju(s,l,e),e=f,c=l;var h=e.updateQueue;if(h===null){var m=new Set;m.add(c),e.updateQueue=m}else h.add(c);break e}else{if(!(e&1)){ju(s,l,e),ld();break e}c=Error(R(426))}}else if(de&&a.mode&1){var y=$u(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Au(y,o,a,s,e),Vl(Yn(c,a));break e}}s=c=Yn(c,a),Ee!==4&&(Ee=2),Ni===null?Ni=[s]:Ni.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=$h(s,c,e);xu(s,g);break e;case 1:a=c;var _=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Dr===null||!Dr.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=Ah(s,a,e);xu(s,w);break e}}s=s.return}while(s!==null)}nm(r)}catch(b){e=b,Re===r&&r!==null&&(Re=r=r.return);continue}break}while(!0)}function tm(){var t=Ao.current;return Ao.current=$o,t===null?$o:t}function ld(){(Ee===0||Ee===3||Ee===2)&&(Ee=4),xe===null||!(Yr&268435455)&&!(ea&268435455)||vr(xe,Me)}function zo(t,e){var r=q;q|=2;var n=tm();(xe!==t||Me!==e)&&(Gt=null,Kr(t,e));do try{pv();break}catch(i){em(t,i)}while(!0);if(Kl(),q=r,Ao.current=n,Re!==null)throw Error(R(261));return xe=null,Me=0,Ee}function pv(){for(;Re!==null;)rm(Re)}function fv(){for(;Re!==null&&!Ag();)rm(Re)}function rm(t){var e=sm(t.alternate,t,Xe);t.memoizedProps=t.pendingProps,e===null?nm(t):Re=e,id.current=null}function nm(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=ov(r,e),r!==null){r.flags&=32767,Re=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ee=6,Re=null;return}}else if(r=sv(r,e,Xe),r!==null){Re=r;return}if(e=e.sibling,e!==null){Re=e;return}Re=e=t}while(e!==null);Ee===0&&(Ee=5)}function zr(t,e,r){var n=ee,i=ct.transition;try{ct.transition=null,ee=1,hv(t,e,r,n)}finally{ct.transition=i,ee=n}return null}function hv(t,e,r,n){do Vn();while(wr!==null);if(q&6)throw Error(R(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(qg(t,s),t===xe&&(Re=xe=null,Me=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$s||($s=!0,om(Ro,function(){return Vn(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ct.transition,ct.transition=null;var o=ee;ee=1;var a=q;q|=4,id.current=null,cv(t,r),Xh(r,t),I_(Uc),Co=!!zc,Uc=zc=null,t.current=r,lv(r),Fg(),q=a,ee=o,ct.transition=s}else t.current=r;if($s&&($s=!1,wr=t,Bo=i),s=t.pendingLanes,s===0&&(Dr=null),Ug(r.stateNode),Ge(t,ye()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Fo)throw Fo=!1,t=cl,cl=null,t;return Bo&1&&t.tag!==0&&Vn(),s=t.pendingLanes,s&1?t===ll?ji++:(ji=0,ll=t):ji=0,$r(),null}function Vn(){if(wr!==null){var t=$f(Bo),e=ct.transition,r=ee;try{if(ct.transition=null,ee=16>t?16:t,wr===null)var n=!1;else{if(t=wr,wr=null,Bo=0,q&6)throw Error(R(331));var i=q;for(q|=4,D=t.current;D!==null;){var s=D,o=s.child;if(D.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(D=l;D!==null;){var d=D;switch(d.tag){case 0:case 11:case 15:Ii(8,d,s)}var p=d.child;if(p!==null)p.return=d,D=p;else for(;D!==null;){d=D;var u=d.sibling,f=d.return;if(qh(d),d===l){D=null;break}if(u!==null){u.return=f,D=u;break}D=f}}}var h=s.alternate;if(h!==null){var m=h.child;if(m!==null){h.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}D=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,D=o;else e:for(;D!==null;){if(s=D,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ii(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,D=g;break e}D=s.return}}var _=t.current;for(D=_;D!==null;){o=D;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,D=v;else e:for(o=_;D!==null;){if(a=D,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Jo(9,a)}}catch(b){ge(a,a.return,b)}if(a===o){D=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,D=w;break e}D=a.return}}if(q=i,$r(),At&&typeof At.onPostCommitFiberRoot=="function")try{At.onPostCommitFiberRoot(Ko,t)}catch{}n=!0}return n}finally{ee=r,ct.transition=e}}return!1}function Xu(t,e,r){e=Yn(r,e),e=$h(t,e,1),t=Tr(t,e,1),e=Ue(),t!==null&&(ns(t,1,e),Ge(t,e))}function ge(t,e,r){if(t.tag===3)Xu(t,t,r);else for(;e!==null;){if(e.tag===3){Xu(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Dr===null||!Dr.has(n))){t=Yn(r,t),t=Ah(e,t,1),e=Tr(e,t,1),t=Ue(),e!==null&&(ns(e,1,t),Ge(e,t));break}}e=e.return}}function mv(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ue(),t.pingedLanes|=t.suspendedLanes&r,xe===t&&(Me&r)===r&&(Ee===4||Ee===3&&(Me&130023424)===Me&&500>ye()-od?Kr(t,0):sd|=r),Ge(t,e)}function im(t,e){e===0&&(t.mode&1?(e=Es,Es<<=1,!(Es&130023424)&&(Es=4194304)):e=1);var r=Ue();t=rr(t,e),t!==null&&(ns(t,e,r),Ge(t,r))}function gv(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),im(t,r)}function _v(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(R(314))}n!==null&&n.delete(e),im(t,r)}var sm;sm=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qe.current)We=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return We=!1,iv(t,e,r);We=!!(t.flags&131072)}else We=!1,de&&e.flags&1048576&&lh(e,Lo,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;lo(t,e),t=e.pendingProps;var i=Wn(e,Ae.current);Un(e,r),i=Jl(null,e,n,t,i,r);var s=ed();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qe(n)?(s=!0,ko(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ql(e),i.updater=Zo,e.stateNode=i,i._reactInternals=e,Xc(e,n,t,r),e=el(null,e,n,!0,s,r)):(e.tag=0,de&&s&&zl(e),ze(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(lo(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=yv(n),t=mt(n,t),i){case 0:e=Jc(null,e,n,t,r);break e;case 1:e=zu(null,e,n,t,r);break e;case 11:e=Fu(null,e,n,t,r);break e;case 14:e=Bu(null,e,n,mt(n.type,t),r);break e}throw Error(R(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mt(n,i),Jc(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mt(n,i),zu(t,e,n,i,r);case 3:e:{if(Uh(e),t===null)throw Error(R(387));n=e.pendingProps,s=e.memoizedState,i=s.element,mh(t,e),Io(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Yn(Error(R(423)),e),e=Uu(t,e,n,r,i);break e}else if(n!==i){i=Yn(Error(R(424)),e),e=Uu(t,e,n,r,i);break e}else for(Ze=Cr(e.stateNode.containerInfo.firstChild),Je=e,de=!0,vt=null,r=fh(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Qn(),n===i){e=nr(t,e,r);break e}ze(t,e,n,r)}e=e.child}return e;case 5:return gh(e),t===null&&qc(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Vc(n,i)?o=null:s!==null&&Vc(n,s)&&(e.flags|=32),zh(t,e),ze(t,e,o,r),e.child;case 6:return t===null&&qc(e),null;case 13:return Vh(t,e,r);case 4:return Gl(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=qn(e,null,n,r):ze(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mt(n,i),Fu(t,e,n,i,r);case 7:return ze(t,e,e.pendingProps,r),e.child;case 8:return ze(t,e,e.pendingProps.children,r),e.child;case 12:return ze(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,se(Mo,n._currentValue),n._currentValue=o,s!==null)if(St(s.value,o)){if(s.children===i.children&&!Qe.current){e=nr(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Jt(-1,r&-r),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var d=l.pending;d===null?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Gc(s.return,r,e),a.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(R(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),Gc(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ze(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Un(e,r),i=lt(i),n=n(i),e.flags|=1,ze(t,e,n,r),e.child;case 14:return n=e.type,i=mt(n,e.pendingProps),i=mt(n.type,i),Bu(t,e,n,i,r);case 15:return Fh(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mt(n,i),lo(t,e),e.tag=1,qe(n)?(t=!0,ko(e)):t=!1,Un(e,r),jh(e,n,i),Xc(e,n,i,r),el(null,e,n,!0,t,r);case 19:return Hh(t,e,r);case 22:return Bh(t,e,r)}throw Error(R(156,e.tag))};function om(t,e){return Of(t,e)}function vv(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function at(t,e,r,n){return new vv(t,e,r,n)}function dd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function yv(t){if(typeof t=="function")return dd(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kl)return 11;if(t===xl)return 14}return 2}function Pr(t,e){var r=t.alternate;return r===null?(r=at(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function fo(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")dd(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case En:return Wr(r.children,i,s,e);case Pl:o=8,i|=8;break;case Sc:return t=at(12,r,e,i|2),t.elementType=Sc,t.lanes=s,t;case Rc:return t=at(13,r,e,i),t.elementType=Rc,t.lanes=s,t;case bc:return t=at(19,r,e,i),t.elementType=bc,t.lanes=s,t;case gf:return ta(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hf:o=10;break e;case mf:o=9;break e;case kl:o=11;break e;case xl:o=14;break e;case mr:o=16,n=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=at(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Wr(t,e,r,n){return t=at(7,t,n,e),t.lanes=r,t}function ta(t,e,r,n){return t=at(22,t,n,e),t.elementType=gf,t.lanes=r,t.stateNode={isHidden:!1},t}function tc(t,e,r){return t=at(6,t,null,e),t.lanes=r,t}function rc(t,e,r){return e=at(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function wv(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ja(0),this.expirationTimes=ja(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ja(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ud(t,e,r,n,i,s,o,a,c){return t=new wv(t,e,r,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=at(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ql(s),t}function Sv(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dn,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function am(t){if(!t)return Or;t=t._reactInternals;e:{if(Jr(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qe(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var r=t.type;if(qe(r))return ah(t,r,e)}return e}function cm(t,e,r,n,i,s,o,a,c){return t=ud(r,n,!0,t,i,s,o,a,c),t.context=am(null),r=t.current,n=Ue(),i=Er(r),s=Jt(n,i),s.callback=e??null,Tr(r,s,i),t.current.lanes=i,ns(t,i,n),Ge(t,n),t}function ra(t,e,r,n){var i=e.current,s=Ue(),o=Er(i);return r=am(r),e.context===null?e.context=r:e.pendingContext=r,e=Jt(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Tr(i,e,o),t!==null&&(wt(t,i,o,s),oo(t,i,o)),o}function Uo(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Zu(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function pd(t,e){Zu(t,e),(t=t.alternate)&&Zu(t,e)}function Rv(){return null}var lm=typeof reportError=="function"?reportError:function(t){console.error(t)};function fd(t){this._internalRoot=t}na.prototype.render=fd.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));ra(t,e,null,null)};na.prototype.unmount=fd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Xr(function(){ra(null,t,null,null)}),e[tr]=null}};function na(t){this._internalRoot=t}na.prototype.unstable_scheduleHydration=function(t){if(t){var e=Bf();t={blockedOn:null,target:t,priority:e};for(var r=0;r<_r.length&&e!==0&&e<_r[r].priority;r++);_r.splice(r,0,t),r===0&&Uf(t)}};function hd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ia(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ju(){}function bv(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var l=Uo(o);s.call(l)}}var o=cm(e,n,t,0,null,!1,!1,"",Ju);return t._reactRootContainer=o,t[tr]=o.current,Wi(t.nodeType===8?t.parentNode:t),Xr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var l=Uo(c);a.call(l)}}var c=ud(t,0,!1,null,null,!1,!1,"",Ju);return t._reactRootContainer=c,t[tr]=c.current,Wi(t.nodeType===8?t.parentNode:t),Xr(function(){ra(e,c,r,n)}),c}function sa(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=Uo(o);a.call(c)}}ra(e,o,t,i)}else o=bv(r,e,t,i,n);return Uo(o)}Af=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ci(e.pendingLanes);r!==0&&(Ol(e,r|1),Ge(e,ye()),!(q&6)&&(Xn=ye()+500,$r()))}break;case 13:Xr(function(){var n=rr(t,1);if(n!==null){var i=Ue();wt(n,t,1,i)}}),pd(t,1)}};Il=function(t){if(t.tag===13){var e=rr(t,134217728);if(e!==null){var r=Ue();wt(e,t,134217728,r)}pd(t,134217728)}};Ff=function(t){if(t.tag===13){var e=Er(t),r=rr(t,e);if(r!==null){var n=Ue();wt(r,t,e,n)}pd(t,e)}};Bf=function(){return ee};zf=function(t,e){var r=ee;try{return ee=t,e()}finally{ee=r}};Oc=function(t,e,r){switch(e){case"input":if(Dc(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Go(n);if(!i)throw Error(R(90));vf(n),Dc(n,i)}}}break;case"textarea":wf(t,r);break;case"select":e=r.value,e!=null&&An(t,!!r.multiple,e,!1)}};Ef=ad;Pf=Xr;var Cv={usingClientEntryPoint:!1,Events:[ss,Ln,Go,Tf,Df,ad]},gi={findFiberByHostInstance:Ur,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tv={bundleType:gi.bundleType,version:gi.version,rendererPackageName:gi.rendererPackageName,rendererConfig:gi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Lf(t),t===null?null:t.stateNode},findFiberByHostInstance:gi.findFiberByHostInstance||Rv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var As=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!As.isDisabled&&As.supportsFiber)try{Ko=As.inject(Tv),At=As}catch{}}tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cv;tt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hd(e))throw Error(R(200));return Sv(t,e,null,r)};tt.createRoot=function(t,e){if(!hd(t))throw Error(R(299));var r=!1,n="",i=lm;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=ud(t,1,!1,null,null,r,!1,n,i),t[tr]=e.current,Wi(t.nodeType===8?t.parentNode:t),new fd(e)};tt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=Lf(e),t=t===null?null:t.stateNode,t};tt.flushSync=function(t){return Xr(t)};tt.hydrate=function(t,e,r){if(!ia(e))throw Error(R(200));return sa(null,t,e,!0,r)};tt.hydrateRoot=function(t,e,r){if(!hd(t))throw Error(R(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=lm;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=cm(e,null,t,1,r??null,i,!1,s,o),t[tr]=e.current,Wi(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new na(e)};tt.render=function(t,e,r){if(!ia(e))throw Error(R(200));return sa(null,t,e,!1,r)};tt.unmountComponentAtNode=function(t){if(!ia(t))throw Error(R(40));return t._reactRootContainer?(Xr(function(){sa(null,null,t,!1,function(){t._reactRootContainer=null,t[tr]=null})}),!0):!1};tt.unstable_batchedUpdates=ad;tt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ia(r))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return sa(t,e,r,!1,n)};tt.version="18.3.1-next-f1338f8080-20240426";function dm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dm)}catch(t){console.error(t)}}dm(),df.exports=tt;var Dv=df.exports,um,ep=Dv;um=ep.createRoot,ep.hydrateRoot;var pm={},pl={exports:{}},nc,tp;function Ev(){if(tp)return nc;tp=1;var t=1e3,e=t*60,r=e*60,n=r*24,i=n*7,s=n*365.25;nc=function(d,p){p=p||{};var u=typeof d;if(u==="string"&&d.length>0)return o(d);if(u==="number"&&isFinite(d))return p.long?c(d):a(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(p){var u=parseFloat(p[1]),f=(p[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*i;case"days":case"day":case"d":return u*n;case"hours":case"hour":case"hrs":case"hr":case"h":return u*r;case"minutes":case"minute":case"mins":case"min":case"m":return u*e;case"seconds":case"second":case"secs":case"sec":case"s":return u*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}}}function a(d){var p=Math.abs(d);return p>=n?Math.round(d/n)+"d":p>=r?Math.round(d/r)+"h":p>=e?Math.round(d/e)+"m":p>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var p=Math.abs(d);return p>=n?l(d,p,n,"day"):p>=r?l(d,p,r,"hour"):p>=e?l(d,p,e,"minute"):p>=t?l(d,p,t,"second"):d+" ms"}function l(d,p,u,f){var h=p>=u*1.5;return Math.round(d/u)+" "+f+(h?"s":"")}return nc}function Pv(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=Ev(),r.destroy=l,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function e(d){let p=0;for(let u=0;u<d.length;u++)p=(p<<5)-p+d.charCodeAt(u),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=e;function r(d){let p,u=null,f,h;function m(...y){if(!m.enabled)return;const g=m,_=Number(new Date),v=_-(p||_);g.diff=v,g.prev=p,g.curr=_,p=_,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let w=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(C,E)=>{if(C==="%%")return"%";w++;const P=r.formatters[E];if(typeof P=="function"){const Y=y[w];C=P.call(g,Y),y.splice(w,1),w--}return C}),r.formatArgs.call(g,y),(g.log||r.log).apply(g,y)}return m.namespace=d,m.useColors=r.useColors(),m.color=r.selectColor(d),m.extend=n,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>u!==null?u:(f!==r.namespaces&&(f=r.namespaces,h=r.enabled(d)),h),set:y=>{u=y}}),typeof r.init=="function"&&r.init(m),m}function n(d,p){const u=r(this.namespace+(typeof p>"u"?":":p)+d);return u.log=this.log,u}function i(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p;const u=(typeof d=="string"?d:"").split(/[\s,]+/),f=u.length;for(p=0;p<f;p++)u[p]&&(d=u[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function s(){const d=[...r.names.map(a),...r.skips.map(a).map(p=>"-"+p)].join(",");return r.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let p,u;for(p=0,u=r.skips.length;p<u;p++)if(r.skips[p].test(d))return!1;for(p=0,u=r.names.length;p<u;p++)if(r.names[p].test(d))return!0;return!1}function a(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var kv=Pv;(function(t,e){var r={};e.formatArgs=i,e.save=s,e.load=o,e.useColors=n,e.storage=a(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;l.splice(1,0,d,"color: inherit");let p=0,u=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(p++,f==="%c"&&(u=p))}),l.splice(u,0,d)}e.log=console.debug||console.log||(()=>{});function s(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function o(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=r.DEBUG),l}function a(){try{return localStorage}catch{}}t.exports=kv(e);const{formatters:c}=t.exports;c.j=function(l){try{return JSON.stringify(l)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}})(pl,pl.exports);var oa=pl.exports,ti={},fl={exports:{}};(function(t,e){(function(r,n){var i="1.0.39",s="",o="?",a="function",c="undefined",l="object",d="string",p="major",u="model",f="name",h="type",m="vendor",y="version",g="architecture",_="console",v="mobile",w="tablet",b="smarttv",C="wearable",E="embedded",P=500,Y="Amazon",$="Apple",ve="ASUS",Ie="BlackBerry",ut="Browser",Ar="Chrome",Pa="Edge",sr="Firefox",or="Google",T="Huawei",N="LG",F="Microsoft",ce="Motorola",le="Opera",Rt="Samsung",bt="Sharp",ar="Sony",pt="Xiaomi",cr="Zebra",Ad="Facebook",Fd="Chromium OS",Bd="Mac OS",zd=" Browser",Zm=function(H,X){var B={};for(var ie in H)X[ie]&&X[ie].length%2===0?B[ie]=X[ie].concat(H[ie]):B[ie]=H[ie];return B},ys=function(H){for(var X={},B=0;B<H.length;B++)X[H[B].toUpperCase()]=H[B];return X},Ud=function(H,X){return typeof H===d?rn(X).indexOf(rn(H))!==-1:!1},rn=function(H){return H.toLowerCase()},Jm=function(H){return typeof H===d?H.replace(/[^\d\.]/g,s).split(".")[0]:n},ka=function(H,X){if(typeof H===d)return H=H.replace(/^\s\s*/,s),typeof X===c?H:H.substring(0,P)},ci=function(H,X){for(var B=0,ie,Kt,Ct,Z,j,Tt;B<X.length&&!j;){var xa=X[B],Kd=X[B+1];for(ie=Kt=0;ie<xa.length&&!j&&xa[ie];)if(j=xa[ie++].exec(H),j)for(Ct=0;Ct<Kd.length;Ct++)Tt=j[++Kt],Z=Kd[Ct],typeof Z===l&&Z.length>0?Z.length===2?typeof Z[1]==a?this[Z[0]]=Z[1].call(this,Tt):this[Z[0]]=Z[1]:Z.length===3?typeof Z[1]===a&&!(Z[1].exec&&Z[1].test)?this[Z[0]]=Tt?Z[1].call(this,Tt,Z[2]):n:this[Z[0]]=Tt?Tt.replace(Z[1],Z[2]):n:Z.length===4&&(this[Z[0]]=Tt?Z[3].call(this,Tt.replace(Z[1],Z[2])):n):this[Z]=Tt||n;B+=2}},ws=function(H,X){for(var B in X)if(typeof X[B]===l&&X[B].length>0){for(var ie=0;ie<X[B].length;ie++)if(Ud(X[B][ie],H))return B===o?n:B}else if(Ud(X[B],H))return B===o?n:B;return X.hasOwnProperty("*")?X["*"]:H},eg={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Vd={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Hd={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[y,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[y,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,y],[/opios[\/ ]+([\w\.]+)/i],[y,[f,le+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[y,[f,le+" GX"]],[/\bopr\/([\w\.]+)/i],[y,[f,le]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[y,[f,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,y],[/quark(?:pc)?\/([-\w\.]+)/i],[y,[f,"Quark"]],[/\bddg\/([\w\.]+)/i],[y,[f,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[y,[f,"UC"+ut]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[y,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[y,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[y,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[y,[f,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[y,[f,"Smart Lenovo "+ut]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+ut],y],[/\bfocus\/([\w\.]+)/i],[y,[f,sr+" Focus"]],[/\bopt\/([\w\.]+)/i],[y,[f,le+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[y,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[y,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[y,[f,le+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[y,[f,"MIUI "+ut]],[/fxios\/([-\w\.]+)/i],[y,[f,sr]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360"+zd]],[/\b(qq)\/([\w\.]+)/i],[[f,/(.+)/,"$1Browser"],y],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1"+zd],y],[/samsungbrowser\/([\w\.]+)/i],[y,[f,Rt+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],y],[/metasr[\/ ]?([\d\.]+)/i],[y,[f,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[f,"Sogou Mobile"],y],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[f,y],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,Ad],y],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[f,y],[/\bgsa\/([\w\.]+) .*safari\//i],[y,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[y,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[y,[f,Ar+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,Ar+" WebView"],y],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[y,[f,"Android "+ut]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,y],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[y,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[y,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[y,ws,eg]],[/(webkit|khtml)\/([\w\.]+)/i],[f,y],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],y],[/(wolvic)\/([\w\.]+)/i],[f,y],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[y,[f,sr+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[f,[y,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[f,[y,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,rn]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,s,rn]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,rn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[m,Rt],[h,w]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[u,[m,Rt],[h,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[m,$],[h,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[m,$],[h,w]],[/(macintosh);/i],[u,[m,$]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[m,bt],[h,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[m,T],[h,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[m,T],[h,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[u,/_/g," "],[m,pt],[h,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[m,pt],[h,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[m,"OPPO"],[h,v]],[/\b(opd2\d{3}a?) bui/i],[u,[m,"OPPO"],[h,w]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[m,"Vivo"],[h,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[u,[m,"Realme"],[h,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[m,ce],[h,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[m,ce],[h,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[m,N],[h,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[m,N],[h,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[m,"Lenovo"],[h,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[m,"Nokia"],[h,v]],[/(pixel c)\b/i],[u,[m,or],[h,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[m,or],[h,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[m,ar],[h,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[m,ar],[h,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[m,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[m,Y],[h,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[m,Y],[h,v]],[/(playbook);[-\w\),; ]+(rim)/i],[u,m,[h,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[m,Ie],[h,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[m,ve],[h,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[m,ve],[h,v]],[/(nexus 9)/i],[u,[m,"HTC"],[h,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[m,[u,/_/g," "],[h,v]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[u,[m,"TCL"],[h,w]],[/(itel) ((\w+))/i],[[m,rn],u,[h,ws,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[m,"Acer"],[h,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[m,"Meizu"],[h,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[u,[m,"Ulefone"],[h,v]],[/droid.+; (a(?:015|06[35]|142p?))/i],[u,[m,"Nothing"],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,u,[h,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,u,[h,w]],[/(surface duo)/i],[u,[m,F],[h,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[m,"Fairphone"],[h,v]],[/(u304aa)/i],[u,[m,"AT&T"],[h,v]],[/\bsie-(\w*)/i],[u,[m,"Siemens"],[h,v]],[/\b(rct\w+) b/i],[u,[m,"RCA"],[h,w]],[/\b(venue[\d ]{2,7}) b/i],[u,[m,"Dell"],[h,w]],[/\b(q(?:mv|ta)\w+) b/i],[u,[m,"Verizon"],[h,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[m,"Barnes & Noble"],[h,w]],[/\b(tm\d{3}\w+) b/i],[u,[m,"NuVision"],[h,w]],[/\b(k88) b/i],[u,[m,"ZTE"],[h,w]],[/\b(nx\d{3}j) b/i],[u,[m,"ZTE"],[h,v]],[/\b(gen\d{3}) b.+49h/i],[u,[m,"Swiss"],[h,v]],[/\b(zur\d{3}) b/i],[u,[m,"Swiss"],[h,w]],[/\b((zeki)?tb.*\b) b/i],[u,[m,"Zeki"],[h,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],u,[h,w]],[/\b(ns-?\w{0,9}) b/i],[u,[m,"Insignia"],[h,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[m,"NextBook"],[h,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],u,[h,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],u,[h,v]],[/\b(ph-1) /i],[u,[m,"Essential"],[h,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[m,"Envizen"],[h,w]],[/\b(trio[-\w\. ]+) b/i],[u,[m,"MachSpeed"],[h,w]],[/\btu_(1491) b/i],[u,[m,"Rotor"],[h,w]],[/(shield[\w ]+) b/i],[u,[m,"Nvidia"],[h,w]],[/(sprint) (\w+)/i],[m,u,[h,v]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[m,F],[h,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[m,cr],[h,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[m,cr],[h,v]],[/smart-tv.+(samsung)/i],[m,[h,b]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[m,Rt],[h,b]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,N],[h,b]],[/(apple) ?tv/i],[m,[u,$+" TV"],[h,b]],[/crkey/i],[[u,Ar+"cast"],[m,or],[h,b]],[/droid.+aft(\w+)( bui|\))/i],[u,[m,Y],[h,b]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[m,bt],[h,b]],[/(bravia[\w ]+)( bui|\))/i],[u,[m,ar],[h,b]],[/(mitv-\w{5}) bui/i],[u,[m,pt],[h,b]],[/Hbbtv.*(technisat) (.*);/i],[m,u,[h,b]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[m,ka],[u,ka],[h,b]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,b]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,u,[h,_]],[/droid.+; (shield) bui/i],[u,[m,"Nvidia"],[h,_]],[/(playstation [345portablevi]+)/i],[u,[m,ar],[h,_]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[m,F],[h,_]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[u,[m,Rt],[h,C]],[/((pebble))app/i],[m,u,[h,C]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[m,$],[h,C]],[/droid.+; (glass) \d/i],[u,[m,or],[h,C]],[/droid.+; (wt63?0{2,3})\)/i],[u,[m,cr],[h,C]],[/(quest( \d| pro)?)/i],[u,[m,Ad],[h,C]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[h,E]],[/(aeobc)\b/i],[u,[m,Y],[h,E]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[u,[h,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[h,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,w]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,v]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[y,[f,Pa+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[y,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,y],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[y,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,y],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[f,[y,ws,Vd]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[y,ws,Vd],[f,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[y,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,Bd],[y,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[y,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,y],[/\(bb(10);/i],[y,[f,Ie]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[y,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[y,[f,sr+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[y,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[y,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[y,[f,Ar+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,Fd],y],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,y],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],y],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,y]]},ft=function(H,X){if(typeof H===l&&(X=H,H=n),!(this instanceof ft))return new ft(H,X).getResult();var B=typeof r!==c&&r.navigator?r.navigator:n,ie=H||(B&&B.userAgent?B.userAgent:s),Kt=B&&B.userAgentData?B.userAgentData:n,Ct=X?Zm(Hd,X):Hd,Z=B&&B.userAgent==ie;return this.getBrowser=function(){var j={};return j[f]=n,j[y]=n,ci.call(j,ie,Ct.browser),j[p]=Jm(j[y]),Z&&B&&B.brave&&typeof B.brave.isBrave==a&&(j[f]="Brave"),j},this.getCPU=function(){var j={};return j[g]=n,ci.call(j,ie,Ct.cpu),j},this.getDevice=function(){var j={};return j[m]=n,j[u]=n,j[h]=n,ci.call(j,ie,Ct.device),Z&&!j[h]&&Kt&&Kt.mobile&&(j[h]=v),Z&&j[u]=="Macintosh"&&B&&typeof B.standalone!==c&&B.maxTouchPoints&&B.maxTouchPoints>2&&(j[u]="iPad",j[h]=w),j},this.getEngine=function(){var j={};return j[f]=n,j[y]=n,ci.call(j,ie,Ct.engine),j},this.getOS=function(){var j={};return j[f]=n,j[y]=n,ci.call(j,ie,Ct.os),Z&&!j[f]&&Kt&&Kt.platform&&Kt.platform!="Unknown"&&(j[f]=Kt.platform.replace(/chrome os/i,Fd).replace(/macos/i,Bd)),j},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ie},this.setUA=function(j){return ie=typeof j===d&&j.length>P?ka(j,P):j,this},this.setUA(ie),this};ft.VERSION=i,ft.BROWSER=ys([f,y,p]),ft.CPU=ys([g]),ft.DEVICE=ys([u,m,h,_,v,b,w,C,E]),ft.ENGINE=ft.OS=ys([f,y]),t.exports&&(e=t.exports=ft),e.UAParser=ft;var nn=typeof r!==c&&(r.jQuery||r.Zepto);if(nn&&!nn.ua){var Ss=new ft;nn.ua=Ss.getResult(),nn.ua.get=function(){return Ss.getUA()},nn.ua.set=function(H){Ss.setUA(H);var X=Ss.getResult();for(var B in X)nn.ua[B]=X[B]}}})(typeof window=="object"?window:S)})(fl,fl.exports);var xv=fl.exports,he={},Lv=S&&S.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(he,"__esModule",{value:!0});he.Logger=void 0;const on=Lv(oa),an="mediasoup-client";let Mv=class{constructor(e){e?(this._debug=(0,on.default)(`${an}:${e}`),this._warn=(0,on.default)(`${an}:WARN:${e}`),this._error=(0,on.default)(`${an}:ERROR:${e}`)):(this._debug=(0,on.default)(an),this._warn=(0,on.default)(`${an}:WARN`),this._error=(0,on.default)(`${an}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};he.Logger=Mv;var Ut={},md={exports:{}},Hn=typeof Reflect=="object"?Reflect:null,rp=Hn&&typeof Hn.apply=="function"?Hn.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},ho;Hn&&typeof Hn.ownKeys=="function"?ho=Hn.ownKeys:Object.getOwnPropertySymbols?ho=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ho=function(e){return Object.getOwnPropertyNames(e)};function Ov(t){console&&console.warn&&console.warn(t)}var fm=Number.isNaN||function(e){return e!==e};function te(){te.init.call(this)}md.exports=te;md.exports.once=$v;te.EventEmitter=te;te.prototype._events=void 0;te.prototype._eventsCount=0;te.prototype._maxListeners=void 0;var np=10;function aa(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(te,"defaultMaxListeners",{enumerable:!0,get:function(){return np},set:function(t){if(typeof t!="number"||t<0||fm(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");np=t}});te.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};te.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||fm(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function hm(t){return t._maxListeners===void 0?te.defaultMaxListeners:t._maxListeners}te.prototype.getMaxListeners=function(){return hm(this)};te.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")rp(c,this,r);else for(var l=c.length,d=ym(c,l),n=0;n<l;++n)rp(d[n],this,r);return!0};function mm(t,e,r,n){var i,s,o;if(aa(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=hm(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Ov(a)}return t}te.prototype.addListener=function(e,r){return mm(this,e,r,!1)};te.prototype.on=te.prototype.addListener;te.prototype.prependListener=function(e,r){return mm(this,e,r,!0)};function Iv(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gm(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Iv.bind(n);return i.listener=r,n.wrapFn=i,i}te.prototype.once=function(e,r){return aa(r),this.on(e,gm(this,e,r)),this};te.prototype.prependOnceListener=function(e,r){return aa(r),this.prependListener(e,gm(this,e,r)),this};te.prototype.removeListener=function(e,r){var n,i,s,o,a;if(aa(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Nv(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};te.prototype.off=te.prototype.removeListener;te.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function _m(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?jv(i):ym(i,i.length)}te.prototype.listeners=function(e){return _m(this,e,!0)};te.prototype.rawListeners=function(e){return _m(this,e,!1)};te.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):vm.call(t,e)};te.prototype.listenerCount=vm;function vm(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}te.prototype.eventNames=function(){return this._eventsCount>0?ho(this._events):[]};function ym(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Nv(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function jv(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function $v(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}wm(t,e,s,{once:!0}),e!=="error"&&Av(t,i,{once:!0})})}function Av(t,e,r){typeof t.on=="function"&&wm(t,"error",e,r)}function wm(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Fv=md.exports;Object.defineProperty(Ut,"__esModule",{value:!0});Ut.EnhancedEventEmitter=void 0;const Bv=Fv,zv=he,Uv=new zv.Logger("EnhancedEventEmitter");class Vv extends Bv.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(e,...r){return super.emit(e,...r)}safeEmit(e,...r){try{return super.emit(e,...r)}catch(n){Uv.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,n);try{super.emit("listenererror",e,n)}catch{}return!!super.listenerCount(e)}}on(e,r){return super.on(e,r),this}off(e,r){return super.off(e,r),this}addListener(e,r){return super.on(e,r),this}prependListener(e,r){return super.prependListener(e,r),this}once(e,r){return super.once(e,r),this}prependOnceListener(e,r){return super.prependOnceListener(e,r),this}removeListener(e,r){return super.off(e,r),this}removeAllListeners(e){return super.removeAllListeners(e),this}listenerCount(e){return super.listenerCount(e)}listeners(e){return super.listeners(e)}rawListeners(e){return super.rawListeners(e)}}Ut.EnhancedEventEmitter=Vv;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.InvalidStateError=Ce.UnsupportedError=void 0;class gd extends Error{constructor(e){super(e),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,gd):this.stack=new Error(e).stack}}Ce.UnsupportedError=gd;class _d extends Error{constructor(e){super(e),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,_d):this.stack=new Error(e).stack}}Ce.InvalidStateError=_d;var we={};Object.defineProperty(we,"__esModule",{value:!0});we.clone=Hv;we.generateRandomNumber=Kv;we.deepFreeze=Sm;function Hv(t){if(t!==void 0)return Number.isNaN(t)?NaN:typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}function Kv(){return Math.round(Math.random()*1e7)}function Sm(t){const e=Reflect.ownKeys(t);for(const r of e){const n=t[r];(n&&typeof n=="object"||typeof n=="function")&&Sm(n)}return Object.freeze(t)}var ne={},me={},ca={},Wv=S&&S.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ca,"__esModule",{value:!0});ca.Logger=void 0;const cn=Wv(oa),ln="h264-profile-level-id";let Qv=class{constructor(e){e?(this._debug=(0,cn.default)(`${ln}:${e}`),this._warn=(0,cn.default)(`${ln}:WARN:${e}`),this._error=(0,cn.default)(`${ln}:ERROR:${e}`)):(this._debug=(0,cn.default)(ln),this._warn=(0,cn.default)(`${ln}:WARN`),this._error=(0,cn.default)(`${ln}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};ca.Logger=Qv;Object.defineProperty(me,"__esModule",{value:!0});me.generateProfileLevelIdStringForAnswer=me.isSameProfile=me.parseSdpProfileLevelId=me.levelToString=me.profileToString=me.profileLevelIdToString=me.parseProfileLevelId=me.ProfileLevelId=me.Level=me.Profile=void 0;const qv=ca,Ir=new qv.Logger;var re;(function(t){t[t.ConstrainedBaseline=1]="ConstrainedBaseline",t[t.Baseline=2]="Baseline",t[t.Main=3]="Main",t[t.ConstrainedHigh=4]="ConstrainedHigh",t[t.High=5]="High",t[t.PredictiveHigh444=6]="PredictiveHigh444"})(re||(me.Profile=re={}));var A;(function(t){t[t.L1_b=0]="L1_b",t[t.L1=10]="L1",t[t.L1_1=11]="L1_1",t[t.L1_2=12]="L1_2",t[t.L1_3=13]="L1_3",t[t.L2=20]="L2",t[t.L2_1=21]="L2_1",t[t.L2_2=22]="L2_2",t[t.L3=30]="L3",t[t.L3_1=31]="L3_1",t[t.L3_2=32]="L3_2",t[t.L4=40]="L4",t[t.L4_1=41]="L4_1",t[t.L4_2=42]="L4_2",t[t.L5=50]="L5",t[t.L5_1=51]="L5_1",t[t.L5_2=52]="L5_2"})(A||(me.Level=A={}));class la{constructor(e,r){this.profile=e,this.level=r}}me.ProfileLevelId=la;const Gv=new la(re.ConstrainedBaseline,A.L3_1);class Wt{constructor(e){this.mask=~ip("x",e),this.masked_value=ip("1",e)}isMatch(e){return this.masked_value===(e&this.mask)}}class Qt{constructor(e,r,n){this.profile_idc=e,this.profile_iop=r,this.profile=n}}const Yv=[new Qt(66,new Wt("x1xx0000"),re.ConstrainedBaseline),new Qt(77,new Wt("1xxx0000"),re.ConstrainedBaseline),new Qt(88,new Wt("11xx0000"),re.ConstrainedBaseline),new Qt(66,new Wt("x0xx0000"),re.Baseline),new Qt(88,new Wt("10xx0000"),re.Baseline),new Qt(77,new Wt("0x0x0000"),re.Main),new Qt(100,new Wt("00000000"),re.High),new Qt(100,new Wt("00001100"),re.ConstrainedHigh),new Qt(244,new Wt("00000000"),re.PredictiveHigh444)];function Rm(t){if(typeof t!="string"||t.length!==6)return;const r=parseInt(t,16);if(r===0)return;const n=r&255,i=r>>8&255,s=r>>16&255;let o;switch(n){case A.L1_1:{o=i&16?A.L1_b:A.L1_1;break}case A.L1:case A.L1_2:case A.L1_3:case A.L2:case A.L2_1:case A.L2_2:case A.L3:case A.L3_1:case A.L3_2:case A.L4:case A.L4_1:case A.L4_2:case A.L5:case A.L5_1:case A.L5_2:{o=n;break}default:{Ir.warn(`parseProfileLevelId() | unrecognized level_idc [str:${t}, level_idc:${n}]`);return}}for(const a of Yv)if(s===a.profile_idc&&a.profile_iop.isMatch(i))return new la(a.profile,o);Ir.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${t}, profile_idc:${s}, profile_iop:${i}]`)}me.parseProfileLevelId=Rm;function bm(t){if(t.level==A.L1_b)switch(t.profile){case re.ConstrainedBaseline:return"42f00b";case re.Baseline:return"42100b";case re.Main:return"4d100b";default:{Ir.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${t.profile}`);return}}let e;switch(t.profile){case re.ConstrainedBaseline:{e="42e0";break}case re.Baseline:{e="4200";break}case re.Main:{e="4d00";break}case re.ConstrainedHigh:{e="640c";break}case re.High:{e="6400";break}case re.PredictiveHigh444:{e="f400";break}default:{Ir.warn(`profileLevelIdToString() | unrecognized profile ${t.profile}`);return}}let r=t.level.toString(16);return r.length===1&&(r=`0${r}`),`${e}${r}`}me.profileLevelIdToString=bm;function Xv(t){switch(t){case re.ConstrainedBaseline:return"ConstrainedBaseline";case re.Baseline:return"Baseline";case re.Main:return"Main";case re.ConstrainedHigh:return"ConstrainedHigh";case re.High:return"High";case re.PredictiveHigh444:return"PredictiveHigh444";default:{Ir.warn(`profileToString() | unrecognized profile ${t}`);return}}}me.profileToString=Xv;function Zv(t){switch(t){case A.L1_b:return"1b";case A.L1:return"1";case A.L1_1:return"1.1";case A.L1_2:return"1.2";case A.L1_3:return"1.3";case A.L2:return"2";case A.L2_1:return"2.1";case A.L2_2:return"2.2";case A.L3:return"3";case A.L3_1:return"3.1";case A.L3_2:return"3.2";case A.L4:return"4";case A.L4_1:return"4.1";case A.L4_2:return"4.2";case A.L5:return"5";case A.L5_1:return"5.1";case A.L5_2:return"5.2";default:{Ir.warn(`levelToString() | unrecognized level ${t}`);return}}}me.levelToString=Zv;function ts(t={}){const e=t["profile-level-id"];return e?Rm(e):Gv}me.parseSdpProfileLevelId=ts;function Jv(t={},e={}){const r=ts(t),n=ts(e);return!!(r&&n&&r.profile===n.profile)}me.isSameProfile=Jv;function ey(t={},e={}){if(!t["profile-level-id"]&&!e["profile-level-id"]){Ir.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const r=ts(t),n=ts(e);if(!r)throw new TypeError("invalid local_profile_level_id");if(!n)throw new TypeError("invalid remote_profile_level_id");if(r.profile!==n.profile)throw new TypeError("H264 Profile mismatch");const i=sp(t)&&sp(e),s=r.level,o=n.level,a=ry(s,o),c=i?s:a;return Ir.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${r.profile}, level:${c}]`),bm(new la(r.profile,c))}me.generateProfileLevelIdStringForAnswer=ey;function ip(t,e){return+(e[0]===t)<<7|+(e[1]===t)<<6|+(e[2]===t)<<5|+(e[3]===t)<<4|+(e[4]===t)<<3|+(e[5]===t)<<2|+(e[6]===t)<<1|+(e[7]===t)<<0}function ty(t,e){return t===A.L1_b?e!==A.L1&&e!==A.L1_b:e===A.L1_b?t!==A.L1:t<e}function ry(t,e){return ty(t,e)?t:e}function sp(t={}){const e=t["level-asymmetry-allowed"];return e===!0||e===1||e==="1"}var ny=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),iy=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Cm=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ny(e,t,r);return iy(e,t),e};Object.defineProperty(ne,"__esModule",{value:!0});ne.validateRtpCapabilities=ly;ne.validateRtpParameters=vd;ne.validateSctpStreamParameters=dy;ne.validateSctpCapabilities=uy;ne.getExtendedRtpCapabilities=py;ne.getRecvRtpCapabilities=fy;ne.getSendingRtpParameters=hy;ne.getSendingRemoteRtpParameters=my;ne.reduceCodecs=gy;ne.generateProbatorRtpParameters=_y;ne.canSend=vy;ne.canReceive=yy;const op=Cm(me),sy=Cm(we),oy="probator",ay=1234,cy=127;function ly(t){if(typeof t!="object")throw new TypeError("caps is not an object");if(t.codecs&&!Array.isArray(t.codecs))throw new TypeError("caps.codecs is not an array");t.codecs||(t.codecs=[]);for(const e of t.codecs)wy(e);if(t.headerExtensions&&!Array.isArray(t.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");t.headerExtensions||(t.headerExtensions=[]);for(const e of t.headerExtensions)Sy(e)}function vd(t){if(typeof t!="object")throw new TypeError("params is not an object");if(t.mid&&typeof t.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(t.codecs))throw new TypeError("missing params.codecs");for(const e of t.codecs)Ry(e);if(t.headerExtensions&&!Array.isArray(t.headerExtensions))throw new TypeError("params.headerExtensions is not an array");t.headerExtensions||(t.headerExtensions=[]);for(const e of t.headerExtensions)by(e);if(t.encodings&&!Array.isArray(t.encodings))throw new TypeError("params.encodings is not an array");t.encodings||(t.encodings=[]);for(const e of t.encodings)Cy(e);if(t.rtcp&&typeof t.rtcp!="object")throw new TypeError("params.rtcp is not an object");t.rtcp||(t.rtcp={}),Ty(t.rtcp)}function dy(t){if(typeof t!="object")throw new TypeError("params is not an object");if(typeof t.streamId!="number")throw new TypeError("missing params.streamId");let e=!1;if(typeof t.ordered=="boolean"?e=!0:t.ordered=!0,t.maxPacketLifeTime&&typeof t.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(t.maxRetransmits&&typeof t.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(t.maxPacketLifeTime&&t.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(e&&t.ordered&&(t.maxPacketLifeTime||t.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!e&&(t.maxPacketLifeTime||t.maxRetransmits)&&(t.ordered=!1),t.label&&typeof t.label!="string")throw new TypeError("invalid params.label");if(t.protocol&&typeof t.protocol!="string")throw new TypeError("invalid params.protocol")}function uy(t){if(typeof t!="object")throw new TypeError("caps is not an object");if(!t.numStreams||typeof t.numStreams!="object")throw new TypeError("missing caps.numStreams");Dy(t.numStreams)}function py(t,e){const r={codecs:[],headerExtensions:[]};for(const n of e.codecs??[]){if($i(n))continue;const i=(t.codecs??[]).find(o=>Dm(o,n,{strict:!0,modify:!0}));if(!i)continue;const s={mimeType:i.mimeType,kind:i.kind,clockRate:i.clockRate,channels:i.channels,localPayloadType:i.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:n.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:i.parameters,remoteParameters:n.parameters,rtcpFeedback:Py(i,n)};r.codecs.push(s)}for(const n of r.codecs){const i=t.codecs.find(o=>$i(o)&&o.parameters.apt===n.localPayloadType),s=e.codecs.find(o=>$i(o)&&o.parameters.apt===n.remotePayloadType);i&&s&&(n.localRtxPayloadType=i.preferredPayloadType,n.remoteRtxPayloadType=s.preferredPayloadType)}for(const n of e.headerExtensions){const i=t.headerExtensions.find(o=>Ey(o,n));if(!i)continue;const s={kind:n.kind,uri:n.uri,sendId:i.preferredId,recvId:n.preferredId,encrypt:i.preferredEncrypt,direction:"sendrecv"};switch(n.direction){case"sendrecv":{s.direction="sendrecv";break}case"recvonly":{s.direction="sendonly";break}case"sendonly":{s.direction="recvonly";break}case"inactive":{s.direction="inactive";break}}r.headerExtensions.push(s)}return r}function fy(t){const e={codecs:[],headerExtensions:[]};for(const r of t.codecs){const n={mimeType:r.mimeType,kind:r.kind,preferredPayloadType:r.remotePayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(e.codecs.push(n),!r.remoteRtxPayloadType)continue;const i={mimeType:`${r.kind}/rtx`,kind:r.kind,preferredPayloadType:r.remoteRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.remotePayloadType},rtcpFeedback:[]};e.codecs.push(i)}for(const r of t.headerExtensions){if(r.direction!=="sendrecv"&&r.direction!=="recvonly")continue;const n={kind:r.kind,uri:r.uri,preferredId:r.recvId,preferredEncrypt:r.encrypt,direction:r.direction};e.headerExtensions.push(n)}return e}function hy(t,e){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of e.codecs){if(n.kind!==t)continue;const i={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.localParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(i),n.localRtxPayloadType){const s={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}for(const n of e.headerExtensions){if(n.kind&&n.kind!==t||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const i={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(i)}return r}function my(t,e){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of e.codecs){if(n.kind!==t)continue;const i={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.remoteParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(i),n.localRtxPayloadType){const s={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}for(const n of e.headerExtensions){if(n.kind&&n.kind!==t||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const i={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(i)}if(r.headerExtensions.some(n=>n.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(i=>i.type!=="goog-remb");else if(r.headerExtensions.some(n=>n.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(i=>i.type!=="transport-cc");else for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(i=>i.type!=="transport-cc"&&i.type!=="goog-remb");return r}function gy(t,e){const r=[];if(!e)r.push(t[0]),$i(t[1])&&r.push(t[1]);else{for(let n=0;n<t.length;++n)if(Dm(t[n],e,{strict:!0})){r.push(t[n]),$i(t[n+1])&&r.push(t[n+1]);break}if(r.length===0)throw new TypeError("no matching codec found")}return r}function _y(t){t=sy.clone(t),vd(t);const e={mid:oy,codecs:[],headerExtensions:[],encodings:[{ssrc:ay}],rtcp:{cname:"probator"}};return e.codecs.push(t.codecs[0]),e.codecs[0].payloadType=cy,e.headerExtensions=t.headerExtensions,e}function vy(t,e){return e.codecs.some(r=>r.kind===t)}function yy(t,e){if(vd(t),t.codecs.length===0)return!1;const r=t.codecs[0];return e.codecs.some(n=>n.remotePayloadType===r.payloadType)}function wy(t){const e=new RegExp("^(audio|video)/(.+)","i");if(typeof t!="object")throw new TypeError("codec is not an object");if(!t.mimeType||typeof t.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=e.exec(t.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(t.kind=r[1].toLowerCase(),t.preferredPayloadType&&typeof t.preferredPayloadType!="number")throw new TypeError("invalid codec.preferredPayloadType");if(typeof t.clockRate!="number")throw new TypeError("missing codec.clockRate");t.kind==="audio"?typeof t.channels!="number"&&(t.channels=1):delete t.channels,(!t.parameters||typeof t.parameters!="object")&&(t.parameters={});for(const n of Object.keys(t.parameters)){let i=t.parameters[n];if(i===void 0&&(t.parameters[n]="",i=""),typeof i!="string"&&typeof i!="number")throw new TypeError(`invalid codec parameter [key:${n}s, value:${i}]`);if(n==="apt"&&typeof i!="number")throw new TypeError("invalid codec apt parameter")}(!t.rtcpFeedback||!Array.isArray(t.rtcpFeedback))&&(t.rtcpFeedback=[]);for(const n of t.rtcpFeedback)Tm(n)}function Tm(t){if(typeof t!="object")throw new TypeError("fb is not an object");if(!t.type||typeof t.type!="string")throw new TypeError("missing fb.type");(!t.parameter||typeof t.parameter!="string")&&(t.parameter="")}function Sy(t){if(typeof t!="object")throw new TypeError("ext is not an object");if(t.kind!=="audio"&&t.kind!=="video")throw new TypeError("invalid ext.kind");if(!t.uri||typeof t.uri!="string")throw new TypeError("missing ext.uri");if(typeof t.preferredId!="number")throw new TypeError("missing ext.preferredId");if(t.preferredEncrypt&&typeof t.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(t.preferredEncrypt||(t.preferredEncrypt=!1),t.direction&&typeof t.direction!="string")throw new TypeError("invalid ext.direction");t.direction||(t.direction="sendrecv")}function Ry(t){const e=new RegExp("^(audio|video)/(.+)","i");if(typeof t!="object")throw new TypeError("codec is not an object");if(!t.mimeType||typeof t.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=e.exec(t.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(typeof t.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof t.clockRate!="number")throw new TypeError("missing codec.clockRate");r[1].toLowerCase()==="audio"?typeof t.channels!="number"&&(t.channels=1):delete t.channels,(!t.parameters||typeof t.parameters!="object")&&(t.parameters={});for(const i of Object.keys(t.parameters)){let s=t.parameters[i];if(s===void 0&&(t.parameters[i]="",s=""),typeof s!="string"&&typeof s!="number")throw new TypeError(`invalid codec parameter [key:${i}s, value:${s}]`);if(i==="apt"&&typeof s!="number")throw new TypeError("invalid codec apt parameter")}(!t.rtcpFeedback||!Array.isArray(t.rtcpFeedback))&&(t.rtcpFeedback=[]);for(const i of t.rtcpFeedback)Tm(i)}function by(t){if(typeof t!="object")throw new TypeError("ext is not an object");if(!t.uri||typeof t.uri!="string")throw new TypeError("missing ext.uri");if(typeof t.id!="number")throw new TypeError("missing ext.id");if(t.encrypt&&typeof t.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");t.encrypt||(t.encrypt=!1),(!t.parameters||typeof t.parameters!="object")&&(t.parameters={});for(const e of Object.keys(t.parameters)){let r=t.parameters[e];if(r===void 0&&(t.parameters[e]="",r=""),typeof r!="string"&&typeof r!="number")throw new TypeError("invalid header extension parameter")}}function Cy(t){if(typeof t!="object")throw new TypeError("encoding is not an object");if(t.ssrc&&typeof t.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(t.rid&&typeof t.rid!="string")throw new TypeError("invalid encoding.rid");if(t.rtx&&typeof t.rtx!="object")throw new TypeError("invalid encoding.rtx");if(t.rtx&&typeof t.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!t.dtx||typeof t.dtx!="boolean")&&(t.dtx=!1),t.scalabilityMode&&typeof t.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function Ty(t){if(typeof t!="object")throw new TypeError("rtcp is not an object");if(t.cname&&typeof t.cname!="string")throw new TypeError("invalid rtcp.cname");(!t.reducedSize||typeof t.reducedSize!="boolean")&&(t.reducedSize=!0)}function Dy(t){if(typeof t!="object")throw new TypeError("numStreams is not an object");if(typeof t.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof t.MIS!="number")throw new TypeError("missing numStreams.MIS")}function $i(t){return t?/.+\/rtx$/i.test(t.mimeType):!1}function Dm(t,e,{strict:r=!1,modify:n=!1}={}){const i=t.mimeType.toLowerCase(),s=e.mimeType.toLowerCase();if(i!==s||t.clockRate!==e.clockRate||t.channels!==e.channels)return!1;switch(i){case"video/h264":{if(r){const o=t.parameters["packetization-mode"]||0,a=e.parameters["packetization-mode"]||0;if(o!==a||!op.isSameProfile(t.parameters,e.parameters))return!1;let c;try{c=op.generateProfileLevelIdStringForAnswer(t.parameters,e.parameters)}catch{return!1}n&&(c?(t.parameters["profile-level-id"]=c,e.parameters["profile-level-id"]=c):(delete t.parameters["profile-level-id"],delete e.parameters["profile-level-id"]))}break}case"video/vp9":{if(r){const o=t.parameters["profile-id"]||0,a=e.parameters["profile-id"]||0;if(o!==a)return!1}break}}return!0}function Ey(t,e){return!(t.kind&&e.kind&&t.kind!==e.kind||t.uri!==e.uri)}function Py(t,e){const r=[];for(const n of t.rtcpFeedback??[]){const i=(e.rtcpFeedback??[]).find(s=>s.type===n.type&&(s.parameter===n.parameter||!s.parameter&&!n.parameter));i&&r.push(i)}return r}var as={},kr={},da={};Object.defineProperty(da,"__esModule",{value:!0});da.Logger=void 0;const dn=oa,un="awaitqueue";class ky{constructor(e){e?(this._debug=(0,dn.default)(`${un}:${e}`),this._warn=(0,dn.default)(`${un}:WARN:${e}`),this._error=(0,dn.default)(`${un}:ERROR:${e}`)):(this._debug=(0,dn.default)(un),this._warn=(0,dn.default)(`${un}:WARN`),this._error=(0,dn.default)(`${un}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}da.Logger=ky;Object.defineProperty(kr,"__esModule",{value:!0});kr.AwaitQueue=kr.AwaitQueueRemovedTaskError=kr.AwaitQueueStoppedError=void 0;const xy=da,dr=new xy.Logger;class ua extends Error{constructor(e){super(e??"AwaitQueue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ua)}}kr.AwaitQueueStoppedError=ua;class pa extends Error{constructor(e){super(e??"AwaitQueue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,pa)}}kr.AwaitQueueRemovedTaskError=pa;class Ly{constructor(){this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}get size(){return this.pendingTasks.size}async push(e,r){if(r=r??e.name,dr.debug(`push() [name:${r}]`),typeof e!="function")throw new TypeError("given task is not a function");if(r)try{Object.defineProperty(e,"name",{value:r})}catch{}return new Promise((n,i)=>{const s={id:this.nextTaskId++,task:e,name:r,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:o=>{if(s.completed)return;s.completed=!0,this.pendingTasks.delete(s.id),dr.debug(`resolving task [name:${s.name}]`),n(o);const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)},reject:o=>{if(!s.completed&&(s.completed=!0,this.pendingTasks.delete(s.id),dr.debug(`rejecting task [name:${s.name}]: %s`,String(o)),i(o),!this.stopping)){const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)}}};this.pendingTasks.set(s.id,s),this.pendingTasks.size===1&&this.execute(s)})}stop(){dr.debug("stop()"),this.stopping=!0;for(const e of this.pendingTasks.values())dr.debug(`stop() | stopping task [name:${e.name}]`),e.reject(new ua);this.stopping=!1}remove(e){dr.debug(`remove() [taskIdx:${e}]`);const r=Array.from(this.pendingTasks.values())[e];if(!r){dr.debug(`stop() | no task with given idx [taskIdx:${e}]`);return}r.reject(new pa)}dump(){const e=Date.now();let r=0;return Array.from(this.pendingTasks.values()).map(n=>({idx:r++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt-n.enqueuedAt:e-n.enqueuedAt,executionTime:n.executedAt?e-n.executedAt:0}))}async execute(e){if(dr.debug(`execute() [name:${e.name}]`),e.executedAt)throw new Error("task already being executed");e.executedAt=Date.now();try{const r=await e.task();e.resolve(r)}catch(r){e.reject(r)}}}kr.AwaitQueue=Ly;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let ap;var My=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:S):t=>(ap||(ap=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0)),cs={};Object.defineProperty(cs,"__esModule",{value:!0});cs.Producer=void 0;const Oy=he,cp=Ut,pn=Ce,Et=new Oy.Logger("Producer");class Iy extends cp.EnhancedEventEmitter{constructor({id:e,localId:r,rtpSender:n,track:i,rtpParameters:s,stopTracks:o,disableTrackOnPause:a,zeroRtpOnPause:c,appData:l}){super(),this._closed=!1,this._observer=new cp.EnhancedEventEmitter,Et.debug("constructor()"),this._id=e,this._localId=r,this._rtpSender=n,this._track=i,this._kind=i.kind,this._rtpParameters=s,this._paused=a?!i.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=o,this._disableTrackOnPause=a,this._zeroRtpOnPause=c,this._appData=l??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(Et.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Et.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new pn.InvalidStateError("closed");return new Promise((e,r)=>{this.safeEmit("@getstats",e,r)})}pause(){if(Et.debug("pause()"),this._closed){Et.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((e,r)=>{this.safeEmit("@pause",e,r)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(Et.debug("resume()"),this._closed){Et.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((e,r)=>{this.safeEmit("@resume",e,r)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:e}){if(Et.debug("replaceTrack() [track:%o]",e),this._closed){if(e&&this._stopTracks)try{e.stop()}catch{}throw new pn.InvalidStateError("closed")}else if(e&&e.readyState==="ended")throw new pn.InvalidStateError("track ended");if(e===this._track){Et.debug("replaceTrack() | same track, ignored");return}await new Promise((r,n)=>{this.safeEmit("@replacetrack",e,r,n)}),this.destroyTrack(),this._track=e,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(e){if(this._closed)throw new pn.InvalidStateError("closed");if(this._kind!=="video")throw new pn.UnsupportedError("not a video Producer");if(typeof e!="number")throw new TypeError("invalid spatialLayer");e!==this._maxSpatialLayer&&(await new Promise((r,n)=>{this.safeEmit("@setmaxspatiallayer",e,r,n)}).catch(()=>{}),this._maxSpatialLayer=e)}async setRtpEncodingParameters(e){if(this._closed)throw new pn.InvalidStateError("closed");if(typeof e!="object")throw new TypeError("invalid params");await new Promise((r,n)=>{this.safeEmit("@setrtpencodingparameters",e,r,n)})}onTrackEnded(){Et.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}}cs.Producer=Iy;var ls={};Object.defineProperty(ls,"__esModule",{value:!0});ls.Consumer=void 0;const Ny=he,lp=Ut,jy=Ce,Pt=new Ny.Logger("Consumer");class $y extends lp.EnhancedEventEmitter{constructor({id:e,localId:r,producerId:n,rtpReceiver:i,track:s,rtpParameters:o,appData:a}){super(),this._closed=!1,this._observer=new lp.EnhancedEventEmitter,Pt.debug("constructor()"),this._id=e,this._localId=r,this._producerId=n,this._rtpReceiver=i,this._track=s,this._rtpParameters=o,this._paused=!s.enabled,this._appData=a??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(Pt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Pt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new jy.InvalidStateError("closed");return new Promise((e,r)=>{this.safeEmit("@getstats",e,r)})}pause(){if(Pt.debug("pause()"),this._closed){Pt.error("pause() | Consumer closed");return}if(this._paused){Pt.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(Pt.debug("resume()"),this._closed){Pt.error("resume() | Consumer closed");return}if(!this._paused){Pt.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){Pt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}}ls.Consumer=$y;var ds={};Object.defineProperty(ds,"__esModule",{value:!0});ds.DataProducer=void 0;const Ay=he,dp=Ut,Fy=Ce,qt=new Ay.Logger("DataProducer");class By extends dp.EnhancedEventEmitter{constructor({id:e,dataChannel:r,sctpStreamParameters:n,appData:i}){super(),this._closed=!1,this._observer=new dp.EnhancedEventEmitter,qt.debug("constructor()"),this._id=e,this._dataChannel=r,this._sctpStreamParameters=n,this._appData=i??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(e){this._dataChannel.bufferedAmountLowThreshold=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(qt.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(qt.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(e){if(qt.debug("send()"),this._closed)throw new Fy.InvalidStateError("closed");this._dataChannel.send(e)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(qt.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:r}=e;r||(r=new Error("unknown DataChannel error")),r.errorDetail==="sctp-failure"?qt.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):qt.error('DataChannel "error" event: %o',r),this.safeEmit("error",r)}),this._dataChannel.addEventListener("close",()=>{this._closed||(qt.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||qt.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}}ds.DataProducer=By;var us={};Object.defineProperty(us,"__esModule",{value:!0});us.DataConsumer=void 0;const zy=he,up=Ut,Fr=new zy.Logger("DataConsumer");class Uy extends up.EnhancedEventEmitter{constructor({id:e,dataProducerId:r,dataChannel:n,sctpStreamParameters:i,appData:s}){super(),this._closed=!1,this._observer=new up.EnhancedEventEmitter,Fr.debug("constructor()"),this._id=e,this._dataProducerId=r,this._dataChannel=n,this._sctpStreamParameters=i,this._appData=s??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(e){this._dataChannel.binaryType=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(Fr.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Fr.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(Fr.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:r}=e;r||(r=new Error("unknown DataChannel error")),r.errorDetail==="sctp-failure"?Fr.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):Fr.error('DataChannel "error" event: %o',r),this.safeEmit("error",r)}),this._dataChannel.addEventListener("close",()=>{this._closed||(Fr.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",e=>{this._closed||this.safeEmit("message",e.data)})}}us.DataConsumer=Uy;var Vy=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Hy=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Em=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vy(e,t,r);return Hy(e,t),e},Ky=S&&S.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(as,"__esModule",{value:!0});as.Transport=void 0;const Wy=kr,ic=Ky(My),Qy=he,pp=Ut,Te=Ce,sc=Em(we),_i=Em(ne),qy=cs,Gy=ls,Yy=ds,Xy=us,Se=new Qy.Logger("Transport");class Zy{constructor(e){this.consumerOptions=e,this.promise=new Promise((r,n)=>{this.resolve=r,this.reject=n})}}let Jy=class extends pp.EnhancedEventEmitter{constructor({direction:e,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:d,appData:p,handlerFactory:u,extendedRtpCapabilities:f,canProduceByKind:h}){super(),this._closed=!1,this._iceGatheringState="new",this._connectionState="new",this._producers=new Map,this._consumers=new Map,this._dataProducers=new Map,this._dataConsumers=new Map,this._probatorConsumerCreated=!1,this._awaitQueue=new Wy.AwaitQueue,this._pendingConsumerTasks=[],this._consumerCreationInProgress=!1,this._pendingPauseConsumers=new Map,this._consumerPauseInProgress=!1,this._pendingResumeConsumers=new Map,this._consumerResumeInProgress=!1,this._pendingCloseConsumers=new Map,this._consumerCloseInProgress=!1,this._observer=new pp.EnhancedEventEmitter,Se.debug("constructor() [id:%s, direction:%s]",r,e),this._id=r,this._direction=e,this._extendedRtpCapabilities=f,this._canProduceByKind=h,this._maxSctpMessageSize=o?o.maxMessageSize:null;const m=sc.clone(l)??{};delete m.iceServers,delete m.iceTransportPolicy,delete m.bundlePolicy,delete m.rtcpMuxPolicy,delete m.sdpSemantics,this._handler=u(),this._handler.run({direction:e,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:m,proprietaryConstraints:d,extendedRtpCapabilities:f}),this._appData=p??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){if(!this._closed){Se.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const e of this._producers.values())e.transportClosed();this._producers.clear();for(const e of this._consumers.values())e.transportClosed();this._consumers.clear();for(const e of this._dataProducers.values())e.transportClosed();this._dataProducers.clear();for(const e of this._dataConsumers.values())e.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new Te.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:e}){if(Se.debug("restartIce()"),this._closed)throw new Te.InvalidStateError("closed");if(!e)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>await this._handler.restartIce(e),"transport.restartIce()")}async updateIceServers({iceServers:e}={}){if(Se.debug("updateIceServers()"),this._closed)throw new Te.InvalidStateError("closed");if(!Array.isArray(e))throw new TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(e),"transport.updateIceServers()")}async produce({track:e,encodings:r,codecOptions:n,codec:i,stopTracks:s=!0,disableTrackOnPause:o=!0,zeroRtpOnPause:a=!1,onRtpSender:c,appData:l={}}={}){if(Se.debug("produce() [track:%o]",e),this._closed)throw new Te.InvalidStateError("closed");if(e){if(this._direction!=="send")throw new Te.UnsupportedError("not a sending Transport");if(this._canProduceByKind[e.kind]){if(e.readyState==="ended")throw new Te.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if(l&&typeof l!="object")throw new TypeError("if given, appData must be an object")}else throw new Te.UnsupportedError(`cannot produce ${e.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(async()=>{let d;if(r&&!Array.isArray(r))throw TypeError("encodings must be an array");r&&r.length===0?d=void 0:r&&(d=r.map(h=>{const m={active:!0};return h.active===!1&&(m.active=!1),typeof h.dtx=="boolean"&&(m.dtx=h.dtx),typeof h.scalabilityMode=="string"&&(m.scalabilityMode=h.scalabilityMode),typeof h.scaleResolutionDownBy=="number"&&(m.scaleResolutionDownBy=h.scaleResolutionDownBy),typeof h.maxBitrate=="number"&&(m.maxBitrate=h.maxBitrate),typeof h.maxFramerate=="number"&&(m.maxFramerate=h.maxFramerate),typeof h.adaptivePtime=="boolean"&&(m.adaptivePtime=h.adaptivePtime),typeof h.priority=="string"&&(m.priority=h.priority),typeof h.networkPriority=="string"&&(m.networkPriority=h.networkPriority),m}));const{localId:p,rtpParameters:u,rtpSender:f}=await this._handler.send({track:e,encodings:d,codecOptions:n,codec:i,onRtpSender:c});try{_i.validateRtpParameters(u);const{id:h}=await new Promise((y,g)=>{this.safeEmit("produce",{kind:e.kind,rtpParameters:u,appData:l},y,g)}),m=new qy.Producer({id:h,localId:p,rtpSender:f,track:e,rtpParameters:u,stopTracks:s,disableTrackOnPause:o,zeroRtpOnPause:a,appData:l});return this._producers.set(m.id,m),this.handleProducer(m),this._observer.safeEmit("newproducer",m),m}catch(h){throw this._handler.stopSending(p).catch(()=>{}),h}},"transport.produce()").catch(d=>{if(s)try{e.stop()}catch{}throw d})}async consume({id:e,producerId:r,kind:n,rtpParameters:i,streamId:s,onRtpReceiver:o,appData:a={}}){if(Se.debug("consume()"),this._closed)throw new Te.InvalidStateError("closed");if(this._direction!=="recv")throw new Te.UnsupportedError("not a receiving Transport");if(typeof e!="string")throw new TypeError("missing id");if(typeof r!="string")throw new TypeError("missing producerId");if(n!=="audio"&&n!=="video")throw new TypeError(`invalid kind '${n}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object");const c=sc.clone(i);if(!_i.canReceive(c,this._extendedRtpCapabilities))throw new Te.UnsupportedError("cannot consume this Producer");const d=new Zy({id:e,producerId:r,kind:n,rtpParameters:c,streamId:s,onRtpReceiver:o,appData:a});return this._pendingConsumerTasks.push(d),(0,ic.default)(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),d.promise}async produceData({ordered:e=!0,maxPacketLifeTime:r,maxRetransmits:n,label:i="",protocol:s="",appData:o={}}={}){if(Se.debug("produceData()"),this._closed)throw new Te.InvalidStateError("closed");if(this._direction!=="send")throw new Te.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(o&&typeof o!="object")throw new TypeError("if given, appData must be an object")}else throw new Te.UnsupportedError("SCTP not enabled by remote Transport");return(r||n)&&(e=!1),this._awaitQueue.push(async()=>{const{dataChannel:a,sctpStreamParameters:c}=await this._handler.sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s});_i.validateSctpStreamParameters(c);const{id:l}=await new Promise((p,u)=>{this.safeEmit("producedata",{sctpStreamParameters:c,label:i,protocol:s,appData:o},p,u)}),d=new Yy.DataProducer({id:l,dataChannel:a,sctpStreamParameters:c,appData:o});return this._dataProducers.set(d.id,d),this.handleDataProducer(d),this._observer.safeEmit("newdataproducer",d),d},"transport.produceData()")}async consumeData({id:e,dataProducerId:r,sctpStreamParameters:n,label:i="",protocol:s="",appData:o={}}){if(Se.debug("consumeData()"),this._closed)throw new Te.InvalidStateError("closed");if(this._direction!=="recv")throw new Te.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof e!="string")throw new TypeError("missing id");if(typeof r!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(o&&typeof o!="object")throw new TypeError("if given, appData must be an object")}else throw new Te.UnsupportedError("SCTP not enabled by remote Transport");const a=sc.clone(n);return _i.validateSctpStreamParameters(a),this._awaitQueue.push(async()=>{const{dataChannel:c}=await this._handler.receiveDataChannel({sctpStreamParameters:a,label:i,protocol:s}),l=new Xy.DataConsumer({id:e,dataProducerId:r,dataChannel:c,sctpStreamParameters:a,appData:o});return this._dataConsumers.set(l.id,l),this.handleDataConsumer(l),this._observer.safeEmit("newdataconsumer",l),l},"transport.consumeData()")}async createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingConsumerTasks.length===0){Se.debug("createPendingConsumers() | there is no Consumer to be created");return}const e=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let r;const n=[];for(const i of e){const{id:s,kind:o,rtpParameters:a,streamId:c,onRtpReceiver:l}=i.consumerOptions;n.push({trackId:s,kind:o,rtpParameters:a,streamId:c,onRtpReceiver:l})}try{const i=await this._handler.receive(n);for(let s=0;s<i.length;++s){const o=e[s],a=i[s],{id:c,producerId:l,kind:d,rtpParameters:p,appData:u}=o.consumerOptions,{localId:f,rtpReceiver:h,track:m}=a,y=new Gy.Consumer({id:c,localId:f,producerId:l,rtpReceiver:h,track:m,rtpParameters:p,appData:u});this._consumers.set(y.id,y),this.handleConsumer(y),!this._probatorConsumerCreated&&!r&&d==="video"&&(r=y),this._observer.safeEmit("newconsumer",y),o.resolve(y)}}catch(i){for(const s of e)s.reject(i)}if(r)try{const i=_i.generateProbatorRtpParameters(r.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:i}]),Se.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(i){Se.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",i)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingPauseConsumers.size===0){Se.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const e=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const r=e.map(n=>n.localId);await this._handler.pauseReceiving(r)}catch(r){Se.error("pausePendingConsumers() | failed to pause Consumers:",r)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingResumeConsumers.size===0){Se.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const e=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const r=e.map(n=>n.localId);await this._handler.resumeReceiving(r)}catch(r){Se.error("resumePendingConsumers() | failed to resume Consumers:",r)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingCloseConsumers.size===0){Se.debug("closePendingConsumers() | there is no Consumer to be closed");return}const e=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(e.map(r=>r.localId))}catch(r){Se.error("closePendingConsumers() | failed to close Consumers:",r)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const e=this._handler;e.on("@connect",({dtlsParameters:r},n,i)=>{if(this._closed){i(new Te.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:r},n,i)}),e.on("@icegatheringstatechange",r=>{r!==this._iceGatheringState&&(Se.debug("ICE gathering state changed to %s",r),this._iceGatheringState=r,this._closed||this.safeEmit("icegatheringstatechange",r))}),e.on("@connectionstatechange",r=>{r!==this._connectionState&&(Se.debug("connection state changed to %s",r),this._connectionState=r,this._closed||this.safeEmit("connectionstatechange",r))})}handleProducer(e){e.on("@close",()=>{this._producers.delete(e.id),!this._closed&&this._awaitQueue.push(async()=>await this._handler.stopSending(e.localId),"producer @close event").catch(r=>Se.warn("producer.close() failed:%o",r))}),e.on("@pause",(r,n)=>{this._awaitQueue.push(async()=>await this._handler.pauseSending(e.localId),"producer @pause event").then(r).catch(n)}),e.on("@resume",(r,n)=>{this._awaitQueue.push(async()=>await this._handler.resumeSending(e.localId),"producer @resume event").then(r).catch(n)}),e.on("@replacetrack",(r,n,i)=>{this._awaitQueue.push(async()=>await this._handler.replaceTrack(e.localId,r),"producer @replacetrack event").then(n).catch(i)}),e.on("@setmaxspatiallayer",(r,n,i)=>{this._awaitQueue.push(async()=>await this._handler.setMaxSpatialLayer(e.localId,r),"producer @setmaxspatiallayer event").then(n).catch(i)}),e.on("@setrtpencodingparameters",(r,n,i)=>{this._awaitQueue.push(async()=>await this._handler.setRtpEncodingParameters(e.localId,r),"producer @setrtpencodingparameters event").then(n).catch(i)}),e.on("@getstats",(r,n)=>{if(this._closed)return n(new Te.InvalidStateError("closed"));this._handler.getSenderStats(e.localId).then(r).catch(n)})}handleConsumer(e){e.on("@close",()=>{this._consumers.delete(e.id),this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.delete(e.id),!this._closed&&(this._pendingCloseConsumers.set(e.id,e),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),e.on("@pause",()=>{this._pendingResumeConsumers.has(e.id)&&this._pendingResumeConsumers.delete(e.id),this._pendingPauseConsumers.set(e.id,e),(0,ic.default)(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),e.on("@resume",()=>{this._pendingPauseConsumers.has(e.id)&&this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.set(e.id,e),(0,ic.default)(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),e.on("@getstats",(r,n)=>{if(this._closed)return n(new Te.InvalidStateError("closed"));this._handler.getReceiverStats(e.localId).then(r).catch(n)})}handleDataProducer(e){e.on("@close",()=>{this._dataProducers.delete(e.id)})}handleDataConsumer(e){e.on("@close",()=>{this._dataConsumers.delete(e.id)})}};as.Transport=Jy;var fa={},_e={},Pm={},km={exports:{}},fp=km.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(fp).forEach(function(t){var e=fp[t];e.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})});var xm=km.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},r=function(a,c,l,d){if(d&&!l)c[d]=e(a[1]);else for(var p=0;p<l.length;p+=1)a[p+1]!=null&&(c[l[p]]=e(a[p+1]))},n=function(a,c,l){var d=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:d&&!c[a.name]&&(c[a.name]={});var p=a.push?{}:d?c[a.name]:c;r(l.match(a.reg),p,a.names,a.name),a.push&&c[a.push].push(p)},i=xm,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],d=c;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(p){var u=p[0],f=p.slice(2);u==="m"&&(l.push({rtp:[],fmtp:[]}),d=l[l.length-1]);for(var h=0;h<(i[u]||[]).length;h+=1){var m=i[u][h];if(m.reg.test(f))return n(m,d,f)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),d=0;d<l.length;d+=3)c.push({component:l[d],ip:l[d+1],port:l[d+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var d,p=!1;return l[0]!=="~"?d=e(l):(d=e(l.substring(1,l.length)),p=!0),{scid:d,paused:p}})})}})(Pm);var oc=xm,ew=/%[sdv%]/g,tw=function(t){var e=1,r=arguments,n=r.length;return t.replace(ew,function(i){if(e>=n)return i;var s=r[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},vi=function(t,e,r){var n=e.format instanceof Function?e.format(e.push?r:r[e.name]):e.format,i=[t+"="+n];if(e.names)for(var s=0;s<e.names.length;s+=1){var o=e.names[s];e.name?i.push(r[e.name][o]):i.push(r[e.names[s]])}else i.push(r[e.name]);return tw.apply(null,i)},rw=["v","o","s","i","u","e","p","c","b","t","r","z","a"],nw=["i","c","b","a"],iw=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var r=e.outerOrder||rw,n=e.innerOrder||nw,i=[];return r.forEach(function(s){oc[s].forEach(function(o){o.name in t&&t[o.name]!=null?i.push(vi(s,o,t)):o.push in t&&t[o.push]!=null&&t[o.push].forEach(function(a){i.push(vi(s,o,a))})})}),t.media.forEach(function(s){i.push(vi("m",oc.m[0],s)),n.forEach(function(o){oc[o].forEach(function(a){a.name in s&&s[a.name]!=null?i.push(vi(o,a,s)):a.push in s&&s[a.push]!=null&&s[a.push].forEach(function(c){i.push(vi(o,a,c))})})})}),i.join(`\r
`)+`\r
`},en=Pm,sw=iw;_e.write=sw;_e.parse=en.parse;_e.parseParams=en.parseParams;_e.parseFmtpConfig=en.parseFmtpConfig;_e.parsePayloads=en.parsePayloads;_e.parseRemoteCandidates=en.parseRemoteCandidates;_e.parseImageAttributes=en.parseImageAttributes;_e.parseSimulcastStreamList=en.parseSimulcastStreamList;var Fe={},ow=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),aw=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),cw=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ow(e,t,r);return aw(e,t),e};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.extractRtpCapabilities=lw;Fe.extractDtlsParameters=dw;Fe.getCname=uw;Fe.applyCodecParameters=pw;const Lm=cw(_e);function lw({sdpObject:t}){const e=new Map,r=[];let n=!1,i=!1;for(const o of t.media){const a=o.type;switch(a){case"audio":{if(n)continue;n=!0;break}case"video":{if(i)continue;i=!0;break}default:continue}for(const c of o.rtp){const l={kind:a,mimeType:`${a}/${c.codec}`,preferredPayloadType:c.payload,clockRate:c.rate,channels:c.encoding,parameters:{},rtcpFeedback:[]};e.set(l.preferredPayloadType,l)}for(const c of o.fmtp||[]){const l=Lm.parseParams(c.config),d=e.get(c.payload);d&&(l!=null&&l.hasOwnProperty("profile-level-id")&&(l["profile-level-id"]=String(l["profile-level-id"])),d.parameters=l)}for(const c of o.rtcpFb||[]){const l={type:c.type,parameter:c.subtype};if(l.parameter||delete l.parameter,c.payload!=="*"){const d=e.get(c.payload);if(!d)continue;d.rtcpFeedback.push(l)}else for(const d of e.values())d.kind===a&&!/.+\/rtx$/i.test(d.mimeType)&&d.rtcpFeedback.push(l)}for(const c of o.ext||[]){if(c["encrypt-uri"])continue;const l={kind:a,uri:c.uri,preferredId:c.value};r.push(l)}}return{codecs:Array.from(e.values()),headerExtensions:r}}function dw({sdpObject:t}){let e=t.setup,r=t.fingerprint;if(!e||!r){const s=(t.media||[]).find(o=>o.port!==0);s&&(e??(e=s.setup),r??(r=s.fingerprint))}if(e){if(!r)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let n;switch(e){case"active":{n="client";break}case"passive":{n="server";break}case"actpass":{n="auto";break}}return{role:n,fingerprints:[{algorithm:r.type,value:r.hash}]}}function uw({offerMediaObject:t}){const e=(t.ssrcs||[]).find(r=>r.attribute==="cname");return e?e.value:""}function pw({offerRtpParameters:t,answerMediaObject:e}){for(const r of t.codecs){const n=r.mimeType.toLowerCase();if(n!=="audio/opus"||!(e.rtp||[]).find(a=>a.payload===r.payloadType))continue;e.fmtp=e.fmtp||[];let s=e.fmtp.find(a=>a.payload===r.payloadType);s||(s={payload:r.payloadType,config:""},e.fmtp.push(s));const o=Lm.parseParams(s.config);switch(n){case"audio/opus":{const a=r.parameters["sprop-stereo"];a!==void 0&&(o.stereo=a?1:0);break}}s.config="";for(const a of Object.keys(o))s.config&&(s.config+=";"),s.config+=`${a}=${o[a]}`}}var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.getRtpEncodings=fw;Vt.addLegacySimulcast=hw;function fw({offerMediaObject:t}){const e=new Set;for(const i of t.ssrcs||[]){const s=i.id;e.add(s)}if(e.size===0)throw new Error("no a=ssrc lines found");const r=new Map;for(const i of t.ssrcGroups||[]){if(i.semantics!=="FID")continue;let[s,o]=i.ssrcs.split(/\s+/);s=Number(s),o=Number(o),e.has(s)&&(e.delete(s),e.delete(o),r.set(s,o))}for(const i of e)r.set(i,null);const n=[];for(const[i,s]of r){const o={ssrc:i};s&&(o.rtx={ssrc:s}),n.push(o)}return n}function hw({offerMediaObject:t,numStreams:e}){if(e<=1)throw new TypeError("numStreams must be greater than 1");const r=(t.ssrcs||[]).find(p=>p.attribute==="msid");if(!r)throw new Error("a=ssrc line with msid information not found");const[n,i]=r.value.split(" "),s=Number(r.id);let o;(t.ssrcGroups||[]).some(p=>{if(p.semantics!=="FID")return!1;const u=p.ssrcs.split(/\s+/);return Number(u[0])===s?(o=Number(u[1]),!0):!1});const a=t.ssrcs.find(p=>p.attribute==="cname");if(!a)throw new Error("a=ssrc line with cname information not found");const c=a.value,l=[],d=[];for(let p=0;p<e;++p)l.push(s+p),o&&d.push(o+p);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const p of l)t.ssrcs.push({id:p,attribute:"cname",value:c}),t.ssrcs.push({id:p,attribute:"msid",value:`${n} ${i}`});for(let p=0;p<d.length;++p){const u=l[p],f=d[p];t.ssrcs.push({id:f,attribute:"cname",value:c}),t.ssrcs.push({id:f,attribute:"msid",value:`${n} ${i}`}),t.ssrcGroups.push({semantics:"FID",ssrcs:`${u} ${f}`})}}var ri={};Object.defineProperty(ri,"__esModule",{value:!0});ri.addNackSuppportForOpus=mw;function mw(t){var e;for(const r of t.codecs??[])(r.mimeType.toLowerCase()==="audio/opus"||r.mimeType.toLowerCase()==="audio/multiopus")&&!((e=r.rtcpFeedback)!=null&&e.some(n=>n.type==="nack"&&!n.parameter))&&(r.rtcpFeedback||(r.rtcpFeedback=[]),r.rtcpFeedback.push({type:"nack"}))}var Be={};Object.defineProperty(Be,"__esModule",{value:!0});Be.HandlerInterface=void 0;const gw=Ut;class _w extends gw.EnhancedEventEmitter{constructor(){super()}}Be.HandlerInterface=_w;var Ye={},xr={},vw=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),yw=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Mm=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vw(e,t,r);return yw(e,t),e};Object.defineProperty(xr,"__esModule",{value:!0});xr.OfferMediaSection=xr.AnswerMediaSection=xr.MediaSection=void 0;const ww=Mm(_e),hp=Mm(we);class yd{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,planB:i=!1}){if(this._mediaObject={},this._planB=i,e&&this.setIceParameters(e),r){this._mediaObject.candidates=[];for(const s of r){const o={};o.component=1,o.foundation=s.foundation,o.ip=s.address??s.ip,o.port=s.port,o.priority=s.priority,o.transport=s.protocol,o.type=s.type,s.tcpType&&(o.tcptype=s.tcpType),this._mediaObject.candidates.push(o)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}n&&this.setDtlsRole(n.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}xr.MediaSection=yd;class Sw extends yd{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:s,planB:o=!1,offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:d,extmapAllowMixed:p=!1}){switch(super({iceParameters:e,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a.mid),this._mediaObject.type=a.type,this._mediaObject.protocol=a.protocol,s?(this._mediaObject.connection={ip:s.ip,version:s.ipVersion},this._mediaObject.port=s.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),a.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const u of l.codecs){const f={payload:u.payloadType,codec:hl(u),rate:u.clockRate};u.channels>1&&(f.encoding=u.channels),this._mediaObject.rtp.push(f);const h=hp.clone(u.parameters)??{};let m=hp.clone(u.rtcpFeedback)??[];if(d){const{opusStereo:g,opusFec:_,opusDtx:v,opusMaxPlaybackRate:w,opusMaxAverageBitrate:b,opusPtime:C,opusNack:E,videoGoogleStartBitrate:P,videoGoogleMaxBitrate:Y,videoGoogleMinBitrate:$}=d,ve=c.codecs.find(Ie=>Ie.payloadType===u.payloadType);switch(u.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{g!==void 0&&(ve.parameters["sprop-stereo"]=g?1:0,h.stereo=g?1:0),_!==void 0&&(ve.parameters.useinbandfec=_?1:0,h.useinbandfec=_?1:0),v!==void 0&&(ve.parameters.usedtx=v?1:0,h.usedtx=v?1:0),w!==void 0&&(h.maxplaybackrate=w),b!==void 0&&(h.maxaveragebitrate=b),C!==void 0&&(ve.parameters.ptime=C,h.ptime=C),E||(ve.rtcpFeedback=ve.rtcpFeedback.filter(Ie=>Ie.type!=="nack"||Ie.parameter),m=m.filter(Ie=>Ie.type!=="nack"||Ie.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":{P!==void 0&&(h["x-google-start-bitrate"]=P),Y!==void 0&&(h["x-google-max-bitrate"]=Y),$!==void 0&&(h["x-google-min-bitrate"]=$);break}}}const y={payload:u.payloadType,config:""};for(const g of Object.keys(h))y.config&&(y.config+=";"),y.config+=`${g}=${h[g]}`;y.config&&this._mediaObject.fmtp.push(y);for(const g of m)this._mediaObject.rtcpFb.push({payload:u.payloadType,type:g.type,subtype:g.parameter})}this._mediaObject.payloads=l.codecs.map(u=>u.payloadType).join(" "),this._mediaObject.ext=[];for(const u of l.headerExtensions)(a.ext??[]).some(h=>h.uri===u.uri)&&this._mediaObject.ext.push({uri:u.uri,value:u.id});if(p&&a.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),a.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:a.simulcast.list1},this._mediaObject.rids=[];for(const u of a.rids??[])u.direction==="send"&&this._mediaObject.rids.push({id:u.id,direction:"recv"})}else if(a.simulcast_03){this._mediaObject.simulcast_03={value:a.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const u of a.rids??[])u.direction==="send"&&this._mediaObject.rids.push({id:u.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&this._mediaObject.type==="video"&&(this._mediaObject.xGoogleFlag="conference");break}case"application":{typeof a.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize):a.sctpmap&&(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize});break}}}setDtlsRole(e){switch(e){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(e){var s,o;if(!((s=this._mediaObject.simulcast)!=null&&s.list1))return;const r={};for(const a of e)a.rid&&(r[a.rid]=a);const n=this._mediaObject.simulcast.list1,i=ww.parseSimulcastStreamList(n);for(const a of i)for(const c of a)c.paused=!((o=r[c.scid])!=null&&o.active);this._mediaObject.simulcast.list1=i.map(a=>a.map(c=>`${c.paused?"~":""}${c.scid}`).join(",")).join(";")}}xr.AnswerMediaSection=Sw;class Rw extends yd{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:s,planB:o=!1,mid:a,kind:c,offerRtpParameters:l,streamId:d,trackId:p,oldDataChannelSpec:u=!1}){var f;switch(super({iceParameters:e,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a),this._mediaObject.type=c,s?(this._mediaObject.connection={ip:s.ip,version:s.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=s.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},i?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),c){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${d??"-"} ${p}`);for(const g of l.codecs){const _={payload:g.payloadType,codec:hl(g),rate:g.clockRate};g.channels>1&&(_.encoding=g.channels),this._mediaObject.rtp.push(_);const v={payload:g.payloadType,config:""};for(const w of Object.keys(g.parameters))v.config&&(v.config+=";"),v.config+=`${w}=${g.parameters[w]}`;v.config&&this._mediaObject.fmtp.push(v);for(const w of g.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:g.payloadType,type:w.type,subtype:w.parameter})}this._mediaObject.payloads=l.codecs.map(g=>g.payloadType).join(" "),this._mediaObject.ext=[];for(const g of l.headerExtensions)this._mediaObject.ext.push({uri:g.uri,value:g.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const h=l.encodings[0],m=h.ssrc,y=(f=h.rtx)==null?void 0:f.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],l.rtcp.cname&&this._mediaObject.ssrcs.push({id:m,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:m,attribute:"msid",value:`${d??"-"} ${p}`}),y&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:y,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:y,attribute:"msid",value:`${d??"-"} ${p}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${m} ${y}`}));break}case"application":{u?(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize);break}}}setDtlsRole(e){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive({offerRtpParameters:e,streamId:r,trackId:n}){var c;const i=e.encodings[0],s=i.ssrc,o=(c=i.rtx)==null?void 0:c.ssrc,a=this._mediaObject.payloads.split(" ");for(const l of e.codecs){if(a.includes(String(l.payloadType)))continue;const d={payload:l.payloadType,codec:hl(l),rate:l.clockRate};l.channels>1&&(d.encoding=l.channels),this._mediaObject.rtp.push(d);const p={payload:l.payloadType,config:""};for(const u of Object.keys(l.parameters))p.config&&(p.config+=";"),p.config+=`${u}=${l.parameters[u]}`;p.config&&this._mediaObject.fmtp.push(p);for(const u of l.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:l.payloadType,type:u.type,subtype:u.parameter})}this._mediaObject.payloads+=` ${e.codecs.filter(l=>!this._mediaObject.payloads.includes(l.payloadType)).map(l=>l.payloadType).join(" ")}`,this._mediaObject.payloads=this._mediaObject.payloads.trim(),e.rtcp.cname&&this._mediaObject.ssrcs.push({id:s,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:s,attribute:"msid",value:`${r??"-"} ${n}`}),o&&(e.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:`${r??"-"} ${n}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${s} ${o}`}))}planBStopReceiving({offerRtpParameters:e}){var s;const r=e.encodings[0],n=r.ssrc,i=(s=r.rtx)==null?void 0:s.ssrc;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(o=>o.id!==n&&o.id!==i),i&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(o=>o.ssrcs!==`${n} ${i}`))}}xr.OfferMediaSection=Rw;function hl(t){const r=new RegExp("^(audio|video)/(.+)","i").exec(t.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");return r[2]}var bw=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Cw=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Tw=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bw(e,t,r);return Cw(e,t),e};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.RemoteSdp=void 0;const Dw=Tw(_e),Ew=he,Fs=xr,ac=new Ew.Logger("RemoteSdp");class Pw{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:s,planB:o=!1}){if(this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=e,this._iceCandidates=r,this._dtlsParameters=n,this._sctpParameters=i,this._plainRtpParameters=s,this._planB=o,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},e!=null&&e.iceLite&&(this._sdpObject.icelite="ice-lite"),n){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const a=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:n.fingerprints[a-1].algorithm,hash:n.fingerprints[a-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}s&&(this._sdpObject.origin.address=s.ip,this._sdpObject.origin.ipVer=s.ipVersion)}updateIceParameters(e){ac.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;for(const r of this._mediaSections)r.setIceParameters(e)}updateDtlsRole(e){ac.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;for(const r of this._mediaSections)r.setDtlsRole(e)}getNextMediaSectionIdx(){for(let e=0;e<this._mediaSections.length;++e){const r=this._mediaSections[e];if(r.closed)return{idx:e,reuseMid:r.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:e,reuseMid:r,offerRtpParameters:n,answerRtpParameters:i,codecOptions:s,extmapAllowMixed:o=!1}){const a=new Fs.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:e,offerRtpParameters:n,answerRtpParameters:i,codecOptions:s,extmapAllowMixed:o});r?this._replaceMediaSection(a,r):this._midToIndex.has(a.mid)?this._replaceMediaSection(a):this._addMediaSection(a)}receive({mid:e,kind:r,offerRtpParameters:n,streamId:i,trackId:s}){const o=this._midToIndex.get(e);let a;if(o!==void 0&&(a=this._mediaSections[o]),a)a.planBReceive({offerRtpParameters:n,streamId:i,trackId:s}),this._replaceMediaSection(a);else{a=new Fs.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:e,kind:r,offerRtpParameters:n,streamId:i,trackId:s});const c=this._mediaSections.find(l=>l.closed);c?this._replaceMediaSection(a,c.mid):this._addMediaSection(a)}}pauseMediaSection(e){this._findMediaSection(e).pause()}resumeSendingMediaSection(e){this._findMediaSection(e).resume()}resumeReceivingMediaSection(e){this._findMediaSection(e).resume()}disableMediaSection(e){this._findMediaSection(e).disable()}closeMediaSection(e){const r=this._findMediaSection(e);return e===this._firstMid?(ac.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(r.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(e,r){const n=this._findMediaSection(e);n.muxSimulcastStreams(r),this._replaceMediaSection(n)}planBStopReceiving({mid:e,offerRtpParameters:r}){const n=this._findMediaSection(e);n.planBStopReceiving({offerRtpParameters:r}),this._replaceMediaSection(n)}sendSctpAssociation({offerMediaObject:e}){const r=new Fs.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:e});this._addMediaSection(r)}receiveSctpAssociation({oldDataChannelSpec:e=!1}={}){const r=new Fs.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:e});this._addMediaSection(r)}getSdp(){return this._sdpObject.origin.sessionVersion++,Dw.write(this._sdpObject)}_addMediaSection(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}_replaceMediaSection(e,r){if(typeof r=="string"){const n=this._midToIndex.get(r);if(n===void 0)throw new Error(`no media section found for reuseMid '${r}'`);const i=this._mediaSections[n];this._mediaSections[n]=e,this._midToIndex.delete(i.mid),this._midToIndex.set(e.mid,n),this._sdpObject.media[n]=e.getObject(),this._regenerateBundleMids()}else{const n=this._midToIndex.get(e.mid);if(n===void 0)throw new Error(`no media section found with mid '${e.mid}'`);this._mediaSections[n]=e,this._sdpObject.media[n]=e.getObject()}}_findMediaSection(e){const r=this._midToIndex.get(e);if(r===void 0)throw new Error(`no media section found with mid '${e}'`);return this._mediaSections[r]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(e=>!e.closed).map(e=>e.mid).join(" "))}}Ye.RemoteSdp=Pw;var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.parse=xw;const kw=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function xw(t){const e=kw.exec(t??"");return e?{spatialLayers:Number(e[1]),temporalLayers:Number(e[2])}:{spatialLayers:1,temporalLayers:1}}var Lw=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Mw=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ni=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lw(e,t,r);return Mw(e,t),e};Object.defineProperty(fa,"__esModule",{value:!0});fa.Chrome111=void 0;const ur=ni(_e),Ow=he,mp=ni(we),fn=ni(ne),Bs=ni(Fe),gp=ni(Vt),Iw=ni(ri),Nw=Ce,jw=Be,$w=Ye,Aw=Ht,M=new Ow.Logger("Chrome111"),Fw="Chrome111",_p={OS:1024,MIS:1024};class wd extends jw.HandlerInterface{static createFactory(){return()=>new wd}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return Fw}close(){if(M.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){M.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=ur.parse(r.sdp),i=Bs.extractRtpCapabilities({sdpObject:n});return Iw.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return M.debug("getNativeSctpCapabilities()"),{numStreams:_p}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),M.debug("run()"),this._direction=e,this._remoteSdp=new $w.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:fn.getSendingRtpParameters("audio",d),video:fn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:fn.getSendingRemoteRtpParameters("audio",d),video:fn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(M.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(e){this.assertNotClosed(),M.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),M.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});M.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){if(this.assertNotClosed(),this.assertSendDirection(),M.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1){let m=1;for(const y of r){const g=y.scalabilityMode?(0,Aw.parse)(y.scalabilityMode).temporalLayers:3;g>m&&(m=g)}r.forEach((y,g)=>{y.rid=`r${g}`,y.scalabilityMode=`L1T${m}`})}const o=mp.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=fn.reduceCodecs(o.codecs,i);const a=mp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=fn.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});s&&s(l.sender);const d=await this._pc.createOffer();let p=ur.parse(d.sdp);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p}),M.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const u=l.mid;o.mid=u,p=ur.parse(this._pc.localDescription.sdp);const f=p.media[c.idx];if(o.rtcp.cname=Bs.getCname({offerMediaObject:f}),!r)o.encodings=gp.getRtpEncodings({offerMediaObject:f});else if(r.length===1){const m=gp.getRtpEncodings({offerMediaObject:f});Object.assign(m[0],r[0]),o.encodings=m}else o.encodings=r;this._remoteSdp.send({offerMediaObject:f,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n,extmapAllowMixed:!0});const h={type:"answer",sdp:this._remoteSdp.getSdp()};return M.debug("send() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setRemoteDescription(h),this._mapMidTransceiver.set(u,l),{localId:u,rtpParameters:o,rtpSender:l.sender}}async stopSending(e){if(this.assertSendDirection(),M.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();M.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),M.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();M.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),M.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly";const n=await this._pc.createOffer();M.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?M.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):M.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),M.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();M.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),M.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();M.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};M.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%_p.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=ur.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),M.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;M.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=ur.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Bs.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:ur.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),M.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(d)this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){M.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){M.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){M.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};M.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=ur.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}M.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=ur.parse(this._pc.localDescription.sdp));const n=Bs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Nw.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}fa.Chrome111=wd;var ha={},Bw=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),zw=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ii=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Bw(e,t,r);return zw(e,t),e};Object.defineProperty(ha,"__esModule",{value:!0});ha.Chrome74=void 0;const kt=ii(_e),Uw=he,vp=ii(we),hn=ii(ne),zs=ii(Fe),cc=ii(Vt),Vw=ii(ri),Hw=Ce,Kw=Be,Ww=Ye,Qw=Ht,x=new Uw.Logger("Chrome74"),qw="Chrome74",yp={OS:1024,MIS:1024};class Sd extends Kw.HandlerInterface{static createFactory(){return()=>new Sd}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return qw}close(){if(x.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){x.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=kt.parse(r.sdp),i=zs.extractRtpCapabilities({sdpObject:n});return Vw.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return x.debug("getNativeSctpCapabilities()"),{numStreams:yp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){x.debug("run()"),this._direction=e,this._remoteSdp=new Ww.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:hn.getSendingRtpParameters("audio",d),video:hn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:hn.getSendingRemoteRtpParameters("audio",d),video:hn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(x.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(e){this.assertNotClosed(),x.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),x.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});x.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertNotClosed(),this.assertSendDirection(),x.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1&&r.forEach((y,g)=>{y.rid=`r${g}`});const s=vp.clone(this._sendingRtpParametersByKind[e.kind]);s.codecs=hn.reduceCodecs(s.codecs,i);const o=vp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);o.codecs=hn.reduceCodecs(o.codecs,i);const a=this._remoteSdp.getNextMediaSectionIdx(),c=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});let l=await this._pc.createOffer(),d=kt.parse(l.sdp),p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d});let u=!1;const f=(0,Qw.parse)((r??[{}])[0].scalabilityMode);r&&r.length===1&&f.spatialLayers>1&&s.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(x.debug("send() | enabling legacy simulcast for VP9 SVC"),u=!0,d=kt.parse(l.sdp),p=d.media[a.idx],cc.addLegacySimulcast({offerMediaObject:p,numStreams:f.spatialLayers}),l={type:"offer",sdp:kt.write(d)}),x.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const h=c.mid;if(s.mid=h,d=kt.parse(this._pc.localDescription.sdp),p=d.media[a.idx],s.rtcp.cname=zs.getCname({offerMediaObject:p}),!r)s.encodings=cc.getRtpEncodings({offerMediaObject:p});else if(r.length===1){let y=cc.getRtpEncodings({offerMediaObject:p});Object.assign(y[0],r[0]),u&&(y=[y[0]]),s.encodings=y}else s.encodings=r;if(s.encodings.length>1&&(s.codecs[0].mimeType.toLowerCase()==="video/vp8"||s.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const y of s.encodings)y.scalabilityMode?y.scalabilityMode=`L1T${f.temporalLayers}`:y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:a.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:n,extmapAllowMixed:!0});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return x.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),this._mapMidTransceiver.set(h,c),{localId:h,rtpParameters:s,rtpSender:c.sender}}async stopSending(e){if(this.assertSendDirection(),x.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();x.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),x.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();x.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),x.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly";const n=await this._pc.createOffer();x.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?x.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):x.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();x.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();x.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};x.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%yp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=kt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),x.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;x.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=kt.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);zs.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:kt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),x.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(d)this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){x.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){x.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){x.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};x.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=kt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=kt.parse(this._pc.localDescription.sdp));const n=zs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Hw.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ha.Chrome74=Sd;var ma={},Gw=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Yw=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ps=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Gw(e,t,r);return Yw(e,t),e};Object.defineProperty(ma,"__esModule",{value:!0});ma.Chrome70=void 0;const nt=ps(_e),Xw=he,wp=ps(we),mn=ps(ne),Us=ps(Fe),lc=ps(Vt),Zw=Be,Jw=Ye,eS=Ht,z=new Xw.Logger("Chrome70"),tS="Chrome70",Sp={OS:1024,MIS:1024};class Rd extends Zw.HandlerInterface{static createFactory(){return()=>new Rd}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return tS}close(){if(z.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){z.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=nt.parse(r.sdp);return Us.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return z.debug("getNativeSctpCapabilities()"),{numStreams:Sp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){z.debug("run()"),this._direction=e,this._remoteSdp=new Jw.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:mn.getSendingRtpParameters("audio",d),video:mn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:mn.getSendingRemoteRtpParameters("audio",d),video:mn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(z.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){z.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(z.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});z.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();z.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),z.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const s=wp.clone(this._sendingRtpParametersByKind[e.kind]);s.codecs=mn.reduceCodecs(s.codecs,i);const o=wp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);o.codecs=mn.reduceCodecs(o.codecs,i);const a=this._remoteSdp.getNextMediaSectionIdx(),c=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});let l=await this._pc.createOffer(),d=nt.parse(l.sdp),p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),r&&r.length>1&&(z.debug("send() | enabling legacy simulcast"),d=nt.parse(l.sdp),p=d.media[a.idx],lc.addLegacySimulcast({offerMediaObject:p,numStreams:r.length}),l={type:"offer",sdp:nt.write(d)});let u=!1;const f=(0,eS.parse)((r??[{}])[0].scalabilityMode);if(r&&r.length===1&&f.spatialLayers>1&&s.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(z.debug("send() | enabling legacy simulcast for VP9 SVC"),u=!0,d=nt.parse(l.sdp),p=d.media[a.idx],lc.addLegacySimulcast({offerMediaObject:p,numStreams:f.spatialLayers}),l={type:"offer",sdp:nt.write(d)}),z.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),r){z.debug("send() | applying given encodings");const y=c.sender.getParameters();for(let g=0;g<(y.encodings??[]).length;++g){const _=y.encodings[g],v=r[g];if(!v)break;y.encodings[g]=Object.assign(_,v)}await c.sender.setParameters(y)}const h=c.mid;if(s.mid=h,d=nt.parse(this._pc.localDescription.sdp),p=d.media[a.idx],s.rtcp.cname=Us.getCname({offerMediaObject:p}),s.encodings=lc.getRtpEncodings({offerMediaObject:p}),r)for(let y=0;y<s.encodings.length;++y)r[y]&&Object.assign(s.encodings[y],r[y]);if(u&&(s.encodings=[s.encodings[0]]),s.encodings.length>1&&(s.codecs[0].mimeType.toLowerCase()==="video/vp8"||s.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const y of s.encodings)y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:a.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:n});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return z.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),this._mapMidTransceiver.set(h,c),{localId:h,rtpParameters:s,rtpSender:c.sender}}async stopSending(e){this.assertSendDirection(),z.debug("stopSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();z.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){this.assertSendDirection(),r?z.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):z.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertSendDirection(),z.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();z.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertSendDirection(),z.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();z.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};z.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Sp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=nt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),z.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;z.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=nt.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Us.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:nt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),z.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){z.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();z.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};z.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=nt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=nt.parse(this._pc.localDescription.sdp));const n=Us.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ma.Chrome70=Rd;var ga={},tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.getRtpEncodings=rS;tn.addLegacySimulcast=nS;function rS({offerMediaObject:t,track:e}){const r=new Set;for(const s of t.ssrcs||[]){if(s.attribute!=="msid")continue;if(s.value.split(" ")[1]===e.id){const a=s.id;r.add(a)}}if(r.size===0)throw new Error(`a=ssrc line with msid information not found [track.id:${e.id}]`);const n=new Map;for(const s of t.ssrcGroups||[]){if(s.semantics!=="FID")continue;let[o,a]=s.ssrcs.split(/\s+/);o=Number(o),a=Number(a),r.has(o)&&(r.delete(o),r.delete(a),n.set(o,a))}for(const s of r)n.set(s,null);const i=[];for(const[s,o]of n){const a={ssrc:s};o&&(a.rtx={ssrc:o}),i.push(a)}return i}function nS({offerMediaObject:t,track:e,numStreams:r}){if(r<=1)throw new TypeError("numStreams must be greater than 1");let n,i,s;if(!(t.ssrcs||[]).find(p=>p.attribute!=="msid"?!1:p.value.split(" ")[1]===e.id?(n=p.id,s=p.value.split(" ")[0],!0):!1))throw new Error(`a=ssrc line with msid information not found [track.id:${e.id}]`);(t.ssrcGroups||[]).some(p=>{if(p.semantics!=="FID")return!1;const u=p.ssrcs.split(/\s+/);return Number(u[0])===n?(i=Number(u[1]),!0):!1});const a=t.ssrcs.find(p=>p.attribute==="cname"&&p.id===n);if(!a)throw new Error(`a=ssrc line with cname information not found [track.id:${e.id}]`);const c=a.value,l=[],d=[];for(let p=0;p<r;++p)l.push(n+p),i&&d.push(i+p);t.ssrcGroups=t.ssrcGroups||[],t.ssrcs=t.ssrcs||[],t.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const p of l)t.ssrcs.push({id:p,attribute:"cname",value:c}),t.ssrcs.push({id:p,attribute:"msid",value:`${s} ${e.id}`});for(let p=0;p<d.length;++p){const u=l[p],f=d[p];t.ssrcs.push({id:f,attribute:"cname",value:c}),t.ssrcs.push({id:f,attribute:"msid",value:`${s} ${e.id}`}),t.ssrcGroups.push({semantics:"FID",ssrcs:`${u} ${f}`})}}var iS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),fs=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&iS(e,t,r);return sS(e,t),e};Object.defineProperty(ga,"__esModule",{value:!0});ga.Chrome67=void 0;const xt=fs(_e),oS=he,Rp=fs(we),gn=fs(ne),Vs=fs(Fe),bp=fs(tn),aS=Be,cS=Ye,V=new oS.Logger("Chrome67"),lS="Chrome67",Cp={OS:1024,MIS:1024};class bd extends aS.HandlerInterface{static createFactory(){return()=>new bd}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return lS}close(){if(V.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){V.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=xt.parse(r.sdp);return Vs.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return V.debug("getNativeSctpCapabilities()"),{numStreams:Cp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){V.debug("run()"),this._direction=e,this._remoteSdp=new cS.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:gn.getSendingRtpParameters("audio",d),video:gn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:gn.getSendingRemoteRtpParameters("audio",d),video:gn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(V.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){V.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(V.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});V.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();V.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),V.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&V.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let s=await this._pc.createOffer(),o=xt.parse(s.sdp),a;const c=Rp.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=gn.reduceCodecs(c.codecs);const l=Rp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=gn.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(V.debug("send() | enabling simulcast"),o=xt.parse(s.sdp),a=o.media.find(f=>f.type==="video"),bp.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:xt.write(o)}),V.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=xt.parse(this._pc.localDescription.sdp),a=o.media.find(f=>f.type===e.kind),c.rtcp.cname=Vs.getCname({offerMediaObject:a}),c.encodings=bp.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let f=0;f<c.encodings.length;++f)r[f]&&Object.assign(c.encodings[f],r[f]);if(c.encodings.length>1&&c.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of c.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const u=this._pc.getSenders().find(f=>f.track===e);return this._mapSendLocalIdRtpSender.set(p,u),{localId:p,rtpParameters:c,rtpSender:u}}async stopSending(e){this.assertSendDirection(),V.debug("stopSending() [localId:%s]",e);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(r),r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(e);const n=await this._pc.createOffer();V.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){V.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){this.assertSendDirection(),r?V.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):V.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.track;await n.replaceTrack(r),i&&this._sendStream.removeTrack(i),r&&this._sendStream.addTrack(r)}async setMaxSpatialLayer(e,r){this.assertSendDirection(),V.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{o<=r?s.active=!0:s.active=!1}),await n.setParameters(i)}async setRtpEncodingParameters(e,r){this.assertSendDirection(),V.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{i.encodings[o]={...s,...r}}),await n.setParameters(i)}async getSenderStats(e){this.assertSendDirection();const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");return r.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};V.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Cp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=xt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),V.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[];for(const o of e){const{trackId:a,kind:c,rtpParameters:l,streamId:d}=o;V.debug("receive() [trackId:%s, kind:%s]",a,c);const p=c;this._remoteSdp.receive({mid:p,kind:c,offerRtpParameters:l,streamId:d??l.rtcp.cname,trackId:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const s=xt.parse(i.sdp);for(const o of e){const{kind:a,rtpParameters:c}=o,l=a,d=s.media.find(p=>String(p.mid)===l);Vs.applyCodecParameters({offerRtpParameters:c,answerMediaObject:d})}i={type:"answer",sdp:xt.write(s)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:s}),V.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const o of e){const{kind:a,trackId:c,rtpParameters:l}=o,d=c,p=a,u=this._pc.getReceivers().find(f=>f.track&&f.track.id===d);if(!u)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(d,{mid:p,rtpParameters:l,rtpReceiver:u}),r.push({localId:d,track:u.track,rtpReceiver:u})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){V.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();V.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:r}=this._mapRecvLocalIdInfo.get(e)??{};if(!r)throw new Error("associated RTCRtpReceiver not found");return r.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};V.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=xt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=xt.parse(this._pc.localDescription.sdp));const n=Vs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ga.Chrome67=bd;var _a={},dS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),uS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hs=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&dS(e,t,r);return uS(e,t),e};Object.defineProperty(_a,"__esModule",{value:!0});_a.Chrome55=void 0;const Lt=hs(_e),pS=he,yi=Ce,Tp=hs(we),_n=hs(ne),Hs=hs(Fe),Dp=hs(tn),fS=Be,hS=Ye,G=new pS.Logger("Chrome55"),mS="Chrome55",Ep={OS:1024,MIS:1024};class Cd extends fS.HandlerInterface{static createFactory(){return()=>new Cd}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return mS}close(){if(G.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){G.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=Lt.parse(r.sdp);return Hs.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return G.debug("getNativeSctpCapabilities()"),{numStreams:Ep}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){G.debug("run()"),this._direction=e,this._remoteSdp=new hS.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:_n.getSendingRtpParameters("audio",d),video:_n.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:_n.getSendingRemoteRtpParameters("audio",d),video:_n.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(G.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){G.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(G.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});G.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();G.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),G.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&G.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let s=await this._pc.createOffer(),o=Lt.parse(s.sdp),a;const c=Tp.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=_n.reduceCodecs(c.codecs);const l=Tp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=_n.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(G.debug("send() | enabling simulcast"),o=Lt.parse(s.sdp),a=o.media.find(u=>u.type==="video"),Dp.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:Lt.write(o)}),G.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=Lt.parse(this._pc.localDescription.sdp),a=o.media.find(u=>u.type===e.kind),c.rtcp.cname=Hs.getCname({offerMediaObject:a}),c.encodings=Dp.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let u=0;u<c.encodings.length;++u)r[u]&&Object.assign(c.encodings[u],r[u]);if(c.encodings.length>1&&c.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const u of c.encodings)u.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,e),{localId:p,rtpParameters:c}}async stopSending(e){this.assertSendDirection(),G.debug("stopSending() [localId:%s]",e);const r=this._mapSendLocalIdTrack.get(e);if(!r)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream);const n=await this._pc.createOffer();G.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){G.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){throw new yi.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,r){throw new yi.UnsupportedError(" not implemented")}async setRtpEncodingParameters(e,r){throw new yi.UnsupportedError("not supported")}async getSenderStats(e){throw new yi.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};G.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Ep.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Lt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),G.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[];for(const o of e){const{trackId:a,kind:c,rtpParameters:l,streamId:d}=o;G.debug("receive() [trackId:%s, kind:%s]",a,c);const p=c;this._remoteSdp.receive({mid:p,kind:c,offerRtpParameters:l,streamId:d??l.rtcp.cname,trackId:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const s=Lt.parse(i.sdp);for(const o of e){const{kind:a,rtpParameters:c}=o,l=a,d=s.media.find(p=>String(p.mid)===l);Hs.applyCodecParameters({offerRtpParameters:c,answerMediaObject:d})}i={type:"answer",sdp:Lt.write(s)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:s}),G.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const o of e){const{kind:a,trackId:c,rtpParameters:l}=o,d=a,p=c,u=o.streamId??l.rtcp.cname,h=this._pc.getRemoteStreams().find(m=>m.id===u).getTrackById(p);if(!h)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:l}),r.push({localId:p,track:h})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){G.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();G.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new yi.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};G.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Lt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}G.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Lt.parse(this._pc.localDescription.sdp));const n=Hs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}_a.Chrome55=Cd;var va={},gS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_S=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ms=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&gS(e,t,r);return _S(e,t),e};Object.defineProperty(va,"__esModule",{value:!0});va.Firefox120=void 0;const pr=ms(_e),vS=he,Pp=Ce,kp=ms(we),vn=ms(ne),Ks=ms(Fe),xp=ms(Vt),yS=Be,wS=Ye,SS=Ht,O=new vS.Logger("Firefox120"),RS="Firefox120",Lp={OS:16,MIS:2048};class Td extends yS.HandlerInterface{static createFactory(){return()=>new Td}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return RS}close(){if(O.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){O.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),r=document.createElement("canvas");r.getContext("2d");const i=r.captureStream().getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"}),e.addTransceiver(i,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const s=await e.createOffer();try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}const o=pr.parse(s.sdp);return Ks.extractRtpCapabilities({sdpObject:o})}catch(s){try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}throw s}}async getNativeSctpCapabilities(){return O.debug("getNativeSctpCapabilities()"),{numStreams:Lp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),O.debug("run()"),this._direction=e,this._remoteSdp=new wS.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:vn.getSendingRtpParameters("audio",d),video:vn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:vn.getSendingRemoteRtpParameters("audio",d),video:vn.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(O.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){throw this.assertNotClosed(),new Pp.UnsupportedError("not supported")}async restartIce(e){if(this.assertNotClosed(),O.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});O.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){this.assertNotClosed(),this.assertSendDirection(),O.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1&&r.forEach((m,y)=>{m.rid=`r${y}`});const o=kp.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=vn.reduceCodecs(o.codecs,i);const a=kp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=vn.reduceCodecs(a.codecs,i);const c=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});s&&s(c.sender);const l=await this._pc.createOffer();let d=pr.parse(l.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d});const p=(0,SS.parse)((r??[{}])[0].scalabilityMode);O.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const u=c.mid;o.mid=u,d=pr.parse(this._pc.localDescription.sdp);const f=d.media[d.media.length-1];if(o.rtcp.cname=Ks.getCname({offerMediaObject:f}),!r)o.encodings=xp.getRtpEncodings({offerMediaObject:f});else if(r.length===1){const m=xp.getRtpEncodings({offerMediaObject:f});Object.assign(m[0],r[0]),o.encodings=m}else o.encodings=r;if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const m of o.encodings)m.scalabilityMode?m.scalabilityMode=`L1T${p.temporalLayers}`:m.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n,extmapAllowMixed:!0});const h={type:"answer",sdp:this._remoteSdp.getSdp()};return O.debug("send() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setRemoteDescription(h),this._mapMidTransceiver.set(u,c),{localId:u,rtpParameters:o,rtpSender:c.sender}}async stopSending(e){if(this.assertSendDirection(),O.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated transceiver not found");r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.disableMediaSection(r.mid);const n=await this._pc.createOffer();O.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),O.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();O.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),O.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const n=await this._pc.createOffer();O.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?O.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):O.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),O.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated transceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();O.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),O.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();O.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};O.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Lp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=pr.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),O.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;O.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=pr.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Ks.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p}),s={type:"answer",sdp:pr.write(o)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:o}),O.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){O.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){O.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){O.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};O.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=pr.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:u})}O.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=pr.parse(this._pc.localDescription.sdp));const n=Ks.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Pp.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}va.Firefox120=Td;var ya={},bS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),CS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),gs=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bS(e,t,r);return CS(e,t),e};Object.defineProperty(ya,"__esModule",{value:!0});ya.Firefox60=void 0;const fr=gs(_e),TS=he,Mp=Ce,dc=gs(we),yn=gs(ne),Ws=gs(Fe),Op=gs(Vt),DS=Be,ES=Ye,PS=Ht,I=new TS.Logger("Firefox60"),kS="Firefox60",Ip={OS:16,MIS:2048};class Dd extends DS.HandlerInterface{static createFactory(){return()=>new Dd}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return kS}close(){if(I.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){I.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),r=document.createElement("canvas");r.getContext("2d");const i=r.captureStream().getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"});const s=e.addTransceiver(i,{direction:"sendrecv"}),o=s.sender.getParameters(),a=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];o.encodings=a,await s.sender.setParameters(o);const c=await e.createOffer();try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}const l=fr.parse(c.sdp);return Ws.extractRtpCapabilities({sdpObject:l})}catch(s){try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}throw s}}async getNativeSctpCapabilities(){return I.debug("getNativeSctpCapabilities()"),{numStreams:Ip}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),I.debug("run()"),this._direction=e,this._remoteSdp=new ES.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:yn.getSendingRtpParameters("audio",d),video:yn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:yn.getSendingRemoteRtpParameters("audio",d),video:yn.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(I.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){throw this.assertNotClosed(),new Mp.UnsupportedError("not supported")}async restartIce(e){if(this.assertNotClosed(),I.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});I.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertNotClosed(),this.assertSendDirection(),I.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&(r=dc.clone(r),r.forEach((h,m)=>{h.rid=`r${m}`}),r.reverse());const s=dc.clone(this._sendingRtpParametersByKind[e.kind]);s.codecs=yn.reduceCodecs(s.codecs,i);const o=dc.clone(this._sendingRemoteRtpParametersByKind[e.kind]);o.codecs=yn.reduceCodecs(o.codecs,i);const a=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});if(r){const h=a.sender.getParameters();h.encodings=r,await a.sender.setParameters(h)}const c=await this._pc.createOffer();let l=fr.parse(c.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:l});const d=(0,PS.parse)((r??[{}])[0].scalabilityMode);I.debug("send() | calling pc.setLocalDescription() [offer:%o]",c),await this._pc.setLocalDescription(c);const p=a.mid;s.mid=p,l=fr.parse(this._pc.localDescription.sdp);const u=l.media[l.media.length-1];if(s.rtcp.cname=Ws.getCname({offerMediaObject:u}),!r)s.encodings=Op.getRtpEncodings({offerMediaObject:u});else if(r.length===1){const h=Op.getRtpEncodings({offerMediaObject:u});Object.assign(h[0],r[0]),s.encodings=h}else s.encodings=r.reverse();if(s.encodings.length>1&&(s.codecs[0].mimeType.toLowerCase()==="video/vp8"||s.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const h of s.encodings)h.scalabilityMode?h.scalabilityMode=`L1T${d.temporalLayers}`:h.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,offerRtpParameters:s,answerRtpParameters:o,codecOptions:n,extmapAllowMixed:!0});const f={type:"answer",sdp:this._remoteSdp.getSdp()};return I.debug("send() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._mapMidTransceiver.set(p,a),{localId:p,rtpParameters:s,rtpSender:a.sender}}async stopSending(e){if(this.assertSendDirection(),I.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated transceiver not found");r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.disableMediaSection(r.mid);const n=await this._pc.createOffer();I.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),I.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();I.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),I.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const n=await this._pc.createOffer();I.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?I.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):I.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),I.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated transceiver not found");const i=n.sender.getParameters();r=i.encodings.length-1-r,i.encodings.forEach((a,c)=>{c>=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();I.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),I.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();I.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};I.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Ip.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=fr.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),I.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;I.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=fr.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Ws.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p}),s={type:"answer",sdp:fr.write(o)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:o}),I.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){I.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){I.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){I.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};I.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=fr.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:u})}I.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=fr.parse(this._pc.localDescription.sdp));const n=Ws.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Mp.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ya.Firefox60=Dd;var wa={},xS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),LS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),si=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xS(e,t,r);return LS(e,t),e};Object.defineProperty(wa,"__esModule",{value:!0});wa.Safari12=void 0;const Mt=si(_e),MS=he,Np=si(we),wn=si(ne),Qs=si(Fe),jp=si(Vt),OS=si(ri),IS=Ce,NS=Be,jS=Ye,$S=Ht,L=new MS.Logger("Safari12"),AS="Safari12",$p={OS:1024,MIS:1024};class Ed extends NS.HandlerInterface{static createFactory(){return()=>new Ed}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return AS}close(){if(L.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){L.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=Mt.parse(r.sdp),i=Qs.extractRtpCapabilities({sdpObject:n});return OS.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return L.debug("getNativeSctpCapabilities()"),{numStreams:$p}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),L.debug("run()"),this._direction=e,this._remoteSdp=new jS.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:wn.getSendingRtpParameters("audio",d),video:wn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:wn.getSendingRemoteRtpParameters("audio",d),video:wn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(L.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){this.assertNotClosed(),L.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),L.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});L.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){this.assertNotClosed(),this.assertSendDirection(),L.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const o=Np.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=wn.reduceCodecs(o.codecs,i);const a=Np.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=wn.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});s&&s(l.sender);let d=await this._pc.createOffer(),p=Mt.parse(d.sdp),u;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});const f=(0,$S.parse)((r??[{}])[0].scalabilityMode);r&&r.length>1&&(L.debug("send() | enabling legacy simulcast"),p=Mt.parse(d.sdp),u=p.media[c.idx],jp.addLegacySimulcast({offerMediaObject:u,numStreams:r.length}),d={type:"offer",sdp:Mt.write(p)}),L.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const h=l.mid;if(o.mid=h,p=Mt.parse(this._pc.localDescription.sdp),u=p.media[c.idx],o.rtcp.cname=Qs.getCname({offerMediaObject:u}),o.encodings=jp.getRtpEncodings({offerMediaObject:u}),r)for(let y=0;y<o.encodings.length;++y)r[y]&&Object.assign(o.encodings[y],r[y]);if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const y of o.encodings)y.scalabilityMode?y.scalabilityMode=`L1T${f.temporalLayers}`:y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return L.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),this._mapMidTransceiver.set(h,l),{localId:h,rtpParameters:o,rtpSender:l.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;L.debug("stopSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();L.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),L.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();L.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),L.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const n=await this._pc.createOffer();L.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?L.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):L.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),L.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();L.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),L.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();L.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};L.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%$p.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Mt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),L.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;L.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=Mt.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Qs.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:Mt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),L.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){L.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){L.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){L.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};L.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Mt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}L.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Mt.parse(this._pc.localDescription.sdp));const n=Qs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new IS.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}wa.Safari12=Ed;var Sa={},FS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),BS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_s=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&FS(e,t,r);return BS(e,t),e};Object.defineProperty(Sa,"__esModule",{value:!0});Sa.Safari11=void 0;const Ot=_s(_e),zS=he,Ap=_s(we),Sn=_s(ne),qs=_s(Fe),Fp=_s(tn),US=Be,VS=Ye,K=new zS.Logger("Safari11"),HS="Safari11",Bp={OS:1024,MIS:1024};class Pd extends US.HandlerInterface{static createFactory(){return()=>new Pd}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return HS}close(){if(K.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){K.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=Ot.parse(r.sdp);return qs.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return K.debug("getNativeSctpCapabilities()"),{numStreams:Bp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){K.debug("run()"),this._direction=e,this._remoteSdp=new VS.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:Sn.getSendingRtpParameters("audio",d),video:Sn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:Sn.getSendingRemoteRtpParameters("audio",d),video:Sn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(K.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){K.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(K.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});K.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();K.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),K.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&K.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let s=await this._pc.createOffer(),o=Ot.parse(s.sdp),a;const c=Ap.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=Sn.reduceCodecs(c.codecs);const l=Ap.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=Sn.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(K.debug("send() | enabling simulcast"),o=Ot.parse(s.sdp),a=o.media.find(f=>f.type==="video"),Fp.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:Ot.write(o)}),K.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=Ot.parse(this._pc.localDescription.sdp),a=o.media.find(f=>f.type===e.kind),c.rtcp.cname=qs.getCname({offerMediaObject:a}),c.encodings=Fp.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let f=0;f<c.encodings.length;++f)r[f]&&Object.assign(c.encodings[f],r[f]);if(c.encodings.length>1&&c.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of c.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const u=this._pc.getSenders().find(f=>f.track===e);return this._mapSendLocalIdRtpSender.set(p,u),{localId:p,rtpParameters:c,rtpSender:u}}async stopSending(e){this.assertSendDirection();const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(e);const n=await this._pc.createOffer();K.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){K.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){this.assertSendDirection(),r?K.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):K.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.track;await n.replaceTrack(r),i&&this._sendStream.removeTrack(i),r&&this._sendStream.addTrack(r)}async setMaxSpatialLayer(e,r){this.assertSendDirection(),K.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{o<=r?s.active=!0:s.active=!1}),await n.setParameters(i)}async setRtpEncodingParameters(e,r){this.assertSendDirection(),K.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{i.encodings[o]={...s,...r}}),await n.setParameters(i)}async getSenderStats(e){this.assertSendDirection();const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");return r.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};K.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Bp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Ot.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),K.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[];for(const o of e){const{trackId:a,kind:c,rtpParameters:l,streamId:d}=o;K.debug("receive() [trackId:%s, kind:%s]",a,c);const p=c;this._remoteSdp.receive({mid:p,kind:c,offerRtpParameters:l,streamId:d??l.rtcp.cname,trackId:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const s=Ot.parse(i.sdp);for(const o of e){const{kind:a,rtpParameters:c}=o,l=a,d=s.media.find(p=>String(p.mid)===l);qs.applyCodecParameters({offerRtpParameters:c,answerMediaObject:d})}i={type:"answer",sdp:Ot.write(s)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:s}),K.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const o of e){const{kind:a,trackId:c,rtpParameters:l}=o,d=a,p=c,u=this._pc.getReceivers().find(f=>f.track&&f.track.id===p);if(!u)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:l,rtpReceiver:u}),r.push({localId:p,track:u.track,rtpReceiver:u})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){K.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();K.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:r}=this._mapRecvLocalIdInfo.get(e)??{};if(!r)throw new Error("associated RTCRtpReceiver not found");return r.getStats()}async pauseReceiving(e){}async resumeReceiving(e){}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};K.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Ot.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}K.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Ot.parse(this._pc.localDescription.sdp));const n=qs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Sa.Safari11=Pd;var Ra={},ba={},KS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),WS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),QS=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&KS(e,t,r);return WS(e,t),e};Object.defineProperty(ba,"__esModule",{value:!0});ba.getCapabilities=qS;ba.mangleRtpParameters=GS;const Om=QS(we);function qS(){const t=RTCRtpReceiver.getCapabilities(),e=Om.clone(t);for(const r of e.codecs??[]){if(r.channels=r.numChannels,delete r.numChannels,r.mimeType=r.mimeType??`${r.kind}/${r.name}`,r.parameters){const n=r.parameters;n.apt&&(n.apt=Number(n.apt)),n["packetization-mode"]&&(n["packetization-mode"]=Number(n["packetization-mode"]))}for(const n of r.rtcpFeedback??[])n.parameter||(n.parameter="")}return e}function GS(t){const e=Om.clone(t);e.mid&&(e.muxId=e.mid,delete e.mid);for(const r of e.codecs)r.channels&&(r.numChannels=r.channels,delete r.channels),r.mimeType&&!r.name&&(r.name=r.mimeType.split("/")[1]),delete r.mimeType;return e}var YS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),XS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kd=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&YS(e,t,r);return XS(e,t),e};Object.defineProperty(Ra,"__esModule",{value:!0});Ra.Edge11=void 0;const ZS=he,uc=Ce,Gs=kd(we),pc=kd(ne),fc=kd(ba),JS=Be,J=new ZS.Logger("Edge11"),eR="Edge11";class xd extends JS.HandlerInterface{static createFactory(){return()=>new xd}constructor(){super(),this._rtpSenders=new Map,this._rtpReceivers=new Map,this._nextSendLocalId=0,this._transportReady=!1}get name(){return eR}close(){J.debug("close()");try{this._iceGatherer.close()}catch{}try{this._iceTransport.stop()}catch{}try{this._dtlsTransport.stop()}catch{}for(const e of this._rtpSenders.values())try{e.stop()}catch{}for(const e of this._rtpReceivers.values())try{e.stop()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){return J.debug("getNativeRtpCapabilities()"),fc.getCapabilities()}async getNativeSctpCapabilities(){return J.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){J.debug("run()"),this._sendingRtpParametersByKind={audio:pc.getSendingRtpParameters("audio",d),video:pc.getSendingRtpParameters("video",d)},this._remoteIceParameters=r,this._remoteIceCandidates=n,this._remoteDtlsParameters=i,this._cname=`CNAME-${Gs.generateRandomNumber()}`,this.setIceGatherer({iceServers:o,iceTransportPolicy:a}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(e){throw new uc.UnsupportedError("not supported")}async restartIce(e){if(J.debug("restartIce()"),this._remoteIceParameters=e,!!this._transportReady){J.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling");for(const r of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(r);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){J.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),J.debug("send() | calling new RTCRtpSender()");const s=new RTCRtpSender(e,this._dtlsTransport),o=Gs.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=pc.reduceCodecs(o.codecs,i);const a=o.codecs.some(d=>/.+\/rtx$/i.test(d.mimeType));r||(r=[{}]);for(const d of r)d.ssrc=Gs.generateRandomNumber(),a&&(d.rtx={ssrc:Gs.generateRandomNumber()});o.encodings=r,o.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const c=fc.mangleRtpParameters(o);J.debug("send() | calling rtpSender.send() [params:%o]",c),await s.send(c);const l=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(l,s),{localId:l,rtpParameters:o,rtpSender:s}}async stopSending(e){J.debug("stopSending() [localId:%s]",e);const r=this._rtpSenders.get(e);if(!r)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(e);try{J.debug("stopSending() | calling rtpSender.stop()"),r.stop()}catch(n){throw J.warn("stopSending() | rtpSender.stop() failed:%o",n),n}}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){r?J.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):J.debug("replaceTrack() [localId:%s, no track]",e);const n=this._rtpSenders.get(e);if(!n)throw new Error("RTCRtpSender not found");n.setTrack(r)}async setMaxSpatialLayer(e,r){J.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._rtpSenders.get(e);if(!n)throw new Error("RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{o<=r?s.active=!0:s.active=!1}),await n.setParameters(i)}async setRtpEncodingParameters(e,r){J.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._rtpSenders.get(e);if(!n)throw new Error("RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{i.encodings[o]={...s,...r}}),await n.setParameters(i)}async getSenderStats(e){const r=this._rtpSenders.get(e);if(!r)throw new Error("RTCRtpSender not found");return r.getStats()}async sendDataChannel(e){throw new uc.UnsupportedError("not implemented")}async receive(e){const r=[];for(const n of e){const{trackId:i,kind:s}=n;J.debug("receive() [trackId:%s, kind:%s]",i,s)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const n of e){const{trackId:i,kind:s,rtpParameters:o}=n;J.debug("receive() | calling new RTCRtpReceiver()");const a=new RTCRtpReceiver(this._dtlsTransport,s);a.addEventListener("error",d=>{J.error('rtpReceiver "error" event [event:%o]',d)});const c=fc.mangleRtpParameters(o);J.debug("receive() | calling rtpReceiver.receive() [params:%o]",c),await a.receive(c);const l=i;this._rtpReceivers.set(l,a),r.push({localId:l,track:a.track,rtpReceiver:a})}return r}async stopReceiving(e){for(const r of e){J.debug("stopReceiving() [localId:%s]",r);const n=this._rtpReceivers.get(r);if(!n)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(r);try{J.debug("stopReceiving() | calling rtpReceiver.stop()"),n.stop()}catch(i){J.warn("stopReceiving() | rtpReceiver.stop() failed:%o",i)}}}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){const r=this._rtpReceivers.get(e);if(!r)throw new Error("RTCRtpReceiver not found");return r.getStats()}async receiveDataChannel(e){throw new uc.UnsupportedError("not implemented")}setIceGatherer({iceServers:e,iceTransportPolicy:r}){const n=new RTCIceGatherer({iceServers:e??[],gatherPolicy:r??"all"});n.addEventListener("error",i=>{J.error('iceGatherer "error" event [event:%o]',i)});try{n.gather()}catch(i){J.debug("setIceGatherer() | iceGatherer.gather() failed: %s",i.toString())}this._iceGatherer=n}setIceTransport(){const e=new RTCIceTransport(this._iceGatherer);e.addEventListener("statechange",()=>{switch(e.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),e.addEventListener("icestatechange",()=>{switch(e.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),e.addEventListener("candidatepairchange",r=>{J.debug('iceTransport "candidatepairchange" event [pair:%o]',r.pair)}),this._iceTransport=e}setDtlsTransport(){const e=new RTCDtlsTransport(this._iceTransport);e.addEventListener("statechange",()=>{J.debug('dtlsTransport "statechange" event [state:%s]',e.state)}),e.addEventListener("dtlsstatechange",()=>{J.debug('dtlsTransport "dtlsstatechange" event [state:%s]',e.state),e.state==="closed"&&this.emit("@connectionstatechange","closed")}),e.addEventListener("error",r=>{J.error('dtlsTransport "error" event [event:%o]',r)}),this._dtlsTransport=e}async setupTransport({localDtlsRole:e}){J.debug("setupTransport()");const r=this._dtlsTransport.getLocalParameters();r.role=e,await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:r},n,i)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const n of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(n);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(n=>n.algorithm==="sha-256"||n.algorithm==="sha-384"||n.algorithm==="sha-512"),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}Ra.Edge11=xd;var Ca={},tR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),rR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),oi=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&tR(e,t,r);return rR(e,t),e};Object.defineProperty(Ca,"__esModule",{value:!0});Ca.ReactNativeUnifiedPlan=void 0;const It=oi(_e),nR=he,zp=oi(we),Rn=oi(ne),Ys=oi(Fe),hc=oi(Vt),iR=oi(ri),sR=Ce,oR=Be,aR=Ye,cR=Ht,k=new nR.Logger("ReactNativeUnifiedPlan"),lR="ReactNativeUnifiedPlan",Up={OS:1024,MIS:1024};class Ld extends oR.HandlerInterface{static createFactory(){return()=>new Ld}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return lR}close(){if(k.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){k.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=It.parse(r.sdp),i=Ys.extractRtpCapabilities({sdpObject:n});return iR.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return k.debug("getNativeSctpCapabilities()"),{numStreams:Up}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),k.debug("run()"),this._direction=e,this._remoteSdp=new aR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:Rn.getSendingRtpParameters("audio",d),video:Rn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:Rn.getSendingRemoteRtpParameters("audio",d),video:Rn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(k.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){this.assertNotClosed(),k.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),k.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});k.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){this.assertNotClosed(),this.assertSendDirection(),k.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1&&r.forEach((g,_)=>{g.rid=`r${_}`});const o=zp.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=Rn.reduceCodecs(o.codecs,i);const a=zp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=Rn.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});s&&s(l.sender);let d=await this._pc.createOffer(),p=It.parse(d.sdp),u;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});let f=!1;const h=(0,cR.parse)((r??[{}])[0].scalabilityMode);r&&r.length===1&&h.spatialLayers>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(k.debug("send() | enabling legacy simulcast for VP9 SVC"),f=!0,p=It.parse(d.sdp),u=p.media[c.idx],hc.addLegacySimulcast({offerMediaObject:u,numStreams:h.spatialLayers}),d={type:"offer",sdp:It.write(p)}),k.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);let m=l.mid??void 0;if(m||k.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),o.mid=m,p=It.parse(this._pc.localDescription.sdp),u=p.media[c.idx],o.rtcp.cname=Ys.getCname({offerMediaObject:u}),!r)o.encodings=hc.getRtpEncodings({offerMediaObject:u});else if(r.length===1){let g=hc.getRtpEncodings({offerMediaObject:u});Object.assign(g[0],r[0]),f&&(g=[g[0]]),o.encodings=g}else o.encodings=r;if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const g of o.encodings)g.scalabilityMode?g.scalabilityMode=`L1T${h.temporalLayers}`:g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n,extmapAllowMixed:!0});const y={type:"answer",sdp:this._remoteSdp.getSdp()};return k.debug("send() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y),m||(m=l.mid,o.mid=m),this._mapMidTransceiver.set(m,l),{localId:m,rtpParameters:o,rtpSender:l.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;k.debug("stopSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();k.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),k.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();k.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),k.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly";const n=await this._pc.createOffer();k.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?k.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):k.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),k.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();k.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),k.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();k.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};k.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Up.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=It.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),k.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;k.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=It.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Ys.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:It.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),k.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(d)this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){k.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){k.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){k.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};k.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=It.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=It.parse(this._pc.localDescription.sdp));const n=Ys.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new sR.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Ca.ReactNativeUnifiedPlan=Ld;var Ta={},dR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),uR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vs=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&dR(e,t,r);return uR(e,t),e};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.ReactNative=void 0;const Nt=vs(_e),pR=he,wi=Ce,mc=vs(we),bn=vs(ne),Xs=vs(Fe),Vp=vs(tn),fR=Be,hR=Ye,Q=new pR.Logger("ReactNative"),mR="ReactNative",Hp={OS:1024,MIS:1024};class Md extends fR.HandlerInterface{static createFactory(){return()=>new Md}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return mR}close(){if(Q.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){Q.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=Nt.parse(r.sdp);return Xs.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return Q.debug("getNativeSctpCapabilities()"),{numStreams:Hp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){Q.debug("run()"),this._direction=e,this._remoteSdp=new hR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:bn.getSendingRtpParameters("audio",d),video:bn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:bn.getSendingRemoteRtpParameters("audio",d),video:bn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(Q.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){Q.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(Q.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});Q.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();Q.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),Q.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&Q.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let s=await this._pc.createOffer(),o=Nt.parse(s.sdp),a;const c=mc.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=bn.reduceCodecs(c.codecs);const l=mc.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=bn.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(Q.debug("send() | enabling simulcast"),o=Nt.parse(s.sdp),a=o.media.find(u=>u.type==="video"),Vp.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:Nt.write(o)}),Q.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=Nt.parse(this._pc.localDescription.sdp),a=o.media.find(u=>u.type===e.kind),c.rtcp.cname=Xs.getCname({offerMediaObject:a}),c.encodings=Vp.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let u=0;u<c.encodings.length;++u)r[u]&&Object.assign(c.encodings[u],r[u]);if(c.encodings.length>1&&(c.codecs[0].mimeType.toLowerCase()==="video/vp8"||c.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const u of c.encodings)u.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,e),{localId:p,rtpParameters:c}}async stopSending(e){this.assertSendDirection(),Q.debug("stopSending() [localId:%s]",e);const r=this._mapSendLocalIdTrack.get(e);if(!r)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream);const n=await this._pc.createOffer();Q.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){Q.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){throw new wi.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,r){throw new wi.UnsupportedError("not implemented")}async setRtpEncodingParameters(e,r){throw new wi.UnsupportedError("not implemented")}async getSenderStats(e){throw new wi.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};Q.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Hp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Nt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),Q.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d}=a;Q.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;let u=a.streamId??d.rtcp.cname;Q.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),u+=`-hack-${mc.generateRandomNumber()}`,n.set(c,u),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:u,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=Nt.parse(s.sdp);for(const a of e){const{kind:c,rtpParameters:l}=a,d=c,p=o.media.find(u=>String(u.mid)===d);Xs.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:Nt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),Q.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{kind:c,trackId:l,rtpParameters:d}=a,p=l,u=c,f=n.get(l),m=this._pc.getRemoteStreams().find(y=>y.id===f).getTrackById(p);if(!m)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:u,rtpParameters:d}),r.push({localId:p,track:m})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){Q.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();Q.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new wi.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};Q.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Nt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}Q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Nt.parse(this._pc.localDescription.sdp));const n=Xs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Ta.ReactNative=Md;var gR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_R=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Im=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&gR(e,t,r);return _R(e,t),e};Object.defineProperty(ti,"__esModule",{value:!0});ti.Device=void 0;ti.detectDevice=Nm;const vR=xv,yR=he,wR=Ut,Cn=Ce,Kp=Im(we),hr=Im(ne),SR=as,RR=fa,bR=ha,CR=ma,TR=ga,DR=_a,ER=va,PR=ya,kR=wa,xR=Sa,LR=Ra,MR=Ca,OR=Ta,Pe=new yR.Logger("Device");function Nm(t){var e,r,n,i;if(!t&&typeof navigator=="object"&&navigator.product==="ReactNative"){if(Pe.debug("detectDevice() | React-Native detected"),typeof RTCPeerConnection>"u"){Pe.warn("detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?");return}return typeof RTCRtpTransceiver<"u"?(Pe.debug("detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(Pe.debug("detectDevice() | ReactNative PlanB handler chosen"),"ReactNative")}else if(t||typeof navigator=="object"&&typeof navigator.userAgent=="string"){t??(t=navigator.userAgent);const s=new vR.UAParser(t);Pe.debug("detectDevice() | browser detected [userAgent:%s, parsed:%o]",t,s.getResult());const o=s.getBrowser(),a=(e=o.name)==null?void 0:e.toLowerCase(),c=parseInt(o.major??"0"),d=(r=s.getEngine().name)==null?void 0:r.toLowerCase(),p=s.getOS(),u=(n=p.name)==null?void 0:n.toLowerCase(),f=parseFloat(p.version??"0"),m=(i=s.getDevice().model)==null?void 0:i.toLowerCase(),y=u==="ios"||m==="ipad",g=a&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(a),_=a&&["firefox","mobile firefox","mobile focus"].includes(a),v=a&&["safari","mobile safari"].includes(a),w=a&&["edge"].includes(a);if((g||w)&&!y&&c>=111)return"Chrome111";if(g&&!y&&c>=74||w&&!y&&c>=88)return"Chrome74";if(g&&!y&&c>=70)return"Chrome70";if(g&&!y&&c>=67)return"Chrome67";if(g&&!y&&c>=55)return"Chrome55";if(_&&!y&&c>=120)return"Firefox120";if(_&&!y&&c>=60)return"Firefox60";if(_&&y&&f>=14.3)return"Safari12";if(v&&c>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(v&&c>=11)return"Safari11";if(w&&!y&&c>=11&&c<=18)return"Edge11";if(d==="webkit"&&y&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(d==="blink"){const b=t.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(b){const C=Number(b[1]);return C>=111?"Chrome111":C>=74?"Chrome74":C>=70?"Chrome70":C>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else{Pe.warn("detectDevice() | browser not supported [name:%s, version:%s]",a,c);return}}else{Pe.warn("detectDevice() | unknown device");return}}class IR{constructor({handlerName:e,handlerFactory:r}={}){if(this._loaded=!1,this._observer=new wR.EnhancedEventEmitter,Pe.debug("constructor()"),e&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(e)Pe.debug("constructor() | handler given: %s",e);else if(e=Nm(),e)Pe.debug("constructor() | detected handler: %s",e);else throw new Cn.UnsupportedError("device not supported");switch(e){case"Chrome111":{this._handlerFactory=RR.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=bR.Chrome74.createFactory();break}case"Chrome70":{this._handlerFactory=CR.Chrome70.createFactory();break}case"Chrome67":{this._handlerFactory=TR.Chrome67.createFactory();break}case"Chrome55":{this._handlerFactory=DR.Chrome55.createFactory();break}case"Firefox120":{this._handlerFactory=ER.Firefox120.createFactory();break}case"Firefox60":{this._handlerFactory=PR.Firefox60.createFactory();break}case"Safari12":{this._handlerFactory=kR.Safari12.createFactory();break}case"Safari11":{this._handlerFactory=xR.Safari11.createFactory();break}case"Edge11":{this._handlerFactory=LR.Edge11.createFactory();break}case"ReactNativeUnifiedPlan":{this._handlerFactory=MR.ReactNativeUnifiedPlan.createFactory();break}case"ReactNative":{this._handlerFactory=OR.ReactNative.createFactory();break}default:throw new TypeError(`unknown handlerName "${e}"`)}}const n=this._handlerFactory();this._handlerName=n.name,n.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new Cn.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new Cn.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:e}){Pe.debug("load() [routerRtpCapabilities:%o]",e);let r;try{if(this._loaded)throw new Cn.InvalidStateError("already loaded");const n=Kp.clone(e);hr.validateRtpCapabilities(n),r=this._handlerFactory();const i=await r.getNativeRtpCapabilities();Pe.debug("load() | got native RTP capabilities:%o",i);const s=Kp.clone(i);hr.validateRtpCapabilities(s),this._extendedRtpCapabilities=hr.getExtendedRtpCapabilities(s,n),Pe.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=hr.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=hr.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=hr.getRecvRtpCapabilities(this._extendedRtpCapabilities),hr.validateRtpCapabilities(this._recvRtpCapabilities),Pe.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await r.getNativeSctpCapabilities(),Pe.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),hr.validateSctpCapabilities(this._sctpCapabilities),Pe.debug("load() succeeded"),this._loaded=!0,r.close()}catch(n){throw r&&r.close(),n}}canProduce(e){if(this._loaded){if(e!=="audio"&&e!=="video")throw new TypeError(`invalid kind "${e}"`)}else throw new Cn.InvalidStateError("not loaded");return this._canProduceByKind[e]}createSendTransport({id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d}){return Pe.debug("createSendTransport()"),this.createTransport({direction:"send",id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d})}createRecvTransport({id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d}){return Pe.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d})}createTransport({direction:e,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:d,appData:p}){if(this._loaded){if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="object")throw new TypeError("missing iceParameters");if(Array.isArray(i)){if(typeof s!="object")throw new TypeError("missing dtlsParameters");if(o&&typeof o!="object")throw new TypeError("wrong sctpParameters");if(p&&typeof p!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new Cn.InvalidStateError("not loaded");const u=new SR.Transport({direction:e,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:d,appData:p,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",u),u}}ti.Device=IR;var jm={},$m={};Object.defineProperty($m,"__esModule",{value:!0});var Am={};Object.defineProperty(Am,"__esModule",{value:!0});(function(t){var e=S&&S.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),r=S&&S.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(ti,t),r(as,t),r(cs,t),r(ls,t),r(ds,t),r(us,t),r($m,t),r(Am,t),r(Be,t),r(Ce,t)})(jm);(function(t){var e=S&&S.__createBinding||(Object.create?function(l,d,p,u){u===void 0&&(u=p);var f=Object.getOwnPropertyDescriptor(d,p);(!f||("get"in f?!d.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return d[p]}}),Object.defineProperty(l,u,f)}:function(l,d,p,u){u===void 0&&(u=p),l[u]=d[p]}),r=S&&S.__setModuleDefault||(Object.create?function(l,d){Object.defineProperty(l,"default",{enumerable:!0,value:d})}:function(l,d){l.default=d}),n=S&&S.__importStar||function(l){if(l&&l.__esModule)return l;var d={};if(l!=null)for(var p in l)p!=="default"&&Object.prototype.hasOwnProperty.call(l,p)&&e(d,l,p);return r(d,l),d},i=S&&S.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.parseScalabilityMode=t.detectDevice=t.Device=t.version=t.types=void 0;const s=i(oa);t.debug=s.default;const o=ti;Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return o.Device}}),Object.defineProperty(t,"detectDevice",{enumerable:!0,get:function(){return o.detectDevice}});const a=n(jm);t.types=a,t.version="3.7.17";var c=Ht;Object.defineProperty(t,"parseScalabilityMode",{enumerable:!0,get:function(){return c.parse}})})(pm);const zt=Object.create(null);zt.open="0";zt.close="1";zt.ping="2";zt.pong="3";zt.message="4";zt.upgrade="5";zt.noop="6";const mo=Object.create(null);Object.keys(zt).forEach(t=>{mo[zt[t]]=t});const ml={type:"error",data:"parser error"},Fm=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Bm=typeof ArrayBuffer=="function",zm=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Od=({type:t,data:e},r,n)=>Fm&&e instanceof Blob?r?n(e):Wp(e,n):Bm&&(e instanceof ArrayBuffer||zm(e))?r?n(e):Wp(new Blob([e]),n):n(zt[t]+(e||"")),Wp=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function Qp(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let gc;function NR(t,e){if(Fm&&t.data instanceof Blob)return t.data.arrayBuffer().then(Qp).then(e);if(Bm&&(t.data instanceof ArrayBuffer||zm(t.data)))return e(Qp(t.data));Od(t,!1,r=>{gc||(gc=new TextEncoder),e(gc.encode(r))})}const qp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Di=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<qp.length;t++)Di[qp.charCodeAt(t)]=t;const jR=t=>{let e=t.length*.75,r=t.length,n,i=0,s,o,a,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const l=new ArrayBuffer(e),d=new Uint8Array(l);for(n=0;n<r;n+=4)s=Di[t.charCodeAt(n)],o=Di[t.charCodeAt(n+1)],a=Di[t.charCodeAt(n+2)],c=Di[t.charCodeAt(n+3)],d[i++]=s<<2|o>>4,d[i++]=(o&15)<<4|a>>2,d[i++]=(a&3)<<6|c&63;return l},$R=typeof ArrayBuffer=="function",Id=(t,e)=>{if(typeof t!="string")return{type:"message",data:Um(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:AR(t.substring(1),e)}:mo[r]?t.length>1?{type:mo[r],data:t.substring(1)}:{type:mo[r]}:ml},AR=(t,e)=>{if($R){const r=jR(t);return Um(r,e)}else return{base64:!0,data:t}},Um=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},Vm="",FR=(t,e)=>{const r=t.length,n=new Array(r);let i=0;t.forEach((s,o)=>{Od(s,!1,a=>{n[o]=a,++i===r&&e(n.join(Vm))})})},BR=(t,e)=>{const r=t.split(Vm),n=[];for(let i=0;i<r.length;i++){const s=Id(r[i],e);if(n.push(s),s.type==="error")break}return n};function zR(){return new TransformStream({transform(t,e){NR(t,r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const s=new DataView(i.buffer);s.setUint8(0,126),s.setUint16(1,n)}else{i=new Uint8Array(9);const s=new DataView(i.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(r)})}})}let _c;function Zs(t){return t.reduce((e,r)=>e+r.length,0)}function Js(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)r[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function UR(t,e){_c||(_c=new TextDecoder);const r=[];let n=0,i=-1,s=!1;return new TransformStream({transform(o,a){for(r.push(o);;){if(n===0){if(Zs(r)<1)break;const c=Js(r,1);s=(c[0]&128)===128,i=c[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(Zs(r)<2)break;const c=Js(r,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(Zs(r)<8)break;const c=Js(r,8),l=new DataView(c.buffer,c.byteOffset,c.length),d=l.getUint32(0);if(d>Math.pow(2,21)-1){a.enqueue(ml);break}i=d*Math.pow(2,32)+l.getUint32(4),n=3}else{if(Zs(r)<i)break;const c=Js(r,i);a.enqueue(Id(s?c:_c.decode(c),e)),n=0}if(i===0||i>t){a.enqueue(ml);break}}}})}const Hm=4;function be(t){if(t)return VR(t)}function VR(t){for(var e in be.prototype)t[e]=be.prototype[e];return t}be.prototype.on=be.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};be.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};be.prototype.off=be.prototype.removeListener=be.prototype.removeAllListeners=be.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};be.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};be.prototype.emitReserved=be.prototype.emit;be.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};be.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Da=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),ot=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),HR="arraybuffer";function Km(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const KR=ot.setTimeout,WR=ot.clearTimeout;function Ea(t,e){e.useNativeTimers?(t.setTimeoutFn=KR.bind(ot),t.clearTimeoutFn=WR.bind(ot)):(t.setTimeoutFn=ot.setTimeout.bind(ot),t.clearTimeoutFn=ot.clearTimeout.bind(ot))}const QR=1.33;function qR(t){return typeof t=="string"?GR(t):Math.ceil((t.byteLength||t.size)*QR)}function GR(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function Wm(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function YR(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function XR(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let s=r[n].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class ZR extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}class Nd extends be{constructor(e){super(),this.writable=!1,Ea(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,r,n){return super.emitReserved("error",new ZR(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=Id(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=YR(e);return r.length?"?"+r:""}}class JR extends Nd{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};BR(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,FR(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Wm()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}}let Qm=!1;try{Qm=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const e0=Qm;function t0(){}class r0 extends JR{constructor(e){if(super(e),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}class Bt extends be{constructor(e,r,n){super(),this.createRequest=e,Ea(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const r=Km(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=Bt.requestsCount++,Bt.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=t0,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Bt.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Bt.requestsCount=0;Bt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Gp);else if(typeof addEventListener=="function"){const t="onpagehide"in ot?"pagehide":"unload";addEventListener(t,Gp,!1)}}function Gp(){for(let t in Bt.requests)Bt.requests.hasOwnProperty(t)&&Bt.requests[t].abort()}const n0=function(){const t=qm({xdomain:!1});return t&&t.responseType!==null}();class i0 extends r0{constructor(e){super(e);const r=e&&e.forceBase64;this.supportsBinary=n0&&!r}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Bt(qm,this.uri(),e)}}function qm(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||e0))return new XMLHttpRequest}catch{}if(!e)try{return new ot[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Gm=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class s0 extends Nd{get name(){return"websocket"}doOpen(){const e=this.uri(),r=this.opts.protocols,n=Gm?{}:Km(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;Od(n,this.supportsBinary,s=>{try{this.doWrite(n,s)}catch{}i&&Da(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Wm()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}}const vc=ot.WebSocket||ot.MozWebSocket;class o0 extends s0{createSocket(e,r,n){return Gm?new vc(e,r,n):r?new vc(e,r):new vc(e)}doWrite(e,r){this.ws.send(r)}}class a0 extends Nd{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const r=UR(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),i=zR();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const s=()=>{n.read().then(({done:a,value:c})=>{a||(this.onPacket(c),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;this._writer.write(n).then(()=>{i&&Da(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const c0={websocket:o0,webtransport:a0,polling:i0},l0=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,d0=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function gl(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=l0.exec(t||""),s={},o=14;for(;o--;)s[d0[o]]=i[o]||"";return r!=-1&&n!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=u0(s,s.path),s.queryKey=p0(s,s.query),s}function u0(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function p0(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,s){i&&(r[i]=s)}),r}const _l=typeof addEventListener=="function"&&typeof removeEventListener=="function",go=[];_l&&addEventListener("offline",()=>{go.forEach(t=>t())},!1);class Lr extends be{constructor(e,r){if(super(),this.binaryType=HR,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(r=e,e=null),e){const n=gl(e);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=gl(r.host).host);Ea(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=XR(this.opts.query)),_l&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},go.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=Hm,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Lr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(e);r.open(),this.setTransport(r)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Lr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=e.data,this._onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(r+=qR(i)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Da(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,r,n){return this._sendPacket("message",e,r,n),this}send(e,r,n){return this._sendPacket("message",e,r,n),this}_sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const s={type:e,data:r,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Lr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),_l&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=go.indexOf(this._offlineEventListener);n!==-1&&go.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this._prevBufferLen=0}}}Lr.protocol=Hm;class f0 extends Lr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let r=this.createTransport(e),n=!1;Lr.priorWebsocketSuccess=!1;const i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Lr.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=r.name,this.emitReserved("upgradeError",u)}}))};function s(){n||(n=!0,d(),r.close(),r=null)}const o=p=>{const u=new Error("probe error: "+p);u.transport=r.name,s(),this.emitReserved("upgradeError",u)};function a(){o("transport closed")}function c(){o("socket closed")}function l(p){r&&p.name!==r.name&&s()}const d=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",a),this.off("close",c),this.off("upgrading",l)};r.once("open",i),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",l),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const r=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}}let h0=class extends f0{constructor(e,r={}){const n=typeof e=="object"?e:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>c0[i]).filter(i=>!!i)),super(e,n)}};function m0(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=gl(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}const g0=typeof ArrayBuffer=="function",_0=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Ym=Object.prototype.toString,v0=typeof Blob=="function"||typeof Blob<"u"&&Ym.call(Blob)==="[object BlobConstructor]",y0=typeof File=="function"||typeof File<"u"&&Ym.call(File)==="[object FileConstructor]";function jd(t){return g0&&(t instanceof ArrayBuffer||_0(t))||v0&&t instanceof Blob||y0&&t instanceof File}function _o(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(_o(t[r]))return!0;return!1}if(jd(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return _o(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&_o(t[r]))return!0;return!1}function w0(t){const e=[],r=t.data,n=t;return n.data=vl(r,e),n.attachments=e.length,{packet:n,buffers:e}}function vl(t,e){if(!t)return t;if(jd(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=vl(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=vl(t[n],e));return r}return t}function S0(t,e){return t.data=yl(t.data,e),delete t.attachments,t}function yl(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=yl(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=yl(t[r],e));return t}const R0=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],b0=5;var W;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(W||(W={}));class C0{constructor(e){this.replacer=e}encode(e){return(e.type===W.EVENT||e.type===W.ACK)&&_o(e)?this.encodeAsBinary({type:e.type===W.EVENT?W.BINARY_EVENT:W.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===W.BINARY_EVENT||e.type===W.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=w0(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}}function Yp(t){return Object.prototype.toString.call(t)==="[object Object]"}class $d extends be{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===W.BINARY_EVENT;n||r.type===W.BINARY_ACK?(r.type=n?W.EVENT:W.ACK,this.reconstructor=new T0(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(jd(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(W[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===W.BINARY_EVENT||n.type===W.BINARY_ACK){const s=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const o=e.substring(s,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(r+1)==="/"){const s=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(s,r)}else n.nsp="/";const i=e.charAt(r+1);if(i!==""&&Number(i)==i){const s=r+1;for(;++r;){const o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}n.id=Number(e.substring(s,r+1))}if(e.charAt(++r)){const s=this.tryParse(e.substr(r));if($d.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case W.CONNECT:return Yp(r);case W.DISCONNECT:return r===void 0;case W.CONNECT_ERROR:return typeof r=="string"||Yp(r);case W.EVENT:case W.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&R0.indexOf(r[0])===-1);case W.ACK:case W.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class T0{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=S0(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const D0=Object.freeze(Object.defineProperty({__proto__:null,Decoder:$d,Encoder:C0,get PacketType(){return W},protocol:b0},Symbol.toStringTag,{value:"Module"}));function _t(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const E0=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Xm extends be{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[_t(e,"open",this.onopen.bind(this)),_t(e,"packet",this.onpacket.bind(this)),_t(e,"error",this.onerror.bind(this)),_t(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){var n,i,s;if(E0.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:W.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const d=this.ids++,p=r.pop();this._registerAckCallback(d,p),o.id=d}const a=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,r){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=r;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);r.call(this,new Error("operation has timed out"))},i),o=(...a)=>{this.io.clearTimeoutFn(s),r.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...r){return new Promise((n,i)=>{const s=(o,a)=>o?i(o):n(a);s.withError=!0,r.push(s),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...s)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:W.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case W.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case W.EVENT:case W.BINARY_EVENT:this.onevent(e);break;case W.ACK:case W.BINARY_ACK:this.onack(e);break;case W.DISCONNECT:this.ondisconnect();break;case W.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...i){n||(n=!0,r.packet({type:W.ACK,id:e,data:i}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:W.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function ai(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ai.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+r:t-r}return Math.min(t,this.max)|0};ai.prototype.reset=function(){this.attempts=0};ai.prototype.setMin=function(t){this.ms=t};ai.prototype.setMax=function(t){this.max=t};ai.prototype.setJitter=function(t){this.jitter=t};class wl extends be{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Ea(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new ai({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const i=r.parser||D0;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new h0(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=_t(r,"open",function(){n.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=_t(r,"error",s);if(this._timeout!==!1){const a=this._timeout,c=this.setTimeoutFn(()=>{i(),s(new Error("timeout")),r.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(_t(e,"ping",this.onping.bind(this)),_t(e,"data",this.ondata.bind(this)),_t(e,"error",this.onerror.bind(this)),_t(e,"close",this.onclose.bind(this)),_t(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){Da(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Xm(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Si={};function vo(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=m0(t,e.path||"/socket.io"),n=r.source,i=r.id,s=r.path,o=Si[i]&&s in Si[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return a?c=new wl(n,e):(Si[i]||(Si[i]=new wl(n,e)),c=Si[i]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(vo,{Manager:wl,Socket:Xm,io:vo,connect:vo});const eo=vo("http://localhost:3000");let yc=null,Tn=null,Xp=null;const P0=async()=>{try{eo.emit("getRouterRtpCapabilities",{roomId:1},async t=>{yc=new pm.Device,await yc.load({routerRtpCapabilities:t}),eo.emit("createWebRtcTransport",{forceTcp:!1,roomId:1},async e=>{Tn=yc.createSendTransport(e),Tn.on("connect",({dtlsParameters:s},o,a)=>{eo.emit("connectTransport",{transportId:Tn.id,dtlsParameters:s},o,a)}),Tn.on("produce",(s,o,a)=>{eo.emit("produce",{transportId:Tn.id,...s},c=>{o({id:c})})});const r=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),n=document.getElementById("localVideo");n&&(n.srcObject=r);const i=r.getVideoTracks()[0];Xp=await Tn.produce({track:i}),Xp.on("trackended",()=>{console.log("Track ended")})})})}catch(t){console.error("Error joining room:",t)}};function k0(){return Ho.useEffect(()=>{P0()},[]),Ei.jsxs("div",{className:"main",children:[Ei.jsx("video",{id:"localVideo",autoPlay:!0,muted:!0}),Ei.jsx("video",{id:"remoteVideo",autoPlay:!0})]})}um(document.getElementById("root")).render(Ei.jsx(Ho.StrictMode,{children:Ei.jsx(k0,{})}));
